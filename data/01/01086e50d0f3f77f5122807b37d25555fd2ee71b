<p>A couple of months ago, I <a href="https://xenodium.com/ready-player-mode/">introduced Ready Player Mode</a>, an Emacs major mode used to peek at media files from my beloved text editor. The goal was simple. Treat opening media files like any other file, that is, open and go.</p>
<p>The initial implementation served me well while reviewing lots of tiny audio files I used to practice learning a new language. At this point, I started thinking, could I use ready-player for regular music consumption? The thing is, long ago I had stopped buying music and relied on streamed music from online services. Could I go back to offline?</p>
<p>Dusting off my old media collection brought lots of memories as I rediscovered tunes. Having said that, the ready-player experience wasn't quite cutting it for an extended listening experience. I no longer wanted to occasionally peek at media to learn a language. I wanted to load a full music collection. I wanted random access to everything. I wanted Emacs to remember what I was listening to across sessions… While I did <a href="https://xenodium.com/the-dired-abstraction/">add some pluggable flows</a>, I still needed additional changes to make the experience more pleasant.</p>
<p>While plugging away at my own ready-player's pet peeves, I also collected a handful of feature requests. Let's go over the latest features.</p>
<h2>Seek (f/b binding) - <a href="https://github.com/xenodium/ready-player/issues/11">feature request</a></h2>
<p>While not a feature I initially thought ranked highly in priority, I now find myself seeking audio files from time to time. Ready Player delegates all playback to the likes of <a href="https://mpv.io/">mpv</a>, <a href="https://www.videolan.org/vlc/">vlc</a>, <a href="https://mplayerhq.hu/design7/news.html">mplayer</a>, and so on… Up until now, interacting with these utilities merely consisted of feeding a media file path on to the respective process.</p>
<p>Command line utilities like <code>mpv</code> offer socket communication via <code>--input-ipc-server</code> to enable further requests like seeking forward and back. Ready player now supports seeking via mpv. Maybe support for other utilities can be added in the future.</p>
<p>If you're on a recent version of ready-player, seeking is automatically enabled if you've got mpv installed and aren't explicitly customizing <code>ready-player-open-playback-commands</code>. The default value takes care of things:</p>
<pre><code class="language-{.commonlisp">(defcustom ready-player-open-playback-commands
  '((&quot;mpv&quot; &quot;--audio-display=no&quot; &quot;--input-ipc-server=&lt;&lt;socket&gt;&gt;&quot;)
    (&quot;vlc&quot;)
    (&quot;ffplay&quot;)
    (&quot;mplayer&quot;))
  &quot;...&quot;
  :type '(repeat (list string))
  :group 'ready-player)
</code></pre>
<p><img src="https://xenodium.github.io/images/seek-and-you-shall-find/seek.webp" alt=""></p>
<h2>Pause/resume (SPC binding) - <a href="https://github.com/xenodium/ready-player/issues/10">feature request</a></h2>
<p>Until now, ready-player could only play and stop, so you always had to start playing tracks from the beginning. With <code>mpv</code> ipc support now in place, adding pause/resume was a breeze. Like seek, it should just work for ya if <code>mpv</code> is on your system and no explicit customization of <code>ready-player-open-playback-commands</code>.</p>
<h2>Repeat current file (r binding) - <a href="https://github.com/xenodium/ready-player/issues/16">feature request</a></h2>
<p>While repeating current playlist (or directory) was already supported, there was a feature request to enable repeating files. Toggling repeat now cycles through available modes.</p>
<p><img src="https://xenodium.github.io/images/seek-and-you-shall-find/repeat.webp" alt=""></p>
<h2>Selective players - <a href="https://github.com/xenodium/ready-player/issues/13">feature request</a></h2>
<p>With ready-player delegating to a single utility for either audio or video playback, folks may have a need to specify different utilities for either of these two. While I'm happy for <code>mpv</code> to handle both audio and video, we now have a couple of prepending options.</p>
<h3>Use a predicate function</h3>
<p>Prepend each utility with either the built-in <code>ready-player-is-audio-p</code> or <code>ready-player-is-video-p</code> functions, or maybe create your own predicate helper.</p>
<pre><code class="language-{.commonlisp">(setq ready-player-open-playback-commands
      '((ready-player-is-audio-p &quot;ffplay&quot;)
        (ready-player-is-video-p &quot;mpv&quot;)))
</code></pre>
<h3>Use an extension list</h3>
<p>In this example, we delegate mp3 and ogg playback to ffplay and everything else to mpv.</p>
<pre><code class="language-{.commonlisp">(setq ready-player-open-playback-commands
      '(((&quot;mp3&quot; &quot;ogg&quot;) &quot;ffplay&quot;)
        (&quot;mpv&quot;)))
</code></pre>
<h2>Autoplay (a binding) - <a href="https://github.com/xenodium/ready-player/issues/9">feature request</a></h2>
<p>Automatically start playing once file opens. No need for user to explicitly request playback.</p>
<h2>Mark in dired (m binding) - <a href="https://github.com/xenodium/ready-player/issues/8">feature request</a></h2>
<p>Open a dired buffer and mark the currently played file.</p>
<p><img src="https://xenodium.github.io/images/seek-and-you-shall-find/mark.gif" alt=""></p>
<h2>M3u playlists - <a href="https://github.com/xenodium/ready-player/issues/14">feature request</a></h2>
<p>While I talked about how <a href="https://lmno.lol/alvaro/the-dired-abstraction">the dired abstraction</a> made basic m3u playlist support possible, it wasn't until recently that I included this experiment in the package itself. In addition, .m3u are now recognized by Emacs and automatically open like any other file: find-file, dired, projectile…</p>
<h2>Load recursive directory</h2>
<p>With <a href="https://lmno.lol/alvaro/the-dired-abstraction">the dired abstraction</a> at its core, ready player can load any dired buffer. You could do something like:</p>
<ol>
<li><code>M-x find-dired RET</code>.</li>
<li>Pick a directory. RET.</li>
<li>Type <code>&quot;-iname \*.mp3 -o -iname \*.ogg -o -iname \*.m4a&quot;</code> RET.</li>
<li><code>M-x ready-player-load-dired-buffer</code> RET.</li>
</ol>
<p>While uber flexible, there's no need to regularly do that, so you can now invoke <code>M-x ready-player-load-directory</code> and it will recursively find all media files in it.</p>
<h2>Toggle player view (C-c m m binding)</h2>
<p>While we can always get back to the player buffer via our favourite buffer-switching mechanism (I like <a href="https://github.com/abo-abo/swiper">ivy</a>'s ivy-switch-buffer), we now have <code>M-x ready-player-view-player</code> available for quicker toggle.</p>
<h2>Remember session</h2>
<p>Playback is now remembered across Emacs sessions. Toggling player view (C-c m m binding) or playback (C-c m SPC binding) starts the last song you were playing on your previous Emacs session.</p>
<h2>Index + searching (/ or C-c m /)</h2>
<p>We now have automatic indexing, which enables richer searching across your collection, not to mention that random access I was craving.</p>
<p><img src="https://xenodium.github.io/images/seek-and-you-shall-find/search.webp" alt=""></p>
<h2>Global bindings</h2>
<p>Last but not least, you may have noticed a handful of key bindings throughout the post. Single-character bindings all work within a ready-player buffer. Bindings prefixed <code>C-c m</code> are now globally available when <code>ready-player-mode</code> is turned on. This can be customized via <code>ready-player-set-global-bindings</code>.</p>
<h2>Please help make it all self-sustainable</h2>
<p>If you find this package useful or got the features you wanted, please <a href="https://github.com/sponsors/xenodium">consider sponsoring the work</a>. I've left my tech job (maybe a post for another time) and looking to make projects like ready-player self-sustainable.</p>
<p>If you're an iOS/macOS user, you can also <a href="https://apps.apple.com/us/developer/xenodium-ltd/id304568690">buy my apps</a>. Here's another freebie (<a href="https://github.com/xenodium/macosrec">macosrec</a>) I've put out there, which I <a href="https://lmno.lol/alvaro/recordscreenshot-windows-the-lazy-way">regularly use to capture Emacs demos</a> for this blog.</p>
<p>You may also enjoy this blog and all the tips I share. Blog posts take time. Consider <a href="https://github.com/sponsors/xenodium">sponsoring my blog</a>.</p>
<p>I've built other Emacs packages you may already use or would like to. Maybe I already built a feature request? Consider <a href="https://github.com/sponsors/xenodium">sponsoring</a>:</p>
<ul>
<li><a href="https://github.com/xenodium/chatgpt-shell">chatgpt-shell</a></li>
<li><a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a></li>
<li><a href="https://github.com/xenodium/sqlite-mode-extras">sqlite-mode-extras</a></li>
<li><a href="https://github.com/xenodium/org-block-capf">org-block-capf</a></li>
<li><a href="https://github.com/xenodium/company-org-block">company-org-block</a></li>
<li><a href="https://github.com/xenodium/ob-swiftui">ob-swiftui</a></li>
</ul>
<p>I'm also building <a href="https://lmno.lol">lmno.lol</a>, a new blogging platform, with <a href="https://indieweb.social/@xenodium/112265481282475542">drag and drop to the web</a>. Maybe you want to try that too? <a href="mailto:help/at/lmno.lol">Get in touch</a>.</p>
<p>Thank you!</p>
<p>Álvaro</p>
