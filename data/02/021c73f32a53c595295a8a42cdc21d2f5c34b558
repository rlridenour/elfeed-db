<p>[Equations in this post may not look right (or appear at all) in your RSS reader. Go to <a href="https://leancrew.com/all-this/2025/12/solving-a-snaky-math-problem-with-mathematica/">the original article</a> to see them rendered properly.]</p>
  <hr />
  <p>I’m in the middle of a <a href="https://www.wolfram.com/wolfram-u/courses/programming-applications/wolfram-language-programming-proficiency-dev810/">three-lecture series on the Wolfram Language</a> and thought the puzzle presented in this recent <a href="https://www.youtube.com/watch?app=desktop&amp;v=8opamk3_ctY">MindYourDecisions video</a> would be a good problem to practice on. Here’s the problem:</p>
<p><img alt="Puzzle statement" class="ss" src="https://leancrew.com/all-this/images2025/20251206-Puzzle%20statement.png" title="Puzzle statement" width="80%"/></p>
<p>I’ll call the variables represented by the blue boxes <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>1</mn></msub></math> through <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>9</mn></msub></math>, and rewrite the equation in a more standard form:</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><mn>13</mn><mspace width="0.167em"></mspace><mfrac><msub><mi>n</mi><mn>2</mn></msub><msub><mi>n</mi><mn>3</mn></msub></mfrac><mo>+</mo><msub><mi>n</mi><mn>4</mn></msub><mo>+</mo><mn>12</mn><msub><mi>n</mi><mn>5</mn></msub><mo>−</mo><msub><mi>n</mi><mn>6</mn></msub><mo>−</mo><mn>11</mn><mo>+</mo><mfrac><mrow><msub><mi>n</mi><mn>7</mn></msub><mspace width="0.167em"></mspace><msub><mi>n</mi><mn>8</mn></msub></mrow><msub><mi>n</mi><mn>9</mn></msub></mfrac><mo>−</mo><mn>10</mn><mo>=</mo><mn>66</mn></math>
<p>I’m using <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math> for the variable names to emphasize that these are integers.</p>
<p>In the video, Presh Talwalkar shows some solutions by trial and error and then goes on to write a Python script that generates all the solutions via the <a href="https://docs.python.org/3.13/library/itertools.html"><code>itertools</code></a> and <a href="https://docs.python.org/3.13/library/fractions.html"><code>fractions</code></a> libraries. He uses <code>fractions</code> to avoid the problem of inexact floating point numbers appearing in the divisions of the second and seventh terms of the equation. Mathematica maintains the exact rational values when you divide integers, so I didn’t have to worry about that. Here’s the notebook with my work:</p>
<iframe height="800" src="https://www.wolframcloud.com/obj/mark80/Published/snake.nb?_embed=iframe" width="100%"></iframe>
<p>It starts by generating a list of the numbers 1 through 9 with the <a href="http://reference.wolfram.com/language/ref/Range.html"><code>Range</code> function</a> and then generates the 362,880 permutations of that list via <a href="http://reference.wolfram.com/language/ref/Permutations.html"><code>Permutations</code></a>. The semicolon after the <code>Permutations</code> call keeps Mathematica from printing out all the permutations. There’s then a quick check to make sure the <a href="http://reference.wolfram.com/language/ref/Length.html"><code>Length</code></a> of the <code>perms</code> list is <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>9</mn><mi>!</mi></mrow></math>.</p>
<p>Filtering <code>perms</code> to get just the solutions to the equation is done with the <a href="http://reference.wolfram.com/language/ref/Select.html"><code>Select</code> function</a>. I first define a function, <code>f</code>, that takes a list of values as its argument and returns true or false, depending on whether that list solves the equation. <code>perms</code> and <code>f</code> are then passed to <code>Select</code> to get all the permutations that solve the equation. There are 136 of these.</p>
<p>Because addition and multiplication are commutative, Talwalkar considers any switch of <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>1</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>4</mn></msub></math> or <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>7</mn></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>8</mn></msub></math> to be essentially the same solution. Eliminating these switches leaves <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>136</mn><mi>/</mi><mn>4</mn><mo>=</mo><mn>34</mn></mrow></math> “base” solutions. I pull these from the list of all solutions by another use of <code>Select</code>, this time passing it a new function, <code>g</code>, that returns true only if <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>n</mi><mn>4</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>n</mi><mn>7</mn></msub><mo>&lt;</mo><msub><mi>n</mi><mn>8</mn></msub></mrow></math>. That gives me these 34 base solutions:</p>
<pre><code>1 2 6 4 7 8 3 5 9    1 3 2 4 5 8 7 9 6    1 3 2 9 5 6 4 7 8
1 3 4 7 6 5 2 9 8    1 3 6 2 7 9 4 5 8    1 3 9 4 7 8 2 5 6
1 4 8 2 7 9 3 5 6    1 5 2 3 4 8 7 9 6    1 5 2 8 4 7 3 9 6
1 5 3 9 4 2 7 8 6    1 8 3 7 4 5 2 6 9    1 9 6 4 5 8 3 7 2
1 9 6 7 5 2 3 4 8    2 1 4 3 7 9 5 6 8    2 6 9 8 5 1 4 7 3
2 8 6 9 4 1 5 7 3    2 9 6 3 5 1 4 7 8    3 2 1 5 4 7 8 9 6
3 2 4 8 5 1 7 9 6    3 2 8 6 5 1 7 9 4    3 6 4 9 5 8 1 7 2
3 9 2 8 1 5 6 7 4    5 1 2 9 6 7 3 4 8    5 3 1 7 2 6 8 9 4
5 4 1 9 2 7 3 8 6    5 4 8 9 6 7 1 3 2    5 7 2 8 3 9 1 6 4
5 9 3 6 2 1 7 8 4    6 3 1 9 2 5 7 8 4    7 1 4 9 6 5 2 3 8
7 2 8 9 6 5 1 3 4    7 3 2 8 5 9 1 6 4    7 5 2 8 4 9 1 3 6
7 6 4 8 5 9 1 3 2    
</code></pre>
<p>This is basically where the video ends. But I noticed that many of the solutions give fractions for the second and seventh terms, and it just works out that the sum of those fractions is an integer. For example, plugging the values of the first solution into the equation gives:</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>+</mo><mn>13</mn><mspace width="0.167em"></mspace><mfrac><mn>2</mn><mn>6</mn></mfrac><mo>+</mo><mn>4</mn><mo>+</mo><mn>12</mn><mo>⋅</mo><mn>7</mn><mo>−</mo><mn>8</mn><mo>+</mo><mfrac><mrow><mn>3</mn><mo>⋅</mo><mn>5</mn></mrow><mn>9</mn></mfrac><mo>−</mo><mn>10</mn><mo>=</mo><mn>66</mn></math>
<p>This is true in part because</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mn>13</mn><mspace width="0.167em"></mspace><mfrac><mn>2</mn><mn>6</mn></mfrac><mo>+</mo><mfrac><mrow><mn>3</mn><mo>⋅</mo><mn>5</mn></mrow><mn>9</mn></mfrac><mo>=</mo><mn>6</mn></math>
<p>Most of the other solutions follow this pattern, where the second and seventh terms are fractions that sum to an integer. I wondered if there were any solutions for which the second and seventh terms were themselves integers.</p>
<p>So I wrote a new function, <code>h</code>, which returns true only if both of those divisions return integer values. I used <code>Select</code> with this function and the <code>solns</code> list to learn that 20 of the 136 solutions meet this criterion. I then applied <code>g</code> to this list to return just the five “base” versions, for which <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>n</mi><mn>4</mn></msub></mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>n</mi><mn>7</mn></msub><mo>&lt;</mo><msub><mi>n</mi><mn>8</mn></msub></mrow></math>:</p>
<pre><code>3 2 1 5 4 7 8 9 6
5 3 1 7 2 6 8 9 4
5 4 1 9 2 7 3 8 6
5 9 3 6 2 1 7 8 4
6 3 1 9 2 5 7 8 4
</code></pre>
<p>I could have simply used <code>Select</code> to filter <code>basesolns</code> by <code>h</code> and gotten the same answer.</p>
<p>In the class, I’m learning to use anonymous functions to make the code faster and simpler. In this problem, speed is not an issue, and I think the code would be harder to follow if I used anonymous functions. Maybe I could replace <code>g</code> and <code>h</code> with anonymous functions with no loss of clarity, but I really think <code>f</code> should remain as-is.</p>
  
