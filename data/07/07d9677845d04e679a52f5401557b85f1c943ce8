<p>I&rsquo;ve been journaling a lot for many years. It cools down my brain a little and helps me reflect on things better.
Emacs and org-mode are of course the tools I use to journal.</p>
<h2 id="the-problem">The problem</h2>
<p>I can&rsquo;t easily journal on the go when I only have my phone handy.</p>
<h2 id="solution">Solution</h2>
<p>I&rsquo;ve built incredibly minimal web page with a simple form.
When the form is submitted it is captured by a script, parses the form data and calls my Emacs with <code>--eval</code> to
add the form data into my <code>journal.org</code> file.</p>
<p>And when I say minimal I mean it. Just look at it.
<img alt="simple-org screenshot" src="https://codelearn.me/assets/img/simple-org.png" width="100%"/></p>
<p>Here is its whole source code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=2.0, maximum-scale=4.0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">/&gt;&lt;</span><span style="color:#a6e22e">br</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">textarea</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;content&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">textarea</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#a6e22e">br</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">submit</span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">button</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#a6e22e">br</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">form</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($_SERVER[<span style="color:#e6db74">&#39;REQUEST_METHOD&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;POST&#39;</span>) {
</span></span><span style="display:flex;"><span> $title <span style="color:#f92672">=</span> <span style="color:#a6e22e">addslashes</span>($_POST[<span style="color:#e6db74">&#39;title&#39;</span>]);
</span></span><span style="display:flex;"><span> $content <span style="color:#f92672">=</span> <span style="color:#a6e22e">addslashes</span>($_POST[<span style="color:#e6db74">&#39;content&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># In actual file it&#39;s a oneliner.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#75715e"># I split it for this post purposes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#75715e"># Hope it still works in case you decide to copy/paste.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> $cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;emacs --batch --load=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">~/.emacs.d/init.el</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74"> --eval </span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span> $cmd <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34;(progn &#34;</span>;
</span></span><span style="display:flex;"><span> $cmd <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; (org-capture nil </span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">j</span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">)&#34;</span>;
</span></span><span style="display:flex;"><span> $cmd <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; (insert </span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">{</span>$title<span style="color:#e6db74">}</span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">)&#34;</span>;
</span></span><span style="display:flex;"><span> $cmd <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; (end-of-buffer) (org-return) (org-cycle)&#34;</span>;
</span></span><span style="display:flex;"><span> $cmd <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; (insert </span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">{</span>$content<span style="color:#e6db74">}</span><span style="color:#ae81ff">\\\&#34;</span><span style="color:#e6db74">) (org-capture-finalize))</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">shell_exec</span>($cmd);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><br/>
<p>I start it with <code>php -S 0.0.0.0:8080</code> and it just works. It knows what templates I use and it knows where the <code>org-directory</code> is. <br/>
I deployed it to my home server (just a laptop in my closet) and run it using <a href="https://www.portainer.io/">Portainer</a>.</p>
<p>My home server is constantly available for me thanks to <a href="https://tailscale.com/">Tailscale</a> so I can access it outside of my home.</p>
<h2 id="why-not">Why not</h2>
<h3 id="why-not-orgzly">Why not Orgzly</h3>
<p><a href="https://github.com/orgzly-revived/orgzly-android-revived">Orgzly</a>, for those who doesn&rsquo;t know, is an Android app that
allows to interact with org-mode files. One can import org files in it and then just update them on the go.
Synchronization among machines can be done with <a href="https://syncthing.net/">Syncthing</a>.</p>
<p>It&rsquo;s very good app and I was using it for journaling a lot.
Often times though, I want to add a note to my journal and then I realize that I need to create
all the subheadings for today manually to follow the format I defined in my <code>org-capture-templates</code>. Not a big deal and it worked
for awhile but it stopped me from dumping my thoughts into the journal quite a few times.</p>
<h3 id="why-not-emacs-on-android-or-termux--emacs">Why not Emacs on Android or Termux + Emacs</h3>
<p>Both are great solutions as soon as one plugs in a keyboard into their phone. Using Emacs on a touch-screen is of course possible
but the amount of frustration I get in the first 10 seconds of using it feels very much unjustified.</p>
<h3 id="why-not-run-the-same-script-on-your-phone-locally">Why not run the same script on your phone locally</h3>
<p>In this case I don&rsquo;t need the whole home server setup with tailscale and portainer. Just syncthing which I already have would do the job.<br/>
Good point. I just wanted to have a bit more fun than that :)</p>