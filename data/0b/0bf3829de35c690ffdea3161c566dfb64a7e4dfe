<p>A benefit of running Emacs as a GUI app, is that you can view images from your beloved editor. This is super handy to take a quick peek at any image.</p>
<p>Sometimes, I'd like a little more than just viewing the image. I'd like to see basic image details like type, dimensions, and file size. The <a href="https://imagemagick.org/">imagemagick</a> <code>identify</code> utility is pretty handy for that.</p>
<pre><code class="language-bash">identify -format &quot;%m %wx%h %b&quot; path/to/image.png
</code></pre>
<p>I could easily invoke <code>shell-command</code> for this or even create a <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> function (maybe I will), but if this info was proactively displayed in the mode line, I wouldn't have to fetch it myself.</p>
<p>Since I know I can use the <code>identify</code> command for this, I may as well see if I can plug it into the mode line.</p>
<p>Turns out this wasn't too bad by setting <code>setting mode-line-format</code>. I added a little logic to only include image details while in <code>image-mode</code> and rely on <code>process-lines</code> to fetch the details. This function returns a list, which is a happy coincidence since <code>mode-line-format</code> also expects a list.</p>
<pre><code class="language-{.commonlisp">(setq-default mode-line-format
              '(&quot; &quot;
                mode-line-front-space
                mode-line-client
                mode-line-frame-identification
                mode-line-buffer-identification
                (:eval
                 (when (eq major-mode 'image-mode)
                   ;; Needs imagemagick installed.
                   (process-lines &quot;identify&quot; &quot;-format&quot; &quot;[%m %wx%h %b]&quot; (buffer-file-name))))
                &quot; &quot;
                mode-line-position
                (vc-mode vc-mode)
                (multiple-cursors-mode mc/mode-line)
                &quot; &quot; mode-line-modes
                mode-line-end-spaces))
</code></pre>
<p><img src="https://xenodium.github.io/images/displaying-image-details-in-mode-line/buddies.png" alt=""></p>
<p>I'd love to hear if there's a pure elisp alternative (<a href="https://indieweb.social/@xenodium">mastodon</a>/<a href="https://twitter.com/xenodium">twitter</a>). I gave <code>(image-size (image-get-display-property) :pixels)</code> a try, but that seemed to return the display size in buffer rather than actual file size.</p>
