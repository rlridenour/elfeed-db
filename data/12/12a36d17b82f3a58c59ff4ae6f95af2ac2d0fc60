<p>As an Emacs user, you&rsquo;ve probably found yourself wanting to clean up the indentation of an entire file. The standard approach is to select all (<code>C-x h</code>) and then run <code>indent-region</code> (I think, correct me if I am wrong!), but this has an annoying side effect: it destroys your current mark position, which might have been carefully set for other operations.</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/20250826095622-emacs--A-Better-Way-to-Indent-Your-Entire-Buffer-in-Emacs.jpg" width="100%">
</figure>

<p>Also, and just whisper it and don&rsquo;t tell anyone, but I have been using VSCode a little (only for work, of course!) and an indent by default seems to indent the whole file, which initially I thought would be really annoying, but actually it feels quite natural, as always at some point I would like to indent my code.</p>
<p>This is Emacs however and there is a simple solution and I&rsquo;ve added it to my Emacs configuration:</p>
<p>So, just a recap on some typical workflow, it goes a little something like this:</p>
<ol>
<li>You&rsquo;re working in a file with inconsistent indentation</li>
<li>You want to fix the entire buffer&rsquo;s formatting</li>
<li>You run <code>C-x h</code> (select all) followed by <code>M-x indent-region</code></li>
<li>Your mark is now at the beginning of the buffer, disrupting your workflow</li>
</ol>
<p>This is particularly frustrating when you&rsquo;ve set a mark for a specific editing task and want to preserve that position.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(defun indent-whole-buffer ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Indent the entire buffer without affecting point or mark.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (save-excursion
</span></span><span style="display:flex;"><span>    (save-restriction
</span></span><span style="display:flex;"><span>      (indent-region (<span style="color:#a6e22e">point-min</span>) (<span style="color:#a6e22e">point-max</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(global-set-key (kbd <span style="color:#e6db74">&#34;C-c i&#34;</span>) <span style="color:#e6db74">&#39;indent-whole-buffer</span>)
</span></span></code></pre></div><p>The function indents from <code>(point-min)</code> to <code>(point-max)</code>, covering the entire buffer, then restores everything to exactly how it was before, except now with proper indentation.</p>
<p>After adding this to your configuration, simply press <code>C-c i</code> (or whatever keybinding you prefer) to indent your entire buffer. Your cursor stays put, your mark remains set, and your file gets beautifully formatted!</p>