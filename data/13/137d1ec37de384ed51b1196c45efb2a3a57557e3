<p>Emacs <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Wdired.html">wdired</a> is a beautiful thing. You turn a directory representation into an editable buffer and you can do some magic. By magic, I mean you can apply your favourite text-editing commands to a directory and do some file management.</p>
<p>Take, for example, batch-renaming. Turn <code>wdired</code> on via <code>dired-toggle-read-only</code>, use something like Magnar's <a href="https://github.com/magnars/multiple-cursors.el">multiple-cursors</a> (or built-in <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macros.html">keyboard macros</a>) and commit via <code>wdired-finish-edit</code> (using the often-familar <code>C-c C-c</code> binding). You've now renamed multiple files as it if were any other text buffer. Pretty magical.</p>
<p><img src="https://xenodium.github.io/images/emacs-git-rename-courtesy-of-dired/wdired.gif" alt=""></p>
<p>One downside (or so I thought) is that wdired didn't automagically also take care of git renames for me, you know <a href="https://xenodium.com/emacs-dwim-do-what-i-mean/">DWIM-style</a>.</p>
<p>Every time I renamed anything via <code>wdired</code> and subsequently pulled up my trusty <a href="https://magit.vc/">magit</a>, I was a little sad it wasn't all just handledâ€¦ The renamed files were seen as deleted, along with all the untracked counterparts.</p>
<p><img src="https://xenodium.github.io/images/emacs-git-rename-courtesy-of-dired/rename-no-git.png" alt=""></p>
<p>So, I set out to change this unacceptable state of affairs ðŸ˜€. I started off by setting a breakpoint on <code>wdired-finish-edit</code> via edebug (see <a href="https://xenodium.com/inline-previous-result-and-why-you-should-edebug/">why this util is awesome</a>).</p>
<p>I wanted to see what <code>wdired-finish-edit</code> did under the hood, which led me to <code>dired-rename-file</code>. As I stepped through the code, I spotted the <code>dired-vc-rename-file</code> variable, which does exactly what you think it does ðŸ¤¦.</p>
<p>One <code>setq</code> laterâ€¦</p>
<pre><code class="language-{.commonlisp">(setq dired-vc-rename-file t)
</code></pre>
<p>â€¦and boom! From now on, renaming from dired does exactly what you would expect. Here's <code>magit</code> to prove it:</p>
<p><img src="https://xenodium.github.io/images/emacs-git-rename-courtesy-of-dired/rename-with-git.png" alt=""></p>
<p>lol. I was so fixated on &quot;adding git rename support&quot;, that I forgot to first search the documentation.</p>
<p>While you can search for variables via the built-in <code>describe-variable</code>, I'm a fan of Wilfred's <a href="https://github.com/Wilfred/helpful">helpful</a> equivalent: <code>helpful-variable</code>. Coupled with with your favourite completion framework (Abo Abo's <a href="https://github.com/abo-abo/swiper">ivy</a> for me), it's as easy a fuzzy searching for anything you're after:</p>
<p><img src="https://xenodium.github.io/images/emacs-git-rename-courtesy-of-dired/dired-vc-rename-file.png" alt=""></p>
<p><em>This post is also at <a href="https://lmno.lol/alvaro/emacs-git-rename-courtesy-of-dired">lmno.lol</a>.</em></p>
