<p>A few weeks ago, I wrote about an experiment to bring <a href="https://xenodium.com/a-chatgpt-emacs-shell/">ChatGPT to Emacs as a shell</a>. I was fairly new to both <a href="https://openai.com/blog/chatgpt">ChatGPT</a> and building anything on top of <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Prompts.html">comint</a>. It was a fun exercise, which also generated some interest.</p>
<p>As mentioned in the previous post, I took inspiration in other Emacs packages (primarily <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Interaction.html">ielm</a>) to figure out what I needed from comint. Soon, I got ChatGPT working.</p>
<p><img src="https://xenodium.github.io/images/a-shell-maker/streamer.gif" alt=""></p>
<p>As I was looking at <a href="https://openai.com">OpenAI</a> API docs, I learned about DALL-E: &quot;an AI system that can create realistic images and art from a description in natural language.&quot;</p>
<p>Like ChatGPT, they also offered an API to DALL-E, so I figured I may as well try to write a shell for that tooâ€¦ and I did.</p>
<p><img src="https://xenodium.github.io/images/a-shell-maker/dalle.gif" alt=""></p>
<p>There was quite a bit of code duplication between the two Emacs shells I had just written. At the same time, I started hearing from folks about integrating other tools, some cloud-based, some local, proprietary, open source.. There's <a href="https://about.sourcegraph.com/cody">Cody</a>, <a href="https://github.com/invoke-ai/InvokeAI">invoke-ai</a>, <a href="https://github.com/ggerganov/llama.cpp">llama.cpp</a>, <a href="https://github.com/antimatter15/alpaca.cpp">alpaca.cpp</a>, and the list continues to grow.</p>
<p>With that in mind, I set out to reduce the code duplication and consolidate into a reusable package. And so <code>shell-maker</code> was born, a maker of Emacs shells.</p>
<p><code>shell-maker</code>'s internals aren't too different from the code I had before. It's still powered by comint, but instead offers a reusable convenience wrapper.</p>
<p>It takes little code to implement a shell, like the sophisticated new <code>greeter-shell</code> ;)</p>
<p><img src="https://xenodium.github.io/images/a-shell-maker/maria.gif" alt=""></p>
<pre><code class="language-{.commonlisp">(require 'shell-maker)

(defvar greeter-shell--config
  (make-shell-maker-config
   :name &quot;Greeter&quot;
   :execute-command
   (lambda (command _history callback error-callback)
     (funcall callback
              (format &quot;Hello \&quot;%s\&quot;&quot; command)
              nil))))

(defun greeter-shell ()
  &quot;Start a Greeter shell.&quot;
  (interactive)
  (shell-maker-start greeter-shell--config))
</code></pre>
<p><a href="https://github.com/xenodium/chatgpt-shell#shell-maker">shell-maker</a> is available on GitHub and currently bundled with <a href="https://github.com/xenodium/chatgpt-shell">chatgpt-shell</a>. If there's enough interest and usage, I may just break it out into its own package. For now, it's convenient to keep with <code>chatgpt-shell</code> and <code>dall-e-shell</code>.</p>
<p>If you plug <code>shell-maker</code> into other tools, I'd love to hear about it.</p>
<p>Happy shell making!</p>
