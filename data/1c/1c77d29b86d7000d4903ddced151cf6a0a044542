<p>If you are an emacser, you are probably already following the <a href="https://sachachua.com/blog/">Sacha
Chua&rsquo;s blog</a>. If you are not, you should.
Sacha maintains an incredible blog on Emacs-related news, upcoming
events, Org Mode, configuration, new packages, and many other things
from the Emacs world.</p>
<p>English is not my native language so I need <em>the right tools</em> to
improve my language skills. My favorite tool is the
<a href="https://www.reverso.net/text-translation">Reverso</a> web service, an
AI-powered service for translation, grammar check, context, and
synonyms search.</p>
<p>Of course, I&rsquo;d prefer to use it in Emacs directly, and in
<a href="https://sachachua.com/blog/2022/08/2022-08-29-emacs-news/">one</a> of
the latest Sacha&rsquo;s posts I found what I had been searching for -
<a href="https://github.com/SqrtMinusOne/reverso.el">reverso.el</a>.</p>
<p>At the time of writing, the package isnâ€™t yet available anywhere but
in the author&rsquo;s GitHub repository, so as a first step you need either
to download or to clone this package to your box.</p>
<p>I&rsquo;ve cloned it to my <code>~/emacs.d/extras/</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>git clone https://github.com/SqrtMinusOne/reverso.el.git
</span></span></code></pre></div><p>Secondly, you need to add this directory to your <code>load-path</code> and
<code>require</code> the package.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;load-path</span> <span style="color:#e6db74">&#34;~/.emacs.d/extras/reverso.el/&#34;</span>)
</span></span></code></pre></div><p>Almost done.</p>
<p>Because I&rsquo;m using Reverso quite often, I decided to implement a
<em>smart</em> start-up function and to bind it to a <em>common</em> key like
<code>&lt;F9&gt;</code>. I want to distinguish between the <em>Translation</em> (applied to a
single word) and the <em>Context</em> (applied to a phrase or a sentence)
features of Reverso. So now if you press <code>&lt;F9&gt;</code> <em>and</em> there is some
region selected (active, in terminology of Emacs), <code>reverso-context</code>
is called, else, if no region selected, <code>reverso-translate</code> is
called for a word under the cursor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span><span style="color:#75715e">;; Reverso context</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; https://github.com/SqrtMinusOne/reverso.el</span>
</span></span><span style="display:flex;"><span>(require <span style="color:#e6db74">&#39;reverso</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun avs/reverso ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Calls </span><span style="color:#e6db74">`reverso&#39;</span><span style="color:#e6db74"> functions depending on selection.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">If a region (selection) is active, calls </span><span style="color:#e6db74">`reverso-context&#39;</span><span style="color:#e6db74">,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">otherwise calls </span><span style="color:#e6db74">`reverso-translate&#39;</span><span style="color:#e6db74"> for a word under the cursor.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (if (region-active-p)
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">;; Region is active, use context.</span>
</span></span><span style="display:flex;"><span>      (reverso-context)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Region is not active, get word coordinates...</span>
</span></span><span style="display:flex;"><span>    (let ((bounds (bounds-of-thing-at-point <span style="color:#e6db74">&#39;word</span>))
</span></span><span style="display:flex;"><span>          (p (<span style="color:#a6e22e">point</span>))
</span></span><span style="display:flex;"><span>          )
</span></span><span style="display:flex;"><span>      (if bounds
</span></span><span style="display:flex;"><span>          (progn
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">;; ...select the word under cursor...</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">car</span> bounds))
</span></span><span style="display:flex;"><span>            (set-mark-command <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">cdr</span> bounds))
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">;; ...and translate it.</span>
</span></span><span style="display:flex;"><span>            (reverso-translate)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">;; Then back to the initial position.</span>
</span></span><span style="display:flex;"><span>            (deactivate-mark)
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">goto-char</span> p)
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;No word under cursor!&#34;</span>)
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(global-set-key [(f9)] <span style="color:#a6e22e">#&#39;</span>avs/reverso)
</span></span></code></pre></div><figure><img src="http://localhost:1313/img/reverso-translate.png"/><figcaption>
            <h4>The word &#39;deposed&#39; is under the cursor, no region is active, &lt;F9&gt; calls `reverso-translate&#39;.</h4>
        </figcaption>
</figure>

<figure><img src="http://localhost:1313/img/reverso-context.png"/><figcaption>
            <h4>The region &#39;different kind of weather&#39; is active, &lt;F9&gt; calls `reverso-context&#39;</h4>
        </figcaption>
</figure>

<p>Many thanks to <a href="https://github.com/SqrtMinusOne">Pavel Korytov</a> for
the excellent packages, and, indeed, to <a href="https://sachachua.com/blog/contact/">Sacha
Chua</a> for pointing it out to all of us.</p>