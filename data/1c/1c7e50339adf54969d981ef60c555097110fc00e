
	
<p>
Euler Problem 35 takes us back to the world of prime numbers, in particular <a href="https://en.wikipedia.org/wiki/Circular_prime">circular primes</a>. The Online Encyclopedia of Integers (<a href="https://oeis.org/A068652">A068652</a>) lists the first 46 decimal numbers for which every cyclic permutation is a prime.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 35 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The number 197 is a decimal circular prime because all rotations of the digits: 197, 971, and 719, are themselves prime.</p>
<p>
There are thirteen such primes below 100: 2, 3, 5, 7, 11, 13, 17, 31, 37, 71, 73, 79, and 97.</p>
<p>
<a href="https://projecteuler.net/problem=35">How many circular primes are there below one million</a>?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution in R
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>This code reuses the function that strips all digits for a number, presented in <a href="https://lucidmanager.org/data-science/project-euler-30/">Euler Problem 30</a>. The solution for this problem also use the <code class="verbatim">is_prime</code> function to test whether a number is a prime, developed for <a href="https://lucidmanager.org/data-science/project-euler-7/">Euler Problem 7</a>. </p>
<p>
The following auxiliary functions help to solve the problem:</p>
<ul>
<li><code>prime_sieve</code>: Generate primes</li>
<li><code>is_prime</code>: Checks whether a number is prime</li>
<li><code>rotate_left</code>: Rotates the a number</li>
</ul>
<p>The <code>is_circular_prime</code> function first removes any numbers greater than 9 that contains either a 0, 2, 4, 5, 6 or 8, as at least one rotation will be <a href="https://t5k.org/glossary/page.php?sort=CircularPrime">divisible by either 2 or 5</a>, which drastically reduces the search space.</p>
<p>
The main program tests each of the 78,498 primes below one million and counts the number of circular ones.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  prime_sieve <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(x) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">NULL</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#080;font-weight:bold">return</span>(n)
</span></span><span style="display:flex;"><span>    l <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">2</span><span style="color:#333">:</span>x
</span></span><span style="display:flex;"><span>    i <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    p <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">while</span> (p^2 <span style="color:#333">&lt;=</span> x) {
</span></span><span style="display:flex;"><span>      l <span style="color:#333">&lt;-</span> l[l <span style="color:#333">==</span> p <span style="color:#333">|</span> l <span style="color:#333">%%</span> p<span style="color:#333">!=</span> <span style="color:#60e;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>      i <span style="color:#333">&lt;-</span> i <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      p <span style="color:#333">&lt;-</span> l[i]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(l)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  is_prime <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(x) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">&lt;=</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">|</span> x <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>    primes <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">prime_sieve</span>(<span style="color:#06b;font-weight:bold">ceiling</span>(<span style="color:#06b;font-weight:bold">sqrt</span>(x)))
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">all</span>(x <span style="color:#333">%%</span> primes <span style="color:#333">!=</span> <span style="color:#60e;font-weight:bold">0</span>))
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  x <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">101</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  rotate_left <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(x) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">10</span>) <span style="color:#080;font-weight:bold">return</span>(x)
</span></span><span style="display:flex;"><span>    n <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">log10</span>(x)) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    first_digit <span style="color:#333">&lt;-</span> x <span style="color:#333">%/%</span> <span style="color:#60e;font-weight:bold">10</span><span style="color:#06b;font-weight:bold">^</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    rest <span style="color:#333">&lt;-</span> x <span style="color:#333">%%</span> <span style="color:#60e;font-weight:bold">10</span><span style="color:#06b;font-weight:bold">^</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>    rotated <span style="color:#333">&lt;-</span> rest <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">10</span> <span style="color:#333">+</span> first_digit
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(rotated)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  is_circular_prime <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(x) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">9</span> <span style="color:#333">&amp;</span> <span style="color:#06b;font-weight:bold">any</span>(<span style="color:#06b;font-weight:bold">grepl</span>(<span style="background-color:#fff0f0">&#34;[024568]&#34;</span>, <span style="color:#06b;font-weight:bold">as.character</span>(x)))) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>    n <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">log10</span>(x)) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    p <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">vector</span>(length <span style="color:#333">=</span> n)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">for</span> (r <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">1</span><span style="color:#333">:</span>n) {
</span></span><span style="display:flex;"><span>      p[r] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">is_prime</span>(x)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#333">!</span>p[r] ) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>      x <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">rotate_left</span>(x)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  primes <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">prime_sieve</span>(<span style="color:#60e;font-weight:bold">1E6</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">system.time</span>({
</span></span><span style="display:flex;"><span>    circular_primes <span style="color:#333">&lt;-</span> primes<span style="color:#06b;font-weight:bold">[sapply</span>(primes, is_circular_prime)]
</span></span><span style="display:flex;"><span>    <span style="color:#06b;font-weight:bold">print</span>(<span style="color:#06b;font-weight:bold">length</span>(circular_primes))
</span></span><span style="display:flex;"><span>  })</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>

      