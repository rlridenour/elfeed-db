<p>UPDATE: <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> is now available on <a href="https://melpa.org/#/dwim-shell-command">melpa</a>.</p>
<p><img src="https://xenodium.github.io/images/emacs-dwim-shell-command-multi-language/csv.gif" alt=""></p>
<p>I keep on <a href="https://xenodium.com/png-to-icns-emacs-dwim-style/">goofying around</a> with <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> and it's sibling <code>dwim-shell-command-on-marked-files</code> from <a href="https://github.com/xenodium/dwim-shell-command/blob/main/dwim-shell-command.el">dwim-shell-command.el</a>.</p>
<p>In addition to defaulting to <a href="https://en.wikipedia.org/wiki/Z_shell">zsh</a>, <code>dwim-shell-command-on-marked-files</code> now support other shells and languages. This comes in handy if you have snippets in different languages and would like to easily invoke them from Emacs. Multi-language support enables &quot;using the best tool for the job&quot; kinda thing. Or maybe you just happen to know how to solve a particular problem in a specific language.</p>
<p>Let's assume you have an existing Python snippet to convert files from csv to json. With <code>dwim-shell-command-on-marked-files</code>, you can invoke the Python snippet to operate on either <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html">dired</a> or buffer files.</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-command-csv-to-json-via-python ()
  &quot;Convert csv file to json (via Python).&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;Convert csv file to json (via Python).&quot;
   &quot;
import csv
import json
text = json.dumps({ \&quot;values\&quot;: list(csv.reader(open('&lt;&lt;f&gt;&gt;')))})
fpath = '&lt;&lt;fne&gt;&gt;.json'
with open(fpath , 'w') as f:
  f.write(text)&quot;
   :shell-util &quot;python&quot;
   :shell-args &quot;-c&quot;))
</code></pre>
<p>Or, maybe you prefer Swift and already had a snippet for the same thing?</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-command-csv-to-json-via-swift ()
  &quot;Convert csv file to json (via Swift).&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;Convert csv file to json (via Swift).&quot;
   &quot;
    import Foundation
    import TabularData
    let filePath = \&quot;&lt;&lt;f&gt;&gt;\&quot;
    print(\&quot;reading \\(filePath)\&quot;)
    let content = try String(contentsOfFile: filePath).trimmingCharacters(in: .whitespacesAndNewlines)
    let parsedCSV = content.components(separatedBy: CSVWritingOptions().newline).map{
      $0.components(separatedBy: \&quot;,\&quot;)
    }
    let jsonEncoder = JSONEncoder()
    let jsonData = try jsonEncoder.encode([\&quot;value\&quot;: parsedCSV])
    let json = String(data: jsonData, encoding: String.Encoding.utf8)
    let outURL = URL(fileURLWithPath:\&quot;&lt;&lt;fne&gt;&gt;.json\&quot;)
    try json!.write(to: outURL, atomically: true, encoding: String.Encoding.utf8)
    print(\&quot;wrote \\(outURL)\&quot;)&quot;
   :shell-pipe &quot;swift -&quot;))
</code></pre>
<p>You can surely solve the same problem in elisp, but hey it's nice to have options and flexibility.</p>
