<p>Every so often, I rotate my monitor (vertical vs horizontal) for either work or to watch a movie. macOS enables changing the display rotation via a dropdown menu (under <em>Preferences &gt; Displays &gt; Rotation</em>) where you can pick between <em>Standard</em>, <em>90°</em>, <em>180°</em>, and <em>270°</em>. That's all fine, but what I'd really like is a quick way to toggle between my preferred two choices: <em>Standard</em> and <em>270°</em>.</p>
<p>Unsurprisingly, I'd also like to invoke it as an interactive command via Emacs's <em>M-x</em> (see <a href="http://xenodium.com/emacs-connect-my-bluetooth-speaker/index.html">Emacs: connect my Bluetooth speaker</a>). With narrowing frameworks like <a href="https://github.com/abo-abo/swiper">ivy</a>, <a href="https://emacs-helm.github.io/helm/">helm</a>, and <a href="https://www.gnu.org/software/emacs/manual/html_mono/ido.html">ido</a>, invoking these commands is just a breeze.</p>
<p>Turns out, this was pretty simple to accomplish, thanks to Eric Nitardy's <a href="https://github.com/CdLbB/fb-rotate">fb-rotate</a> command line utility. All that's left to do is wrap it in a tiny elisp <s>function</s> hack, add the toggling logic, and voilà!</p>
<p><img src="https://xenodium.github.io/images/emacs-rotate-my-macos-display/rotate.gif" alt=""></p>
<p><em>The screen capture goes a little funky when rotating the display, but you get the idea. It works better in person :)</em></p>
<p>…and here's the snippet:</p>
<pre><code class="language-{.commonlisp">(defun ar/display-toggle-rotation ()
  (interactive)
  (require 'cl-lib)
  (cl-assert (executable-find &quot;fb-rotate&quot;) nil
             &quot;Install fb-rotate from https://github.com/CdLbB/fb-rotate&quot;)
  ;; #  Display_ID    Resolution  ____Display_Bounds____  Rotation
  ;; 2  0x2b347692    1440x2560      0     0  1440  2560    270    [main]
  ;; From fb-rotate output, get the `current-rotation' from Column 7, row 1 zero-based.
  (let ((current-rotation (nth 7 (split-string (nth 1 (process-lines &quot;fb-rotate&quot; &quot;-i&quot;))))))
    (call-process-shell-command (format &quot;fb-rotate -d 1 -r %s&quot;
                                        (if (equal current-rotation &quot;270&quot;)
                                            &quot;0&quot;
                                          &quot;270&quot;)))))
</code></pre>
