
	
<p>
Playing pool at a square table can be hard enough for most people. But what about testing your skills on an oval table? <a href="https://projecteuler.net/problem=144">Project Euler 144</a> investigates multiple reflections of a laser beam. This problem is mathematically equivalent to bouncing billiard balls in an elliptical pool table, demonstrated by Ales Bellow in the video below. This article provides a solution to the Euler problem and simulates playing pool in an elliptical table. </p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/4KHCuXN2F3I?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Alex Bellos, Elliptical Pool Table - Numberphile.
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 144 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>In laser physics, a “white cell” is a mirror system that acts as a delay line for the laser beam. The beam enters the cell, bounces around on the mirrors, and eventually works its way back out.</p>
<p>
The specific white cell we will be considering is an ellipse with the equation $4x^2 + y^2= 100$. The section corresponding to $-0.01 \leq \times \leq +0.01$ at the top is missing, allowing the light to enter and exit through the hole.</p>
<figure>
<img src="https://lucidmanager.org/images/project-euler/problem-144a.png" alt="Project Euler 144: Laser Beams and Elliptical Billiards" title="Project Euler 144: Laser Beams and Elliptical Billiards"/>
<figcaption>
White cell.
</figcaption>
</figure>
<p>
The light beam in this problem starts at the point (0.0, 10.1) just outside the white cell, and the beam first impacts the mirror at (1.4, -9.6). Each time the laser beam hits the surface of the ellipse, it follows the usual law of reflection “angle of incidence equals the angle of reflection.”</p>
<p>
Both the incident and reflected beams make the same angle with the normal line at the point of incidence. In the figure on the left, the red line shows the first two points of contact between the laser beam and the wall of the white cell; the blue line indicates the line tangent to the ellipse at the point of incidence of the first bounce.</p>
<p>
The slope $m$ of the tangent line at any point $(x,y)$ of the given ellipse is $m = -4x/y$. The normal line is perpendicular to this tangent line at the point of incidence.</p>
<p>
How many times does the beam hit the internal surface of the white cell before exiting?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>The first step was to rewrite the equation to use functions to generalise the problem. The general Cartesian equation for an ellipse is:</p>
<p>
$$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1, a &lt; b$$</p>
<p>
The length of the axes for this problem is $a =5$ and $b = 10$. While the Project Euler description gives the formula for the tangent slope to the ellipse, I have generalised the code to reuse it for the elliptical billiards table. The slope of the tangent to an ellipse at point $(x,y)$ is:</p>
<p>
$$m=-\frac{b^2x}{a^2y}$$</p>
<p>
This first code snippet defines functions to draw an ellipse and calculate the bouncing angle. The last part of the code bounces the laser inside the cell until it exits through the top.</p>
<p>
The formula to find the intersection between a line and an ellipse has two possible solutions, one of which is the same as the original point.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  plot_ellipse <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(a, b, colour <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">NA</span>, line <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;black&#34;</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">plot.new</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">plot.window</span>(xlim <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#333">-</span>a, a), ylim <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#333">-</span>b, b), asp <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">par</span>(mar <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">0</span>,<span style="color:#60e;font-weight:bold">4</span>))
</span></span><span style="display:flex;"><span>      x <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">seq</span>(<span style="color:#333">-</span>a, a, length <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">200</span>)
</span></span><span style="display:flex;"><span>      y <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sqrt</span>(b^2 <span style="color:#333">-</span> (b^2 <span style="color:#333">/</span> a^2) <span style="color:#333">*</span> x^2)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">lines</span>(x, y, col <span style="color:#333">=</span> line)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">lines</span>(x, <span style="color:#333">-</span>y, col <span style="color:#333">=</span> line)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">polygon</span>(x, y, col <span style="color:#333">=</span> colour, border <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">NA</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">polygon</span>(x, <span style="color:#333">-</span>y, col <span style="color:#333">=</span> colour, border <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">NA</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  bounce <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(coords) {
</span></span><span style="display:flex;"><span>      x <span style="color:#333">&lt;-</span> coords<span style="color:#333">$</span>x
</span></span><span style="display:flex;"><span>      y <span style="color:#333">&lt;-</span> coords<span style="color:#333">$</span>y
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Tangent to ellipse</span>
</span></span><span style="display:flex;"><span>      t <span style="color:#333">&lt;-</span> <span style="color:#333">-</span>(b^2 <span style="color:#333">/</span> a^2) <span style="color:#333">*</span> (x[2] <span style="color:#333">/</span> y[2])
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Deflection on sloping mirror y = mx + c</span>
</span></span><span style="display:flex;"><span>      dydx <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">diff</span>(y) <span style="color:#333">/</span> <span style="color:#06b;font-weight:bold">diff</span>(x)
</span></span><span style="display:flex;"><span>      m <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">tan</span>(<span style="color:#080;font-weight:bold">pi</span> <span style="color:#333">-</span> <span style="color:#06b;font-weight:bold">atan</span>(dydx) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">*</span> <span style="color:#06b;font-weight:bold">atan</span>(t))
</span></span><span style="display:flex;"><span>      c <span style="color:#333">&lt;-</span> y[2] <span style="color:#333">-</span> m <span style="color:#333">*</span> x[2]
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Determine intersection point</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Source: http://www.ambrsoft.com/TrigoCalc/Circles2/Ellipse/EllipseLine.htm</span>
</span></span><span style="display:flex;"><span>      x[1] <span style="color:#333">&lt;-</span> x[2]
</span></span><span style="display:flex;"><span>      y[1] <span style="color:#333">&lt;-</span> y[2]
</span></span><span style="display:flex;"><span>      x2 <span style="color:#333">&lt;-</span> (<span style="color:#333">-</span>a^2 <span style="color:#333">*</span> m <span style="color:#333">*</span> c <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">-1</span>, <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#333">*</span> (a <span style="color:#333">*</span> b <span style="color:#333">*</span> <span style="color:#06b;font-weight:bold">sqrt</span>(a^2 <span style="color:#333">*</span> m^2 <span style="color:#333">+</span> b^2 <span style="color:#333">-</span> c^2))) <span style="color:#333">/</span>
</span></span><span style="display:flex;"><span>            (a^2 <span style="color:#333">*</span> m^2 <span style="color:#333">+</span> b^2)
</span></span><span style="display:flex;"><span>      x[2] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">ifelse</span>(<span style="color:#06b;font-weight:bold">round</span>(x[1] <span style="color:#333">/</span> x2[1], <span style="color:#60e;font-weight:bold">6</span>) <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">1</span>, x2[2], x2[1])
</span></span><span style="display:flex;"><span>      y[2] <span style="color:#333">&lt;-</span> m <span style="color:#333">*</span> x[2] <span style="color:#333">+</span> c
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">data.frame</span>(x, y))
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888"># Initial conditions</span>
</span></span><span style="display:flex;"><span>  a <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>  b <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>  x1 <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  y1 <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">10.1</span>
</span></span><span style="display:flex;"><span>  x2 <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1.4</span>
</span></span><span style="display:flex;"><span>  y2 <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">-9.6</span>
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">plot_ellipse</span>(a, b)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">points</span>(<span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">0</span>,<span style="color:#60e;font-weight:bold">0</span>), <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#333">-</span>c, c), pch <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">19</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Bounce laser breams</span>
</span></span><span style="display:flex;"><span>  laser <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">data.frame</span>(x <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(x1, x2), y <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(y1, y2))
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">while</span>((laser<span style="color:#333">$</span>x[2] <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">-0.01</span> <span style="color:#333">|</span> laser<span style="color:#333">$</span>x[2] <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">0.01</span>) <span style="color:#333">|</span> laser<span style="color:#333">$</span>y[2] <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">0</span>) { <span style="color:#888">## Escape?</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">lines</span>(laser<span style="color:#333">$</span>x, laser<span style="color:#333">$</span>y, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;red&#34;</span>, lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">.5</span>)
</span></span><span style="display:flex;"><span>      laser <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">bounce</span>(laser)
</span></span><span style="display:flex;"><span>      answer <span style="color:#333">&lt;-</span> answer <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<figure>
<img src="https://lucidmanager.org/images/project-euler/problem-144-laser-beams.png" alt="Multiple reflections of a laser beam." title="Multiple reflections of a laser beam."/>
<figcaption>
Multiple reflections of a laser beam.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Elliptical Pool Table
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>We can use the solution to Euler problem 144 to play billiards on an elliptical billiards table. To close the article, we return to the elliptical pool table demonstrated by Alex Bellos. This code draws the pool table to the dimensions mentioned in the video. We know that the table has an eccentricity of $e = 0.43$ and a long axis of $a = 130$ cm. The code defines the short axis ($b$) and the distance of the focal points from the centre.</p>
<p>
The code selects a random starting point and angle of the shot. The code first determines whether the line passes through the pocket. If this is not the case, the algorithm then finds the place where the ball hits and keeps bouncing it until it falls into the pocket, or the ball bounces 100 times.</p>
<figure>
<img src="https://lucidmanager.org/images/project-euler/problem-144-pool-table.png" alt="/images/project-euler/problem-144-pool-table.png" title="/images/project-euler/problem-144-pool-table.png" /><figcaption>
Elliptical pool table simulation.
</figcaption>
</figure>
<p>
Elliptical billiard tables have four possible outcomes. Any ball the pass through a focal point will fall into the pocket, ending the simulation. Any ball that passes outside the focal points will bounce around, and the combined trajectories form an ellipse. When the ball moves between the foci, the result is a hyperbola. Lastly, some unique circumstances result in a regular polygon.</p>
<p>
If simulations are not enough for you, then head over to the <a href="http://www.instructables.com/id/Elliptical-Pool-Table/">Instructables</a> website to find out how you can construct an elliptical billiards table. There is even a patent for an <a href="https://patents.google.com/patent/US5226644">elliptical pocket billiard table</a>, with the pockets at the edge.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  e <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0.43</span>
</span></span><span style="display:flex;"><span>  a <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">130</span>
</span></span><span style="display:flex;"><span>  b <span style="color:#333">&lt;-</span> a <span style="color:#333">*</span> <span style="color:#06b;font-weight:bold">sqrt</span>((<span style="color:#60e;font-weight:bold">1</span> <span style="color:#333">+</span> e) <span style="color:#333">*</span> (<span style="color:#60e;font-weight:bold">1</span> <span style="color:#333">-</span> e)) <span style="color:#888"># a &gt; b</span>
</span></span><span style="display:flex;"><span>  f <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sqrt</span>(a^2 <span style="color:#333">-</span> b^2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">plot_ellipse</span>(a, b, <span style="background-color:#fff0f0">&#34;darkgreen&#34;</span>, <span style="color:#080;font-weight:bold">NA</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">points</span>(<span style="color:#333">-</span>f, <span style="color:#60e;font-weight:bold">0</span>, pch <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">19</span>, cex <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">points</span>(f, <span style="color:#60e;font-weight:bold">0</span>, pch <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">19</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;grey&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Simulate random shot</span>
</span></span><span style="display:flex;"><span>  angle <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">runif</span>(<span style="color:#60e;font-weight:bold">1</span>, <span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">*</span> <span style="color:#080;font-weight:bold">pi</span>)
</span></span><span style="display:flex;"><span>  x1 <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">runif</span>(<span style="color:#60e;font-weight:bold">1</span>, <span style="color:#333">-</span>a, a)
</span></span><span style="display:flex;"><span>  ymax <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sqrt</span>(b^2 <span style="color:#333">-</span> (b^2 <span style="color:#333">/</span> a^2) <span style="color:#333">*</span> x1^2)
</span></span><span style="display:flex;"><span>  y1 <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">runif</span>(<span style="color:#60e;font-weight:bold">1</span>, <span style="color:#333">-</span>ymax, ymax)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## First shot</span>
</span></span><span style="display:flex;"><span>  m <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">tan</span>(angle)
</span></span><span style="display:flex;"><span>  c <span style="color:#333">&lt;-</span> y1 <span style="color:#333">-</span> m <span style="color:#333">*</span> x1
</span></span><span style="display:flex;"><span>  x2 <span style="color:#333">&lt;-</span> (<span style="color:#333">-</span>a^2 <span style="color:#333">*</span> m <span style="color:#333">*</span> c <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">-1</span>, <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#333">*</span> (a <span style="color:#333">*</span> b <span style="color:#333">*</span> <span style="color:#06b;font-weight:bold">sqrt</span>(a^2 <span style="color:#333">*</span> m^2 <span style="color:#333">+</span> b^2 <span style="color:#333">-</span> c^2))) <span style="color:#333">/</span> (a^2 <span style="color:#333">*</span> m^2 <span style="color:#333">+</span> b^2)
</span></span><span style="display:flex;"><span>  y2 <span style="color:#333">&lt;-</span> m <span style="color:#333">*</span> x2 <span style="color:#333">+</span> c
</span></span><span style="display:flex;"><span>  x2 <span style="color:#333">&lt;-</span> x2<span style="color:#06b;font-weight:bold">[which</span>(((x2 <span style="color:#333">-</span> x1) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">0</span>) <span style="color:#333">==</span> (<span style="color:#06b;font-weight:bold">cos</span>(angle) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">0</span>))]
</span></span><span style="display:flex;"><span>  y2 <span style="color:#333">&lt;-</span> y2<span style="color:#06b;font-weight:bold">[which</span>(((y2 <span style="color:#333">-</span> y1) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">0</span>) <span style="color:#333">==</span> (<span style="color:#06b;font-weight:bold">sin</span>(angle) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">0</span>))]
</span></span><span style="display:flex;"><span>  shot <span style="color:#333">&lt;-</span> (<span style="color:#06b;font-weight:bold">data.frame</span>(x <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(x1, x2), y <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(y1, y2)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Bounce ball</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">1</span><span style="color:#333">:</span><span style="color:#60e;font-weight:bold">100</span>){
</span></span><span style="display:flex;"><span>      dydx <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">diff</span>(shot<span style="color:#333">$</span>y) <span style="color:#333">/</span> <span style="color:#06b;font-weight:bold">diff</span>(shot<span style="color:#333">$</span>x)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">all.equal</span>(dydx, (shot<span style="color:#333">$</span>y[1] <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">0</span>) <span style="color:#333">/</span> (shot<span style="color:#333">$</span>x[1] <span style="color:#333">-</span> <span style="color:#333">-</span>f)) <span style="color:#333">==</span> <span style="color:#080;font-weight:bold">TRUE</span>) {
</span></span><span style="display:flex;"><span>          shot[2, ] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#333">-</span>f, <span style="color:#60e;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">lines</span>(shot<span style="color:#333">$</span>x, shot<span style="color:#333">$</span>y, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;yellow&#34;</span>, lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (shot[2,<span style="color:#60e;font-weight:bold">2</span>] <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) <span style="color:#080;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>      shot <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">bounce</span>(shot)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">points</span>(x1, y1, pch <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">19</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;blue&#34;</span>, cex <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">1.8</span>)</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>

      