
	
<p>
Data is almost always produced to manage operations and rarely collected to analyse it in the future. The available data is thus never in an ideal format and needs to be converted to be suitable for analysis. We need, at minimum, a clear data structure, the correct variable types, and readable variables names. Preparing data for analysis, sometimes called data munging or wrangling, is an essential part of the data science workflow. <a href="https://dx.doi.org/10.1201/9781003326977-7">This chapter</a> of <em>Data Science for Water Utilities</em> introduces some techniques to clean data with R and the Tidyverse to create reproducible code. This chapter introduces a case study about customer perceptions about tap water. The learning objectives for this session are:</p>
<ul>
<li>Use the dplyr package to transform data.</li>
<li>Apply the principles of tidy data.</li>
<li>Develop a script to automate data cleaning.</li>
</ul>
<p>

  <div class="box">
    <div class="media">
      <figure class="media-left">
        <p class="image is-128x128">
          <img src="https://lucidmanager.org/images/books/2023_ds4wu.jpg" alt = "Data Science for Water Utilities" title = "Data Science for Water Utilities">
        </p>
      </figure>
      <div class="media-content">
        <div class="content">
          <p class="is-size-5 has-text-weight-bold">Data Science for Water Utilities</p>
          <p class="mb-2">Data Science for Water Utilities published by CRC Press is an applied, practical guide that shows water professionals how to use data science to solve urban water management problems using the R language for statistical computing.</p>
          <div class="buttons">
            <a class="button is-info" href="https://routledge.com/9781032354545" target="_blank">
              <span class="icon">
                <i class="fas fa-shopping-cart"></i>
              </span>
              <span>Routledge</span>
            </a>
            <a class="button is-info" href="https://www.amazon.com/Data-Science-Water-Utilities-Chapman/dp/1032354550" target="_blank">
              <span class="icon">
                <i class="fas fa-shopping-cart"></i>
              </span>
              <span>Amazon</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</p>
<p>
The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Case Study 2: Understanding the Customer Experience
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The data for this case study is a survey to measure the customer experience of the customers of a water utility. This data is generated with online survey software and contains information about:</p>
<ul>
<li><a href="https://lucidmanager.org/data-science/measuring-consumer-involvement/">Consumer Involvement</a></li>
<li>Customer contact frequency</li>
<li>Level of financial hardship</li>
<li>Service Quality</li>
</ul>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Data Cleaning
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>Data cleaning, or data jujitsu as some call it, consists of three steps:</p>
<ol>
<li>Load and explore the data</li>
<li>Convert the data structure</li>
<li>Remove invalid data</li>
</ol>
<p>A basic principle of good data science is never to manually clean data. Using a script to clean your data means that it is reproducible for other data sets with the same structure and issues and you can always go back to the raw data in case something went wrong.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Tidy Data
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>The Tidyverse uses the principles of <a href="https://www.jstatsoft.org/article/view/v059i10/">Tidy Data</a>, which means that:</p>
<ul>
<li>Each variable forms a column</li>
<li>Each observation forms a row</li>
<li>Each type of observational unit forms a table</li>
</ul>
<p>The data on the left is untidy because the variable is spread over multiple columns. We can fix this by pivoting the data so  that the locations are no longer column names, but they become data.</p>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/tidy-data.png" alt="Untidy and tidy version of laboratory data" title="Untidy and tidy version of laboratory data" width="600"/>
<figcaption>
Untidy and tidy version of laboratory data.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Managing Dirty Data Screencast
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>Chapter seven of <em>Data Science for Water Utilities</em> explains using the dplyr package to clean data in more detail. This screencast below reviews the code for this chapter.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/BV8L94b1Y3s?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Managing Dirty Data Screencast.
</figcaption>
</figure>
<p>
The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Additional Resources
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
Other Chapters
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p><a href="https://lucidmanager.org/data-science/sharing-the-results-of-data-analysis/">Previous Chapter</a>: <em>Sharing Results of Data Analysis</em></p>
<p>
<a href="https://lucidmanager.org/data-science/analysing-the-customer-experience/">Next Chapter</a>: <em>Analysing the Customer Experience</em>.</p>
<p>
Feel free to <a href="https://lucidmanager.org/contact/">contact me</a> if you have any comments, suggestions or questions about this book.</p>
</div>
</div>
</div>
</div>

      