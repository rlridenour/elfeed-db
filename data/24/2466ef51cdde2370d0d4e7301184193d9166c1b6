<p>I want to create a context menu item in <strong>Finder.app</strong> to open selected items with Emacs. So why not document it for others to see. Might be instructive for some as well.</p>
<ul>
<li>Open the <code>Automator.app</code>.</li>
<li>Create a new document of the type <strong>Quick Action</strong>.</li>
</ul>
<figure><img src="https://macowners.club/images/context-menu-automator-1.png" width="800px">
</figure>

<ul>
<li>On the right side of the window select <code>files or folders</code> and <code>Finder.app</code>.</li>
<li>On the left side select <code>Run Shell Script</code> action and drag it onto the canvas to build the workflow.</li>
</ul>
<figure><img src="https://macowners.club/images/context-menu-automator-2.png" width="800px">
</figure>

<ul>
<li>In the <code>Run Shell Script</code> step change the <code>Pass input</code> to <code>as arguments</code>.</li>
<li>With the following script one can select either one or more files/directories.</li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="k">for</span> f in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    open -a Emacs <span class="s2">&#34;</span><span class="nv">$f</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exit</span> <span class="m">0</span>
</span></span></code></pre></div><figure><img src="https://macowners.club/images/context-menu-automator-3.png" width="800px">
</figure>

<ul>
<li>Go to <strong>File -&gt; Save</strong> in the menu to save the workflow. Choose a name which will appear in the context menu.</li>
</ul>
<figure><img src="https://macowners.club/images/context-menu-automator-4.png" width="800px">
</figure>

<ul>
<li><strong>That is it.</strong> You will now find your new item in the context menu.</li>
</ul>
<figure><img src="https://macowners.club/images/context-menu-automator-5.png" width="400px">
</figure>

