<p>I wrote ILsee, an Interlisp source file viewer. It is the first of the <a href="https://codeberg.org/amoroso/iltools">ILtools</a> collection of tools for viewing and accessing Interlisp data.</p>

<p>I developed ILsee in Common Lisp on Linux with SBCL and the <a href="https://mcclim.common-lisp.dev">McCLIM</a> implementation of the <a href="http://bauhh.dyndns.org:8000/clim-spec/index.html">CLIM</a> GUI toolkit. SLY for Emacs completed my Lisp tooling and, as for infrastructure, ILtools is the first new project I host at Codeberg.</p>

<p>This is ILsee showing the code of an Interlisp file:</p>

<p><a href="https://i.snap.as/z8bW47zv.jpg"><img alt="Screenshot of the ILsee GUI program displaying the code of an Interlisp source file." src="https://i.snap.as/z8bW47zv.jpg" /></a></p>

<h2 id="motivation">Motivation</h2>

<p>The concepts and features of CLIM, such as stream-oriented I/O and presentation types, blend well with Lisp and feel natural to me. McCLIM has come a long way since I last used it a couple of decades ago and I have been meaning to play with it again for some time.</p>

<p>I wanted to do a McCLIM project related to <a href="https://interlisp.org">Medley Interlisp</a>, as well as try out SLY and Codeberg. A suite of tools for visualising and processing Interlisp data seemed the perfect fit.</p>

<p>The Interlisp file viewer ILsee is the first such tool.</p>

<h2 id="interlisp-source-files">Interlisp source files</h2>

<p>Why an Interlisp file viewer instead of <code>less</code> or an editor?</p>

<p>In the managed residential environment of Medley Interlisp you don't edit text files of Lisp code. You edit the code in the running image and the system keeps track of and saves the code to "symbolic files", i.e. databases that contain code and metadata.</p>

<p>Medley maintains symbolic files automatically and you aren't supposed to edit them. These databases have a textual format with control codes that change the text style.</p>

<p>When displaying the code of a symbolic file with, say, the <a href="https://journal.paoloamoroso.com/medley-interlisp-structure-editing-first-impressions">SEdit structure editor</a>, Medley interprets the control codes to perform syntax highlighting of the Lisp code. For example, the names of functions in definitions are in large bold text, some function names and symbols are in bold, and the system also performs a few character substitutions like rendering the underscore <code>_</code> as the left arrow <code>&#8592;</code> and the caret <code>^</code> as the up arrow <code>&#8593;</code>.</p>

<p>This is what the same Interlisp code of the above screenshot looks like in the TEdit WYSIWYG editor on Medley:</p>

<p><a href="https://i.snap.as/kmYjD7ln.png"><img alt="Screenshot of the code of an Interlisp source file displayed by the TEdit editor on Medley Interlisp." src="https://i.snap.as/kmYjD7ln.png" /></a></p>

<p>Medley comes with the shell script <a href="https://github.com/Interlisp/medley/blob/master/scripts/lsee"><code>lsee</code></a>, an Interlisp file viewer for Unix systems. The script interprets the control codes to appropriately render text styles as colors in a terminal. <code>lsee</code> shows the above code like this:</p>

<p><a href="https://i.snap.as/PFR6K0DA.jpg"><img alt="Screenshot of the lsee shell script displaying the code of an Interlisp source file in a Linux terminal." src="https://i.snap.as/PFR6K0DA.jpg" /></a></p>

<h2 id="the-file-viewer">The file viewer</h2>

<p>ILsee is like <code>lsee</code> but displays files in a GUI instead of a terminal.</p>

<p>The GUI comprises a main pane that displays the current Interlisp file, a label with the file name, a command line processor that executes commands (also available as items of the menu bar), and the standard CLIM pointer documentation pane.</p>

<p>There are two commands, <code>See File</code> to display an Interlisp file and <code>Quit</code> to terminate the program.</p>

<p>Since ILsee is a CLIM application it supports the usual facilities of the toolkit such as input completion and presentation types. This means that, in the command processor pane, the presentations of commands and file names become mouse sensitive in input contexts in which a command can be executed or a file name is requested as an argument.</p>

<p>The <a href="https://codeberg.org/amoroso/iltools">ILtools repository</a> provides basic instructions for installing and using the application.</p>

<h2 id="application-design-and-gui">Application design and GUI</h2>

<p>I initially used McCLIM a couple of decades ago but mostly left it after that and, when I picked it back up for ILtools, I was a bit rusty.</p>

<p>The McCLIM documentation, the CLIM specification, and the research literature are more than enough to get started and put together simple applications. The code of the many example programs of McCLIM help me fill in the details and understand features I'm not familiar with. Still, I would have appreciated the CLIM specification to provide more examples, the near lack of which makes the many concepts and features harder to grasp.</p>

<p>The design of ILsee mirrors the typical structure of CLIM programs such as the definitions of application frames and commands. The slots of the application frame hold application specific data: the name of the currently displayed file and a list of text lines read from the file.</p>

<p>The function <code>display-file</code> does most of the work and displays the code of a file in the application pane.</p>

<p>It processes the text lines one by one character by character, dispatching on the control codes to activate the relevant text attributes or perform character substitution. <code>display-file</code> does incremental redisplay to reduce flicker when repainting the pane, for example after it is scrolled or obscured.</p>

<p>The code has some minor and easy to isolate SBCL dependencies.</p>

<h2 id="next-steps">Next steps</h2>

<p>I'm pleased at how ILsee turned out. The program serves as a useful tool and writing it was a good learning experience. I'm also pleased at CLIM and its nearly complete implementation McCLIM. It takes little CLIM code to provide a lot of advanced functionality.</p>

<p>But I have some more work to do and ideas for ILsee and ILtools. Aside from small fixes, a few additional features can make the program more practical and flexible.</p>

<p>The pane layout may need tweaking to better adapt to different window sizes and shapes. Typing file names becomes tedious quickly, so I may add a simple browser pane with a list of clickable files and directories to display the code or navigate the file system.</p>

<p>And, of course, I will write more tools for the ILtools collection.</p>

<p><a class="hashtag" href="https://journal.paoloamoroso.com/tag:ILtools"><span>#</span><span class="p-category">ILtools</span></a> <a class="hashtag" href="https://journal.paoloamoroso.com/tag:CommonLisp"><span>#</span><span class="p-category">CommonLisp</span></a> <a class="hashtag" href="https://journal.paoloamoroso.com/tag:Interlisp"><span>#</span><span class="p-category">Interlisp</span></a> <a class="hashtag" href="https://journal.paoloamoroso.com/tag:Lisp"><span>#</span><span class="p-category">Lisp</span></a></p>

<p><a href="https://remark.as/p/journal.paoloamoroso.com/an-interlisp-file-viewer-in-common-lisp">Discuss...</a>
<a href="mailto:info@paoloamoroso.com?subject=Reply%20to%20Paolo%20Amoroso%27s%20Journal">Email</a> | Reply <a class="u-url mention" href="https://journal.paoloamoroso.com/@/amoroso@oldbytes.space">@<span>amoroso@oldbytes.space</span></a></p>