<p>[Equations in this post may not look right (or appear at all) in your RSS reader. Go to <a href="https://leancrew.com/all-this/2025/05/monte-carlo-integration-on-a-sphere/">the original article</a> to see them rendered properly.]</p>
  <hr />
  <p>I meant to embed a Mathematica notebook into <a href="https://leancrew.com/all-this/2025/05/random-points-without-rejection/">last week’s post</a> about generating random points on the surface of a sphere, but I was having trouble with the Wolfram Cloud. Those problems have been fixed, so here’s a Mathematica notebook that does the various calculations necessary to generate the points and to produce some of the images included in that post:</p>
<iframe height="600" src="https://www.wolframcloud.com/obj/mark80/Published/sphere%20without%20animation.nb?_embed=iframe" width="100%"></iframe>
<p>If you scroll down to the end of the notebook, you’ll notice that in addition to plotting the random points to see if they look like they’re distributed uniformly over the surface, I also use the points to estimate the <a href="https://en.wikipedia.org/wiki/Moment_of_inertia">moments of inertia</a> of the sphere about each of the three axes and compare those estimates with the analytical solution. The estimate is done through a technique called <a href="https://en.wikipedia.org/wiki/Monte_Carlo_integration">Monte Carlo integration</a>.</p>
<p>The moment of inertia of a thin shell about the <em>x</em>-axis is</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>=</mo><msub><mo>∫</mo><mi>A</mi></msub><mi>ρ</mi><mspace width="0.167em"></mspace><mo form="prefix" stretchy="false">(</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup><mo form="postfix" stretchy="false">)</mo><mspace width="0.278em"></mspace><mi>d</mi><mi>A</mi></math>
<p>where <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math> is the surface of the sphere and <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math> is the areal density (mass per unit area) of the shell material. We’ll use a unit density, so</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>=</mo><msub><mo>∫</mo><mi>A</mi></msub><mo form="prefix" stretchy="false">(</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup><mo form="postfix" stretchy="false">)</mo><mspace width="0.278em"></mspace><mi>d</mi><mi>A</mi></math>
<p>There are similar equations for the moments of inertia about the other axes, <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub></math>.</p>
<p>The idea behind Monte Carlo integration is to generate a set of random points over the integration domain and add up the weighted sum of the <a href="https://mathworld.wolfram.com/Integrand.html">integrand</a> at all those points. The weights are the proportion of the domain represented by each point. In our case, the domain of integration is the surface of the sphere, we are generating <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math> points on that surface, and each point represents one <math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>n</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></math> of the total surface area. So</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mn>4</mn><mi>π</mi><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup></mrow><mi>n</mi></mfrac><mspace width="0.167em"></mspace><mo form="prefix" stretchy="false">(</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo form="postfix" stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>4</mn><mi>π</mi><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup></mrow><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo form="prefix" stretchy="false">(</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo form="postfix" stretchy="false">)</mo></math>
<p>Similarly,</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>≈</mo><mfrac><mrow><mn>4</mn><mi>π</mi><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup></mrow><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo form="prefix" stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>i</mi><mn>2</mn></msubsup><mo form="postfix" stretchy="false">)</mo></math>
<p>and</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub><mo>≈</mo><mfrac><mrow><mn>4</mn><mi>π</mi><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup></mrow><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo form="prefix" stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo form="postfix" stretchy="false">)</mo></math>
<p>These are the equations you see in the notebook for <code>ixxEstimate</code>, <code>iyyEstimate</code>, and <code>izzEstimate</code>. The <a href="http://reference.wolfram.com/language/ref/Total.html"><code>Total</code> function</a> does the summation.</p>
<p>We get the exact moments of inertia by rewriting the equation in terms of <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>φ</mi></math>,</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><mrow><mi>−</mi><mi>π</mi><mi>/</mi><mn>2</mn></mrow><mrow><mi>π</mi><mi>/</mi><mn>2</mn></mrow></msubsup><mspace width="0.278em"></mspace><msubsup><mo>∫</mo><mrow><mi>−</mi><mi>π</mi></mrow><mi>π</mi></msubsup><mrow><mo form="prefix" stretchy="true">[</mo><mo form="prefix" stretchy="false">(</mo><mi>R</mi><mspace width="0.167em"></mspace><mi>cos</mi><mi>ϕ</mi><mspace width="0.167em"></mspace><mi>sin</mi><mi>θ</mi><msup><mo form="postfix" stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo form="prefix" stretchy="false">(</mo><mi>R</mi><mspace width="0.167em"></mspace><mi>sin</mi><mi>ϕ</mi><msup><mo form="postfix" stretchy="false">)</mo><mn>2</mn></msup><mo form="postfix" stretchy="true">]</mo></mrow><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>2</mn></msup><mspace width="0.167em"></mspace><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi><mspace width="0.278em"></mspace><mi>d</mi><mi>θ</mi><mspace width="0.167em"></mspace><mi>d</mi><mi>ϕ</mi></math>
<p>which leads to</p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>=</mo><mfrac><mn>8</mn><mn>3</mn></mfrac><mi>π</mi><mspace width="0.167em"></mspace><msup><mi>R</mi><mn>4</mn></msup></math>
<p>Because of the symmetry of the sphere, the moments of inertia about the other two axes, <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>y</mi></msub></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub></math>, have the same formula, which is called <code>iAnalytical</code> in the notebook.</p>
<p>The Monte Carlo estimates are all within one percent of the exact value, which is another indication that the points are indeed uniformly distributed over the surface. Each time the notebook is reevaluated, the estimates will change (because the random points will change), but the estimates will always be close to the exact value.</p>
<p>You might think these estimates are pretty poor, considering we used 5000 points to get them. And you’d be right. Monte Carlo integration tends to be much less efficient than other methods of numerical integration when the dimension of the problem is low. But the number of integrand evaluations needed by those other methods typically rises exponentially with the number of dimensions in the domain, something that doesn’t happen with Monte Carlo integration. So the Monte Carlo method is a good tool to have when you need to integrate over a high-dimensional domain. And it’s a decent way to check your work when efficiency isn’t a concern.</p>
  
