<p>I recently realized, after including code from interactive Python sessions in recent posts (<a href="https://leancrew.com/all-this/2025/06/nba-finals-and-pandas/">this one</a> and <a href="https://leancrew.com/all-this/2025/06/in-defense-of-floating-point/">this one</a>), that I have more to say about my use of <a href="https://github.com/jupyter/jupyter_console">the Jupyter console</a> than I covered in <a href="https://leancrew.com/all-this/2024/12/calculators-and-jupyter/">this post</a> back in December.</p>
<p>First, although the Jupyter console can run interactive sessions in <a href="https://julialang.org/">Julia</a> and <a href="https://www.r-project.org/">R</a>, I use it only for Python, which means I’m really working in <a href="https://ipython.readthedocs.io/en/stable/">IPython</a>, which is what the Jupyter console runs by default. Here’s the startup message that appears after I run <code>jupyter console</code> in the Terminal:<sup id="fnref:jc"><a href="#fn:jc" rel="footnote">1</a></sup></p>
<pre><code>Jupyter console 6.6.3

Python 3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]
Type 'copyright', 'credits' or 'license' for more information
IPython 9.3.0 -- An enhanced Interactive Python. Type '?' for help.
Tip: `?` alone on a line will brings up IPython's help
</code></pre>
<p>It displays the version numbers for Jupyter console, Python, and IPython. Everything after the Jupyter console version number is the IPython “banner.” The tip at the end varies from session to session.</p>
<p>So if all I’m really doing is running IPython, why not do so directly? It’s a good question, and one I don’t have an especially satisfactory answer to. I started using Jupyter with <a href="https://jupyter-notebook.readthedocs.io/en/latest/">notebooks</a>. When I decided I preferred working in a console session instead, I just stayed in the Jupyter environment out of habit. At the time, I probably thought it was different from IPython and possibly an improvement. Maybe confessing publicly to this lame reason will get me to shift to IPython directly. To start the ball rolling in that direction, I’ll just refer to IPython from now on.</p>
<p>If you look back at the startup message, you’ll see that I’m running Python 3.13. You may have heard that this version has <a href="https://docs.python.org/3/whatsnew/3.13.html#whatsnew313-better-interactive-interpreter">improvements to its standard interactive environment</a>. It does, but it still isn’t as nice as working in IPython, mainly because of the <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">magic commands</a>.</p>
<p>When I’m working on a Python script, I try to test all the code as I write it, Typically, this means writing the code in BBEdit, saving it to a file, and testing it in IPython. The magic commands <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-run"><code>%run</code></a> and <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-reset"><code>%reset</code></a> are the keys to this workflow. Typing</p>
<pre><code>%run script.py
</code></pre>
<p>in an IPython session runs all the code in the file and keeps the session active. I can then check on what’s been written so far: calling functions with a variety of inputs, inspecting the values of variables, making sure loops and conditionals work the way they’re supposed to.</p>
<p>After adding to or fixing the code, I return to the IPython session and type</p>
<pre><code>%reset -f
</code></pre>
<p>This clears out all the names defined earlier in the session so the next <code>%run</code> starts fresh.</p>
<p>Because IPython keeps a history, I seldom have to type out <code>%run script.py</code> or <code>%reset -f</code> in full. Typing ⌃R puts IPython in an interactive backward search mode. Typing <code>%ru</code> after that brings up the most recent <code>%run</code> command; typing <code>%re</code> brings up the most recent <code>%reset</code>.</p>
<p>Even better—and this is a Bash tip, not an IPython tip—because I have these commands in my <code>.bashrc</code> file,</p>
<pre><code>bind '"\e[A":history-search-backward'
bind '"\e[B":history-search-forward'
</code></pre>
<p>I can type <code>%ru</code> and then the ↑ to bring up the most recent <code>%run</code> command. Similarly with <code>%re</code> and ↑. I learned these bindings from <a href="https://furbo.org/2014/09/03/the-terminal/">a long-ago post</a> by Craig Hockenberry and they work in all Terminal sessions, not just IPython.</p>
<p>(Depending on how you have things configured, IPython may show you the most recent matching command as soon as you start typing. These are called <em>autosuggestions</em>. I find the feature very annoying and don’t use it.)</p>
<p>The <code>%rerun</code> command can be useful when you have a handful of commands that you want to run again in the same order. For example,</p>
<pre><code>%rerun -l 4
</code></pre>
<p>will rerun the last four commands. I confess I don’t use <code>%rerun</code> as much as I should. I tend to use ↑ to go back through the history again and again, only realizing after I’m done that I could’ve saved time using <code>%rerun</code>.</p>
<p>After <code>%run</code> and <code>%reset</code>, my most commonly used magic command is probably <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history"><code>%history</code></a>. Using it like this,</p>
<pre><code>%history -opf session.txt
</code></pre>
<p>creates a file with all the input and output of the current session. The <code>-o</code> option tells it to include the output; the <code>-p</code> option tells it to put <code>&gt;&gt;&gt;</code> in front of all the input lines, making it look like a regular Python interactive session (even though it wasn’t); and the <code>-f &lt;filename&gt;</code> option tells it where to save the output. You can also give it a range of session lines to print. This is what I did to create the interactive Python code I added to those recent posts.</p>
<p>Another <code>%history</code> option, helpful when you’re trying out code in an IPython session and finally hit upon what you want to add to your script, is <code>-t</code>. Using this without <code>-p</code> or <code>-o</code> will print out the session code in a format that can be pasted directly into your script.</p>
<p>Finally, IPython has several ways to incorporate previous output into a command. Suppose our session has gone like this:</p>
<pre><code>In [1]: a = 1; b = 2; c = 3

In [2]: b*c
Out[2]: 6

In [3]: a + b*c
Out[3]: 7

In [4]: a + c**2
Out[4]: 10
</code></pre>
<p>At this point, we can multiply the third <code>Out</code> by <code>c</code> like this:</p>
<pre><code>In [5]: Out[3]*c
Out[5]: 21
</code></pre>
<p><code>In</code> and <code>Out</code> are not just labels, they’re Python variables that are continually updated during the session, and you can refer to them at any time. If typing <code>Out</code> and brackets is too much work (it is for me), you can use an underscore and a number to refer to previous output, e.g.,</p>
<pre><code>In [6]: _4**c
Out[6]: 1000
</code></pre>
<p>This simplified way of referring to previous output is reminiscent of Python’s long tradition of using the underscore (all by itself) to refer to the most recent output in an interactive session. IPython follows that tradition and extends it: two underscores (<code>__</code>) refers to the second most recent output, and three underscores (<code>___</code>) refers to the third most recent output. But that’s where it stops—apparently the IPython developers consider four underscores beyond the pale.</p>
<p>I’m sure there are other things I do in interactive Python sessions, but these are the ones I use often enough to remember.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:jc">
<p>You may recall from the <a href="https://leancrew.com/all-this/2024/12/calculators-and-jupyter/">December post</a> that I have <code>jupyter console</code> aliased to <code>jc</code> in my <code>.bashrc</code> file, so I haven’t typed out <code>jupyter console</code> in full in several years. <a href="#fnref:jc" rev="footnote">↩</a></p>
</li>
</ol>
</div>
