<p>Like it or not, <a href="https://www.whatsapp.com/">WhatsApp</a> is a necessity for some of us. I wish it weren't the case, but here we are.</p>
<p>Given the circumstances, I wish I could use WhatsApp a little more on my terms. And by that, I mean from an Emacs client, of course. Surely I'm not the only one who feels this way, right? Right?! Fortunately, <a href="https://www.reddit.com/r/emacs/comments/1opy9mp/i_cant_do_without_whatsapp_for_complicated/">I'm not alone</a>.</p>
<p>With that in mind, I've been hard at work prototyping, exploring what's feasible. Spoiler alert: it's totally possible, though will require a fair bit of work.</p>
<p>Thankfully, two wonderful projects offer a huge leg up: <a href="https://github.com/asternic/wuzapi">wuzapi</a> and <a href="https://github.com/tulir/whatsmeow">whatsmeow</a>.</p>
<p><a href="https://github.com/asternic/wuzapi">wuzapi</a> offers a <a href="https://en.wikipedia.org/wiki/REST">REST</a> API on top of <a href="https://github.com/tulir/whatsmeow">whatsmeow</a>, a Go library leveraging WhatsApp's multi-device web API.</p>
<p>Last week, I prototyped sending a WhatsApp message using <code>wuzapi</code>'s <code>REST</code> API.</p>
<p><img src="https://xenodium.github.io/images/want-a-whatsapp-emacs-client/whatsapp-send.gif" alt=""></p>
<p>I got there fairly quickly by onboarding myself on to <code>wuzapi</code> using its web interface and wiring <a href="https://github.com/xenodium/shell-maker">shell-maker</a> to send an HTTP message request via <code>curl</code>. While these two were enough for a quick demo, they won't cut it for a polished Emacs experience.</p>
<p>While I can make REST work, I would like a simpler integration under the hood. REST is fine for outgoing messages, but then I need to integrate webhooks for incoming events. No biggie, can be done, but now I have to deal with two local services opening a couple of ports. Can we simplify a little? Yes we can.</p>
<p>You may have seen me talk about <a href="https://github.com/xenodium/agent-shell">agent-shell</a>, my Emacs package implementing <a href="https://agentclientprotocol.com">Agent Client Protocol (ACP)</a>… Why is this relevant, you may ask? Well, after building a native Emacs <code>ACP</code> implementation, I learned a bit about <a href="https://www.jsonrpc.org/specification">json-rpc</a> over standard I/O. The simplicity here is that we can bring bidirectional communication to an Emacs-owned process. No need for multiple channels handling incoming vs outgoing messages.</p>
<p>So where's this all going?</p>
<p>I've been prototyping some patches on top of <a href="https://github.com/asternic/wuzapi">wuzapi</a> to expose <code>json-rpc</code> over standard I/O (as an alternative to <code>REST</code>). This prototype goes far beyond my initial experiment with sending messages, and yet the Emacs integration is considerably simpler, not to mention looking very promising. Here's a demo showing incoming WhatsApp messages, received via <code>json-rpc</code>, all through a single Emacs-owned process. Look ma, no ports!</p>
<p><img src="https://xenodium.github.io/images/want-a-whatsapp-emacs-client/whatsapp-receive.gif" alt=""></p>
<h2>It's feasible (but still lots to do)</h2>
<p>These early prototypes are encouraging, but we've only scratched the surface. Before you can send and receive messages, you need to onboard users to the WhatsApp Emacs client. That is, you need to create a <code>wuzapi</code> user, manage/connect to a session, authorize via a QR code, and more. You'll want this flow to be realiable and that's just onboarding.</p>
<p>From there, you'll need to manage contacts, chats, multiple message types, incoming notifications… the list goes on. That's just the Emacs side. As mentioned, I've also been patching <code>wuzapi</code>. My plan is to <a href="https://github.com/asternic/wuzapi/issues/196">upstream these changes</a>, rather than maintaining a fork.</p>
<h2>Will you fund the work?</h2>
<p>I've prototyped quite a few things now, including the onboarding experience with QR code scanning. At this point, I feel fairly optimistic about feasibility, which is all pretty exciting! But there's a bunch of work needed. Since going full-time indie dev, I have the time available (for now), but it's hard to justify this effort without aiming for some level of sustainability.</p>
<p>If you're interested in making this a reality, <a href="https://github.com/sponsors/xenodium">please consider sponsoring the effort</a>, and please reach out to voice your interest (<a href="https://indieweb.social/@xenodium">Mastodon</a> / <a href="https://twitter.com/xenodium">Twitter</a> / <a href="https://www.reddit.com/user/xenodium">Reddit</a> / <a href="https://bsky.app/profile/xenodium.bsky.social">Bluesky</a>).</p>
<p>Reckon a WhatsApp Emacs client would help you stay focused at work (less time on your phone)? Ask your employer to <a href="https://github.com/sponsors/xenodium">sponsor it</a> too ;-)</p>
