<p>The preponderance of Markdown formatted text in both websites and apps is a blessing and a point of friction for Org users. The content is there, but if you’re an Org user, you really prefer the text to be formatted for Org. If you have <a href="https://pandoc.org/index.html">Pandoc</a> installed, converting from Markdown to Org is trivial but laborious as it involves making the right command invocation with temporary files.</p>
<p>Thankfully, Emacs can automate this conversion as described in the workflow below:</p>
<ul>
<li>From the source app or website, copy the Markdown into the system clipboard. This step pushes this text into the Emacs <code>kill-ring</code>.</li>
<li>In Emacs, invoke a command which converts the above Markdown text into Org, then pastes (yanks) converted text into a desired Org file.</li>
</ul>
<p>Note that this workflow presumes that the Emacs <code>kill-ring</code> is integrated with the system clipboard and that <code>pandoc</code> is installed.</p>
<p>The following Elisp command <code>cc/yank-markdown-as-org</code> implements the above workflow:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">cc/yank-markdown-as-org</span><span class="w"> </span><span class="p">()</span>
<span class="w">  </span><span class="s">&quot;Yank Markdown text as Org.</span>

<span class="s">This command will convert Markdown text in the top of the </span><span class="ss">`kill-ring&#39;</span>
<span class="s">and convert it to Org using the pandoc utility.&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="k">interactive</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">save-excursion</span>
<span class="w">    </span><span class="p">(</span><span class="nb">with-temp-buffer</span>
<span class="w">      </span><span class="p">(</span><span class="nv">yank</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">shell-command-on-region</span>
<span class="w">       </span><span class="p">(</span><span class="nf">point-min</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">point-max</span><span class="p">)</span>
<span class="w">       </span><span class="s">&quot;pandoc -f markdown -t org --wrap=preserve&quot;</span><span class="w"> </span><span class="no">t</span><span class="w"> </span><span class="no">t</span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="nv">kill-region</span><span class="w"> </span><span class="p">(</span><span class="nf">point-min</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">point-max</span><span class="p">)))</span>
<span class="w">    </span><span class="p">(</span><span class="nv">yank</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>

<p>This command can be invoked in numerous ways including by key binding, context menu, Transient menu, and directly via <code>M-x</code>. My preference is using the context menu as illustrated in the screenshot below to optimize for mouse copy/paste interactions between different apps.</p>
<p align='center'>
<img src='http://yummymelon.com/devnull/images/import-markdown-to-org/paste-markdown-as-org.png' alt='' />
</p>

<p>Users interested in seeing how I’ve configured my context menu can <a href="https://github.com/kickingvegas/cclisp/blob/98aad8329bc5788448fc9dde23b6e56bd4a3014c/cc-context-menu.el#L104">read the source here</a>. Users unfamiliar with Emacs context menus can learn more about it in my post <a href="http://yummymelon.com/devnull/customizing-the-emacs-context-menu.html">Customizing the Emacs Context Menu</a>.</p>
<h1>Closing Thoughts</h1>
<p>Implementing <code>cc/yank-markdown-as-org</code> turned out to be a lot more simpler than expected, as the command <code>shell-command-on-region</code> does the heavy lifting in abstracting away the <code>pandoc</code> command invocation and its handling of temporary files. This implementation can serve as a example for other conversions using the <code>kill-ring</code>.</p>
<p>A word of thanks to mekeor on IRC for reminding me that <code>(point-min)</code> and <code>(point-max)</code> exist.</p>