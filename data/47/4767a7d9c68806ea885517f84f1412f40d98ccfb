<p>On a recent mastodon <a href="https://twit.social/@chris_spackman/109531700714365786">post</a>, Chris Spackman mentioned he uses Emacs to save <a href="https://ffmpeg.org/">ffmpeg</a> commands he's figured out for later usage. Emacs is great for this kind of thing. I've tried different approaches over time and eventually landed on <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a>, a small package I wrote. Like Chris, I also wanted a way to invoke magical incantations of known shell commands without having to remember all the details.</p>
<p>Chris's post reminded me of a few use-cases I'd been meaning to add DWIM shell commands for.</p>
<h3>ffmpeg</h3>
<ol>
<li>Trimming seconds from videos
<ul>
<li>
<p><code>dwim-shell-commands-video-trim-beginning</code> using:</p>
<pre><code class="language-{.bash">ffmpeg -i '&lt;&lt;f&gt;&gt;' -y -ss &lt;&lt;Seconds:5&gt;&gt; -c:v copy -c:a copy '&lt;&lt;fne&gt;&gt;_trimmed.&lt;&lt;e&gt;&gt;'
</code></pre>
</li>
<li>
<p><code>dwim-shell-commands-video-trim-end</code> using:</p>
<pre><code class="language-{.bash">ffmpeg -sseof -&lt;&lt;Seconds:5&gt;&gt; -i '&lt;&lt;f&gt;&gt;' -y -c:v copy -c:a copy '&lt;&lt;fne&gt;&gt;_trimmed.&lt;&lt;e&gt;&gt;'
</code></pre>
<p>Side-node: The <code>&lt;&lt;Seconds:5&gt;&gt;</code> placeholder is recognized as a query, so Emacs will prompt you for a numeric value.</p>
</li>
</ul>
</li>
<li>Extracting audio from videos
<ul>
<li>
<p><code>dwim-shell-commands-video-to-mp3</code> using:</p>
<pre><code class="language-{.bash">ffmpeg -i '&lt;&lt;f&gt;&gt;' -vn -ab 128k -ar 44100 -y '&lt;&lt;fne&gt;&gt;.mp3'
</code></pre>
</li>
</ul>
</li>
</ol>
<p>With these new dwim shell commands added, I can easily apply them one after the other. No need to remember command details.</p>
<p><img src="https://xenodium.github.io/images/emacs-ffmpeg-and-macos-alias-commands/trim_convert_mp3_x1.4.webp" alt=""></p>
<h3>macOS aliases</h3>
<p>After rebuilding Emacs via the wonderful <a href="https://github.com/d12frosted/homebrew-emacs-plus">emacs-plus</a>, I recently broke my existing <code>/Applications/Emacs.app</code> alias. No biggie, one can easily add a <a href="https://support.apple.com/en-gb/guide/mac-help/mchlp1046/mac">new one alias from macOS Finder</a>, but I've been wanting to do it from Emacs. Turns out there's a bit of AppleScript we can turn into a more memorale command like <code>dwim-shell-commands-macos-make-finder-alias</code>:</p>
<pre><code class="language-{.bash">osascript -e 'tell application \&quot;Finder\&quot; to make alias file to POSIX file \&quot;&lt;&lt;f&gt;&gt;\&quot; at POSIX file \&quot;%s\&quot;'
</code></pre>
<p>It's highly unlikely I'll remember the AppleScript snippet (are there better ways?), but I'll easily find and invoke my new command with fuzzy searching:</p>
<p><img src="https://xenodium.github.io/images/emacs-ffmpeg-and-macos-alias-commands/make-emacs-alias_x1.4.webp" alt=""></p>
<h3>Included in dwim-shell-command</h3>
<p>All of these are now included in <a href="https://github.com/xenodium/dwim-shell-command/blob/main/dwim-shell-commands.el">dwim-shell-commands.el</a>, which you can optionally load after installing <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> from <a href="https://melpa.org/#/dwim-shell-command">MELPA</a>.</p>
