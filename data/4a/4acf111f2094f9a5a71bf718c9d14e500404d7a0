<p>Somewhat recently, I wanted to quickly create an empty/transparent png file. <a href="https://imagemagick.org/">ImageMagick</a>'s convert has you covered here. Say you want a transparent 200x400 image, you can get it with:</p>
<pre><code class="language-{.bash">convert -verbose -size 200x400 xc:none empty200x400.png
</code></pre>
<p>Great, I now know the one-liner for it. But because I'm in the mood of saving these as <a href="https://xenodium.com/seamless-command-line-utils/">seamless command-line utils</a>, I figured I should save the <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> equivalent.</p>
<p>I wanted configurable image dimensions, so I used <a href="https://www.gnu.org/software/emacs/manual/html_node/calc/Formatting-Lisp-Functions.html">read-number</a> together with <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Formatting-Strings.html">format</a> to create the templated command and fed it to <code>dwim-shell-command-on-marked-files</code>. Job done:</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-commands-make-transparent-png ()
  &quot;Create a transparent png.&quot;
  (interactive)
  (let ((width (read-number &quot;Width: &quot; 200))
        (height (read-number &quot;Height: &quot; 200)))
    (dwim-shell-command-on-marked-files
     &quot;Create transparent png&quot;
     (format &quot;convert -verbose -size %dx%d xc:none '&lt;&lt;empty%dx%d.png(u)&gt;&gt;'&quot;
             width height width height)
     :utils &quot;convert&quot;)))
</code></pre>
<p>The resulting <code>dwim-shell-commands-make-transparent-png</code> is fairly simple, but <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> aims to remove friction so you're more inclined to save reusable commands. In this case, we can shift querying and formatting into the template.</p>
<p><code>&lt;&lt;Width:200&gt;&gt;</code> can be interpreted as &quot;ask the user for a value using the suggested prompt and default value.&quot;</p>
<p><img src="https://xenodium.github.io/images/dwim-shell-command-with-template-prompts/query.png" alt=""></p>
<p>With template queries in mind, <code>dwim-shell-commands-make-transparent-png</code> can be further reduced to essentially the interactive command boilerplate and the template itself:</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-commands-make-transparent-png ()
  &quot;Create a transparent png.&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;Create transparent png&quot;
   &quot;convert -verbose -size &lt;&lt;Width:200&gt;&gt;x&lt;&lt;Height:200&gt;&gt; xc:none '&lt;&lt;empty&lt;&lt;Width:200&gt;&gt;x&lt;&lt;Height:200&gt;&gt;.png(u)&gt;&gt;'&quot;
   :utils &quot;convert&quot;))
</code></pre>
<p><img src="https://xenodium.github.io/images/dwim-shell-command-with-template-prompts/empty.webp" alt=""></p>
<p>Note: Any repeated queries (same prompt and default) are treated as equal. That is, ask the user once and replace everywhere. If you'd like to request separate values, change either prompt or the default value.</p>
