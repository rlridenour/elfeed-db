<center><a target="_blank" href="https://codelearn.me/assets/img/hermit2-into.png"><img alt="hermit logo" src="https://codelearn.me/assets/img/hermit2-into.png" width="400px"/></a></center>
<h2 id="solution">Solution</h2>
<p>The image above is what we see when visiting the challenge URL (<code>104.197.195.221:8087</code>)</p>
<p>That&rsquo;s strange. Initially I thought the site is down but it&rsquo;s fine.</p>
<p>Let&rsquo;s try to connect with NetCat and see what the server tell us and why browser can&rsquo;t display it.</p>
<p><code>nc -vvv 104.197.195.221 8087</code></p>
<p>and response we get back is:</p>
<pre tabindex="0"><code>221.195.197.104.bc.googleusercontent.com [104.197.195.221] 8087 (?) open
SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2
</code></pre><p>Doesn&rsquo;t look like valid HTTP resopnse lol. Ok now we know that SSH server is running on that port so let&rsquo;s try to connect.</p>
<p><code>ssh 104.197.195.221 -p 8087</code> - and we see the prompt to enter a password for myself (krydos). It isn&rsquo;t clear what user should I use.
And even if we know the user what is the password?</p>
<p>As a hint the challenge name is <code>hermit</code> so the user is probably has the same name but we still need to know password.</p>
<p>Poking around, trying different things I noticed that hermit 2 challenge is <strong>on the same IP address where hermit 1</strong> is.</p>
<p>That&rsquo;s actually great because we have shell access on the server from <a href="https://codelearn.me/2021/03/28/umassctf-hermit1-writeup.html">the previous challenge</a>.</p>
<p>So I went to <code>/home/hermit/.ssh</code> folder, copied user&rsquo;s private key and used it in my ssh command like this:</p>
<p><code>ssh -i /tmp/hermit.ssh.private.key hermit@104.197.195.221 -p 8087</code></p>
<p>We&rsquo;re in. Now&hellip; <strong>where is the flag?</strong>
We know one flag from the previous challenge but I wasn&rsquo;t able to find another one.</p>
<p>Grep&rsquo;ing everything didn&rsquo;t help.
My assumption was that the flag is somewhere in <code>/root</code> folder or somewhere else where hermit user doesn&rsquo;t have access to.</p>
<p>Now&hellip; <strong>how can I become a root</strong>? Tried some stuff but didn&rsquo;t find anything useful.</p>
<p>Then I grepped for <code>flag</code> in <code>/etc</code> folder and I found</p>
<p><code>hermit ALL = (root) NOPASSWD: /bin/gzip -f /root/rootflag.txt -t</code> in <code>/etc/sudoers</code> file.</p>
<p>This record means that we can execute that command without asking for password.</p>
<p>Let&rsquo;s do it:</p>
<p><code>sudo /bin/gzip -f /root/rootflag.txt -t</code> and we see the flag - <code>UMASS{a_test_of_integrity}</code></p>
<p>Hooray</p>