<p>In the <a href="https://christiantietze.de/posts/2022/12/manage-org-agenda-related-buffers-via-display-buffer-alist/">previous post</a> I showed some settings to manage a tab dedicated to Org Agenda and its related org files.</p>

<p>I also mentioned that I didn’t like how that tab was actually handled, e.g. when I wanted to break out into other tabs.</p>

<p>The following settings work much better for me, 99% thanks to <a href="https://christiantietze.de/posts/2022/12/manage-org-agenda-related-buffers-via-display-buffer-alist/#fast-comments-jt=jWeNCNtB9jUP">a comment by @dme</a>.</p>

<figure><a href="https://christiantietze.de/posts/2022/12/updated-org-mode-agenda-display-buffer-alist/2022-12-27_org-agenda.png"><img alt="" src="https://christiantietze.de/posts/2022/12/updated-org-mode-agenda-display-buffer-alist/2022-12-27_org-agenda.png" /></a><figcaption>Org Agenda with a split at default widths.</figcaption></figure>

<p>The behavior now is this:</p>

<ul>
  <li>Org Agenda shows in the “Org Files” tab exclusively. It’s a dedicated window so that it stays open when I interact with the agends: selecting items on the agenda will force a split window.</li>
  <li>Org Agenda-related <code>.org</code> files, i.e. the details that will show when I select something from the agenda, will prefer to <em>share the same split</em> instead of making a new split every time.</li>
  <li>If I’m alreayd in another tab, i.e. not the “Org Files” tab, visiting an <code>.org</code> file, then switching buffers to another org buffer will show the buffer in the current window. (Previously, it would take me to the “Org Files” tab and add a new split there, which was quite jarring.)</li>
</ul>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">ct/display-buffer-org-agenda-managed-p</span> <span class="p">(</span><span class="nv">buffer-name</span> <span class="nv">action</span><span class="p">)</span>
  <span class="s">"Determine whether BUFFER-NAME is an org-agenda managed buffer."</span>
  <span class="p">(</span><span class="nv">with-current-buffer</span> <span class="nv">buffer-name</span>
    <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">derived-mode-p</span> <span class="ss">'org-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="nb">member</span> <span class="p">(</span><span class="nv">buffer-file-name</span><span class="p">)</span> <span class="p">(</span><span class="nv">org-agenda-files</span><span class="p">)))))</span>

<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'display-buffer-alist</span>
             <span class="o">`</span><span class="p">(</span><span class="s">"\\*Org Agenda\\*"</span>
               <span class="p">(</span><span class="nv">display-buffer-in-tab</span>  <span class="c1">;; Make sure to use the "Org Files" tab</span>
                <span class="nv">display-buffer-reuse-mode-window</span><span class="p">)</span>
               <span class="p">(</span><span class="nv">ignore-current-tab</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
               <span class="p">(</span><span class="nv">tab-name</span> <span class="o">.</span> <span class="s">"Org Files"</span><span class="p">)</span>
               <span class="p">(</span><span class="nv">window-width</span> <span class="o">.</span> <span class="o">,</span><span class="nv">ct/org-agenda-width</span><span class="p">)</span>
               <span class="p">(</span><span class="nv">dedicated</span> <span class="o">.</span> <span class="nv">side</span><span class="p">)</span>  <span class="c1">;; Make the Agenda a dedicated side-window</span>
               <span class="p">(</span><span class="nv">side</span> <span class="o">.</span> <span class="nv">left</span><span class="p">)</span>       <span class="c1">;; to the left so it always stays open.</span>
               <span class="p">(</span><span class="nv">inhibit-same-window</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'display-buffer-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="nv">ct/display-buffer-org-agenda-managed-p</span>
               <span class="p">(</span><span class="nv">display-buffer-reuse-mode-window</span>  <span class="c1">;; Prioritize reuse of current window</span>
                <span class="nv">display-buffer-in-tab</span><span class="p">)</span>            <span class="c1">;; over switching to the Org tab.</span>
               <span class="p">(</span><span class="nv">tab-name</span> <span class="o">.</span> <span class="s">"Org Files"</span><span class="p">)))</span>
</code></pre></div></div>

<p>I’m pretty happy with thse settings since the original post 3 weeks ago!</p>
<hr><p><small><a href="https://christiantietze.de/hire-me/">Hire me</a> for freelance macOS/iOS work and consulting.</small></p><p><small><a href="https://christiantietze.de/apps/">Buy</a> my apps.</small></p><p><small><a href="https://christiantietze.de/newsletter/">Receive</a> new posts via email.</small></p>