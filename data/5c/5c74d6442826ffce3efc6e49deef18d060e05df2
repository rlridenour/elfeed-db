

<p><a href="https://brettterpstra.com//projects/na">NA</a> has always had its own search syntax for navigating TaskPaper files, but it didn&rsquo;t understand TaskPaper&rsquo;s actual search syntax. I thought it might be time to change that.</p>

<p>For years, <code class="language-plaintext highlighter-rouge">na</code> has focused on a simple idea: when you sit down to work, you should be able to see your next actions for a project with a single, fast command (or even a prompt hook when you cd into a folder). It started as a thin wrapper around TaskPaper-style todo files, but its own filtering language slowly grew more powerful and less obvious. Recently, I decided to turn that around and lean into something that already exists: TaskPaper&rsquo;s own search syntax.</p>

<p><a href="https://guide.taskpaper.com/reference/searches/">TaskPaper search</a> is surprisingly rich. You can filter by plain text on the action line, query tags and their values, and even combine multiple conditions with logical operators. Instead of reinventing all of that, <code class="language-plaintext highlighter-rouge">na</code> now understands most of the same syntax. You can drop a TaskPaper query like <code class="language-plaintext highlighter-rouge">@priority &lt;= 2 and not @done</code> straight into <code class="language-plaintext highlighter-rouge">na next "@search(@priority &lt;= 2 and not @done)"</code> and get exactly what you expect: high-priority, incomplete actions for the current project.</p>

<p>Under the hood, <code class="language-plaintext highlighter-rouge">na</code> maps TaskPaper-style predicates into its own query engine. Bare words become text searches on the action line. Tag predicates like <code class="language-plaintext highlighter-rouge">@tag</code>, <code class="language-plaintext highlighter-rouge">@tag = value</code>, or <code class="language-plaintext highlighter-rouge">@tag contains foo</code> are parsed into comparison operators that <code class="language-plaintext highlighter-rouge">na</code> already knew how to handle. Special handling for <code class="language-plaintext highlighter-rouge">@done</code> keeps the UX sane: <code class="language-plaintext highlighter-rouge">@done</code> alone means &ldquo;include completed tasks,&rdquo; while <code class="language-plaintext highlighter-rouge">not @done</code> or combinations with other predicates flip the filter to only show what is still active. It even understands nested comparisons and item path syntax like <code class="language-plaintext highlighter-rouge">//Bugs/* and not @done</code>.</p>

<p>The nicest part, in my own usage, is that TaskPaper queries are now first-class citizens in todo files themselves. If you drop a line like:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code>Today's focus @search(@na and @priority &lt;= 2 and not @done)</code></pre></div></div>

<p>into your TaskPaper document, <code class="language-plaintext highlighter-rouge">na</code> can treat that as a saved search. Running something like <code class="language-plaintext highlighter-rouge">na saved "Today's focus"</code> will execute the embedded <code class="language-plaintext highlighter-rouge">@search(...)</code> expression and show you only the actions that match. Your TaskPaper document becomes both a list of tasks and a library of reusable, named filters you can run from the command line.</p>

<p>TaskPaper queries are not limited to inline <code class="language-plaintext highlighter-rouge">@search(...)</code> lines in your TaskPaper files. <code class="language-plaintext highlighter-rouge">na</code> also recognizes <code class="language-plaintext highlighter-rouge">@search</code> syntax in <code class="language-plaintext highlighter-rouge">~/.local/share/na/saved_searches.yml</code>, so you can define named searches there using pure TaskPaper syntax and reuse them everywhere. That means the same query language works in your editor, inside your todo documents, and in your global saved searches, giving you one universal way to describe how you want your TaskPaper tasks filtered.</p>

<p>This change does not replace <code class="language-plaintext highlighter-rouge">na</code>&rsquo;s existing search language; it layers a familiar syntax on top of it. You can still use the more compact <code class="language-plaintext highlighter-rouge">na</code>-style filters when you want, but if you already live in TaskPaper, you do not have to context-switch. The same search expressions work in the editor and in the terminal, against the same files, using the same mental model.</p>

<p>If you&rsquo;ve been using <code class="language-plaintext highlighter-rouge">na</code> as a quick way to see <code class="language-plaintext highlighter-rouge">@na</code>-tagged items, TaskPaper search support might seem like a small detail. But it opens up a lot of expressive power without extra configuration: you can slice your todos by project, tags, dates, and priorities using a language that is already documented and battle-tested. And if you are just getting started, you can learn one syntax and use it everywhere.</p>

<p>See the <a href="https://brettterpstra.com//projects/na">na project page</a> for more details on the <a href="https://brettterpstra.com//projects/na#taskpaper-syntax">supported TaskPaper syntax</a>. And, as always, you can get the latest version with <code class="language-plaintext highlighter-rouge">gem install na</code>.</p>

<p>Like or share this post <a title="This post on Mastodon" target="_blank" href="https://hachyderm.io/users/ttscoff/statuses/115656498154250195">on Mastodon</a>, <a title="Share on Bluesky" target="_blank" href="https://bsky.app/intent/compose?text=TaskPaper+search+syntax+for+NA%0A%0Ahttps%3A%2F%2Fbrettterpstra.com%2F2025%2F12%2F03%2Ftaskpaper-search-syntax-for-na%2F">Bluesky</a>, or <a class="twitter" target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fbrettterpstra.com%2F2025%2F12%2F03%2Ftaskpaper-search-syntax-for-na%2F&text=TaskPaper+search+syntax+for+NA&url=https%3A%2F%2Fbrettterpstra.com%2F2025%2F12%2F03%2Ftaskpaper-search-syntax-for-na%2F&via=ttscoff" title="Tweet this post">Twitter</a>.</p>
<hr style="margin:40px 0">

<p>BrettTerpstra.com is supported by readers like you. <a href="https://brettterpstra.com/support/">Click here if you'd
        like to help out.</a></p>
<p>Find Brett on <a rel="me" href="https://hachyderm.io/@ttscoff">Mastodon</a>, <a
        href="https://bsky.app/profile/ttscoff.bsky.social">Bluesky</a>, <a
        href="https://github.com/ttscoff">GitHub</a>, and <a href="https://brettterpstra.com/elsewhere">everywhere
        else</a>.</p><img src="https://brett.trpstra.net/link/535/17221623.gif" height="1" width="1"/>