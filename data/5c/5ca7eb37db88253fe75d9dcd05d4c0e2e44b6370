
	
<p>
Reporting all available data has little value because it overwhelms the organisation with information that is not actionable. A more productive approach to processing the data deluge is to show those processes where something interesting has occurred. A range of techniques is available to detect anomalies in the data. Reporting outliers and anomalies focuses the organisation&#39;s attention by raising questions and motivating action. <a href="https://dx.doi.org/10.1201/9781003326977-12">This chapter</a> of <em>Data Science for Water Utilities</em> discusses finding the most exciting points in your data to create actionable reports. This chapter also shows how to streamline code with functions and develop a leak detection tool to use with digital metering data. The learning objectives for this session are:</p>
<ul>
<li>Apply statistical methods to detect outliers</li>
<li>Find anomalies in a time series</li>
<li>Develop R functions to streamline your code</li>
<li>Write a function to detect leaks from digital metering data</li>
</ul>
<p>

  <div class="box">
    <div class="media">
      <figure class="media-left">
        <p class="image is-128x128">
          <img src="https://lucidmanager.org/images/books/2023_ds4wu.jpg" alt = "Data Science for Water Utilities" title = "Data Science for Water Utilities">
        </p>
      </figure>
      <div class="media-content">
        <div class="content">
          <p class="is-size-5 has-text-weight-bold">Data Science for Water Utilities</p>
          <p class="mb-2">Data Science for Water Utilities published by CRC Press is an applied, practical guide that shows water professionals how to use data science to solve urban water management problems using the R language for statistical computing.</p>
          <div class="buttons">
            <a class="button is-info" href="https://routledge.com/9781032354545" target="_blank">
              <span class="icon">
                <i class="fas fa-shopping-cart"></i>
              </span>
              <span>Routledge</span>
            </a>
            <a class="button is-info" href="https://www.amazon.com/Data-Science-Water-Utilities-Chapman/dp/1032354550" target="_blank">
              <span class="icon">
                <i class="fas fa-shopping-cart"></i>
              </span>
              <span>Amazon</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</p>
<p>
The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Anomaly Detection Methods
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>Several methods are available to detect anomalies:</p>
<ul>
<li>Visual inspection of graphs (such as boxplots, see <a href="https://lucidmanager.org/data-science/visualising-data-with-ggplot2/">chapter 6</a>)</li>
<li>Static thresholds, such as physical constraints or a regulatory limit </li>
<li>Statistical criteria (such as <a href="https://en.wikipedia.org/wiki/Standard_score">Z-scores</a> and <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation">Median Absolute Deviation</a>)</li>
<li>Domain knowledge</li>
</ul>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/boxplot-with-outliers.png" alt="Visually detecting outliers with a boxplot of chlorine data" title="Visually detecting outliers with a boxplot of chlorine data" width="500"/>
<figcaption>
Visually detecting outliers with a boxplot of chlorine data.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Leak Detection
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>Domain knowledge also helps to detect anomalies. For example, reservoir levels cannot extend much above the Full Supply Level, and a pH probe cannot measure values of zero and so on. Domain knowledge helps to define typical situations.</p>
<p>
Detecting leaks downstream of a meter is easy when we can make some assumptions about the consumption pattern. For any residential connection, we can safely assume there is no flow for at least a few hours daily. This assumption can easily be transformed into code.</p>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/diurnal-curve.png" alt="Visually detecting outliers with a boxplot of chlorine data" title="Visually detecting outliers with a boxplot of chlorine data" width="500"/>
<figcaption>
Visually detecting outliers with a boxplot of chlorine data.
</figcaption>
</figure>
<p>
The data for this case study was <a href="https://lucidmanager.org/data-science/simulating-water-consumption/">simulated using R scripts</a>. A previous blog post about <a href="https://lucidmanager.org/data-science/analyse-digital-water-meter-data/">analysing digital meter data</a> contains more details.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Detecting Outliers and Anomalies Screencast
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>Chapter twelve of <em>Data Science for Water Utilities</em> explains the theory and application of anomaly detection in more detail. This screencast below reviews the code for this chapter.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/U4w9-OdYc3A?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Detecting Outliers and Anomalies Screencast.
</figcaption>
</figure>
<p>
The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Additional Resources
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>The video below provides an excellent introduction to the principles of anomaly detection.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/mhSFyXbCaPM?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Anomaly Detection 101.
</figcaption>
</figure>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
Other Chapters
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p><a href="https://lucidmanager.org/data-science/working-with-dates-and-times-in-r/">Previous Chapter</a>: <em>Working with Dates and Times</em></p>
<p>
<a href="https://lucidmanager.org/data-science/introduction-to-machine-learning/">Next Chapter</a>: <em>Introduction to Machine Learning</em></p>
<p>
Feel free to <a href="https://lucidmanager.org/contact/">contact me</a> if you have any comments, suggestions or questions about this book.</p>
</div>
</div>
</div>
</div>

      