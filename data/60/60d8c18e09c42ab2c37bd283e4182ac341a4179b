<p>
While adding <a href="https://github.com/scicloj/clay/pull/165">the live reload feature</a> to Clay, I encountered a problem
of applying anonymous functions to thread macros. For example, below
is a simple snippet trying to wrap the input directory as a vector
with the help of thread macro, but surprisingly, it errors out. After
some searching, I figured out that I need to put the anonymous
function into another pair of parentheses:</p>
<div class="src src-clojure">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-clojure" data-lang="clojure"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">-&gt; </span><span class="s">&#34;/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">#</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">vector? </span><span class="nv">%</span><span class="p">)</span> <span class="nv">%</span> <span class="p">[</span><span class="nv">%</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1">;; =&gt; Syntax error (ClassCastException) compiling fn* at (simple4all.clj:19:1).</span>
</span></span><span class="line"><span class="cl"><span class="c1">;;    class java.lang.String cannot be cast to class clojure.lang.ISeq (java.lang.String is in module java.base of loader &#39;bootstrap&#39;; clojure.lang.ISeq is in unnamed module of loader &#39;app&#39;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">-&gt; </span><span class="s">&#34;/tmp/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">#</span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">vector? </span><span class="nv">%</span><span class="p">)</span> <span class="nv">%</span> <span class="p">[</span><span class="nv">%</span><span class="p">])))</span>
</span></span><span class="line"><span class="cl"><span class="c1">;; =&gt; [&#34;/tmp/&#34;]</span></span></span></code></pre></div>
</div>
<p>
Paul has a nice explanation on <a href="https://stackoverflow.com/a/7838577">Stack Overflow</a>, <a href="https://clojuredocs.org/clojure.core/-%3E">thread macros</a> need the function forms to be lists, but anonymous functions are already lists, so the first expression, <code class="verbatim">&#34;/tmp/&#34;</code> in this example, will just be inserted into that list, just as illustrated below:</p>