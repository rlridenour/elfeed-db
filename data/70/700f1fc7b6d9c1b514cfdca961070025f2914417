
	
<p>
Project Euler 28 takes us to the world of the Ulam Spiral. This is a spiral that contains sequential positive integers in a square spiral, marking the prime numbers. Stanislaw Ulam discovered that a lot of primes are located along the diagonals. These diagonals can be described as polynomials. The Ulam Spiral is thus a method to generate quadratic primes (<a href="https://lucidmanager.org/data-science/project-euler-27/">Euler Problem 27</a>).</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Ulam_spiral_howto_primes_only.svg/507px-Ulam_spiral_howto_primes_only.svg.png" alt="Ulam Spiral" title="Ulam Spiral" width="200"/>
<figcaption>
Ulam spiral (Wikimedia).
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 28 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>Starting with the number 1 and moving to the right in a clockwise direction, a 5 by 5 spiral is formed as follows:</p>
<div class="center-block" style="text-align: center; margin-left: auto; margin-right: auto;">
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>21  22  23  24  25
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>20   7   8   9  10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>19   6   1   2  11
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>18   5   4   3  12
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>17  16  15  14  13</span></span></code></pre></div>
</div>
</div>
<p>
It can be verified that the sum of the numbers on the diagonals is 101.</p>
<p>
What is the <a href="https://projecteuler.net/problem=28">sum of the numbers on the diagonals</a> in a 1001 by 1001 spiral formed in the same way?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>To solve this problem, we do not need to create a matrix. This code calculates the values of the corners of a matrix with size \(n\). The lowest number in the matrix with size \(n\) is \(n(n-3)+4\). The numbers increase by \(n-1\) . The code steps through all matrices from size 3 to 1001. The solution uses only the uneven sized matrices because these have a centre. The answer to the problem is the sum of all numbers.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 28: Number Spiral Diagonals</span>
</span></span><span style="display:flex;"><span>  size <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1001</span> <span style="color:#888"># Size of matrix</span>
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888"># Starting number</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Define corners of subsequent matrices</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (n <span style="color:#080;font-weight:bold">in</span> <span style="color:#06b;font-weight:bold">seq</span>(from <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">3</span>, to <span style="color:#333">=</span> size, by <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">2</span>)) {
</span></span><span style="display:flex;"><span>      corners <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">seq</span>(from <span style="color:#333">=</span> n <span style="color:#333">*</span> (n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">3</span>) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">3</span>, by <span style="color:#333">=</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>, length.out <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">4</span>)
</span></span><span style="display:flex;"><span>      answer <span style="color:#333">&lt;-</span> answer <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">sum</span>(corners)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Plotting the Ulam Spiral
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>We can go beyond Euler Problem 28 and play with the mathematics. This code snippet plots all the prime numbers in the Ulam Spiral. Watch the Numberphile video for an explanation of the patterns that appear along the diagonals.</p>
<p>
The code creates a matrix of the required size and fills it with the Ulam Spiral. The system then identifies all primes using the <code class="verbatim">is.prime()</code> function from <a href="https://lucidmanager.org/data-science/project-euler-7/">Euler Problem 7</a>, as visualised on the top of this article.</p>
<figure>
<img src="https://lucidmanager.org/images/project-euler/problem-028.png" alt="Ulam Spiral prime numbers." title="Ulam Spiral prime numbers."/>
<figcaption>
Ulam Spiral prime numbers.
</figcaption>
</figure>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/iFuR97YcSLM?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Prime Spirals - Numberphile.
</figcaption>
</figure>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Prime Spirals</span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">source</span>(<span style="background-color:#fff0f0">&#34;problem007.R&#34;</span>, verbose <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>  size <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">201</span> <span style="color:#888"># Size of matrix</span>
</span></span><span style="display:flex;"><span>  ulam <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">matrix</span>(ncol <span style="color:#333">=</span> size, nrow <span style="color:#333">=</span> size)
</span></span><span style="display:flex;"><span>  mid <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(size <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>  ulam[mid, mid] <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (n <span style="color:#080;font-weight:bold">in</span> <span style="color:#06b;font-weight:bold">seq</span>(from <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">3</span>, to <span style="color:#333">=</span> size, by <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">2</span>)) {
</span></span><span style="display:flex;"><span>      numbers <span style="color:#333">&lt;-</span> (n <span style="color:#333">*</span> (n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">4</span>) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">5</span>) <span style="color:#333">:</span> ((n <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#333">*</span> ((n <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">4</span>) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">4</span>)
</span></span><span style="display:flex;"><span>      d <span style="color:#333">&lt;-</span> mid <span style="color:#333">-</span> <span style="color:#06b;font-weight:bold">floor</span>(n <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>      l <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">length</span>(numbers)
</span></span><span style="display:flex;"><span>      ulam[d, d<span style="color:#333">:</span>(d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)] <span style="color:#333">&lt;-</span> numbers<span style="color:#06b;font-weight:bold">[</span>(l <span style="color:#333">-</span> n <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>)<span style="color:#333">:</span>l]
</span></span><span style="display:flex;"><span>      ulam[d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>, (d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)<span style="color:#333">:</span>d] <span style="color:#333">&lt;-</span> numbers<span style="color:#06b;font-weight:bold">[</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)<span style="color:#333">:</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">+</span> n)]
</span></span><span style="display:flex;"><span>      ulam<span style="color:#06b;font-weight:bold">[</span>(d <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>)<span style="color:#333">:</span>(d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span>), d] <span style="color:#333">&lt;-</span> numbers<span style="color:#06b;font-weight:bold">[</span>(l <span style="color:#333">-</span> n)<span style="color:#333">:</span>(l <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">*</span> n <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">3</span>)]
</span></span><span style="display:flex;"><span>      ulam<span style="color:#06b;font-weight:bold">[</span>(d <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>)<span style="color:#333">:</span>(d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span>), d <span style="color:#333">+</span> n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>] <span style="color:#333">&lt;-</span> numbers[1<span style="color:#333">:</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span>)]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  ulam.primes <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">apply</span>(ulam, <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">1</span>, <span style="color:#60e;font-weight:bold">2</span>), is.prime)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(reshape2)
</span></span><span style="display:flex;"><span>  ulam.primes <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">melt</span>(ulam.primes)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">ggplot</span>(ulam.primes, <span style="color:#06b;font-weight:bold">aes</span>(x <span style="color:#333">=</span> Var1, y <span style="color:#333">=</span> Var2, fill <span style="color:#333">=</span> value)) <span style="color:#333">+</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">geom_tile</span>() <span style="color:#333">+</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">scale_fill_manual</span>(values <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="background-color:#fff0f0">&#34;white&#34;</span>, <span style="background-color:#fff0f0">&#34;black&#34;</span>)) <span style="color:#333">+</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">guides</span>(fill <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">FALSE</span>) <span style="color:#333">+</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">theme_void</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">ggsave</span>(<span style="background-color:#fff0f0">&#34;images/problem-028.png&#34;</span>, widt <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">6</span>, height <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">4</span>)</span></span></code></pre></div>
</div>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>

</div>
</div>

      