<p>I get that maybe most people don‚Äôt get as excited about an update to Apple‚Äôs spreadsheets app, but I am, frankly, a Numbers enthusiast.<sup id="fnref-34513-excel"><a href="https://sixcolors.com#fn-34513-excel" class="jetpack-footnote" title="Read footnote.">1</a></sup></p>
<p>So when I saw that <a href="https://support.apple.com/guide/numbers/whats-new-tan700f60676/mac">this past week‚Äôs update to Numbers 14.4</a> added ‚Äúover 30 new functions‚Äù, I was intrigued to see what was available<sup id="fnref-34513-fulllist"><a href="https://sixcolors.com#fn-34513-fulllist" class="jetpack-footnote" title="Read footnote.">2</a></sup>‚Äîand, more to the point, if there was anything that could fill in some gaps in functionality.</p>
<p>The newer functions like SORT, FILTER, and LET certainly won‚Äôt blow away any Excel users, who have had those‚Äîand more‚Äîfor some time, but as a Numbers user, I‚Äôm just glad to see them join the party.</p>
<p>And, as it turns out, a couple of those <em>do</em> help me resolve some longstanding issues with one of my spreadsheets. Specifically, <a href="https://sixcolors.com/post/2015/07/template-for-numbers-freelance-accounting-sheet/">the freelance accounting sheet</a> that I‚Äôve been using for almost a decade.</p>
<h2>The median is the message</h2>
<p>One of the sheets in my Numbers file breaks down my income and expenses on a monthly basis, with some aggregate information like totals, minimums, maximums, averages, and medians. But because I create the table with the entire twelve months of the year, I have to make sure to discount some of the data or else it causes problems.</p>
<p>For example, telling me that my lowest monthly income in 2025 was the $0 I logged for October isn‚Äôt useful if it‚Äôs currently April. Likewise, having those zeroed out months can throw off the calculations for averages and medians.</p>
<p>Previously, for both the minimum and average I was able to use the MINIFS and AVERAGEIF functions respectively, keyed to a hidden field that said whether the month in question had passed or not.<sup id="fnref-34513-retroactive"><a href="https://sixcolors.com#fn-34513-retroactive" class="jetpack-footnote" title="Read footnote.">3</a></sup> The MEDIAN ended up being more complicated, though, since there is no corresponding MEDIANIF function. I ended up just manually adjusting the cells it was looking at every month or two when I checked these tables. But because I had it on three separate tables (gross income, expenses, and net income), that was a bit of a pain.</p>
<figure><img data-recalc-dims="1" decoding="async" src="https://i0.wp.com/sixcolors.com/wp-content/uploads/2025/04/numbers-medianfilter-formula-6c.png?ssl=1" alt="Using the new filter function to restrict MEDIAN values" data-image-w="" data-image-h="" class=" jetpack-broken-image"><figcaption>Just include the figure in the median calculation if the month has already happened (or is happening). It‚Äôs that easy!</figcaption></figure>
<p>Fortunately, the addition of the FILTER function solves this problem by letting me simply ignore months that haven‚Äôt happened yet, and instead just run my calculations on the subset of applicable values. I was not only able to create a median measurement I never have to update, but I could also remove that hidden month field and replace the AVERAGEIF function with a simpler filtered version too. All of that saves time and means less manual tweaking of the sheet.</p>
<h2>I got receipts</h2>
<p>Back when I <a href="https://sixcolors.com/post/2017/03/freelance-accouting-template-the-2017-edition/">updated my template in 2017 to add expense tracking</a>, I mentioned that there was one feature I wanted to add but wasn‚Äôt able to at the time:</p>
<blockquote><p>
  While Numbers still doesn‚Äôt have a way to link to a file, I set up an automatically-generated receipt ID, which I use as the file name for my receipts stored in Dropbox. (The ID is created when you check the related Receipt box.) It‚Äôs formatted as <code>Year-Month-Day-First Five Characters of Expense Name-Amount</code> in the hopes that I‚Äôll never spend the exact same amount at the exact same vendor on the same day
</p></blockquote>
<p>It‚Äôs true that Numbers still doesn‚Äôt let you include a link to a file, even though it has long had a HYPERLINK function that can make text into a clickable link. That, however, seems to primarily be aimed at including a web URL or a <code>mailto:</code> link and it doesn‚Äôt let you use a <code>file:///</code> URL.<sup id="fnref-34513-security"><a href="https://sixcolors.com#fn-34513-security" class="jetpack-footnote" title="Read footnote.">4</a></sup></p>
<p>However, it occurred to me that I <em>could</em> use a URL scheme to run a shortcut. And surely I could create a shortcut that could simply open a specific file?</p>
<figure><img data-recalc-dims="1" decoding="async" src="https://i0.wp.com/sixcolors.com/wp-content/uploads/2025/04/numbers-clickable-receipt-formula-6c.png?ssl=1" alt="A complicated Numbers formula" data-image-w="" data-image-h="" class=" jetpack-broken-image"><figcaption>They called me mad at the academy!</figcaption></figure>
<p>While I didn‚Äôt, strictly speaking, <em>need</em> any of Numbers‚Äôs new powers to do this, the LET function ended up being a timesaver, since it let me avoid having to do lengthy operations either in a separate, hidden field, or repeated within in a single cell.</p>
<figure class="pull-right"><img data-recalc-dims="1" decoding="async" src="https://i0.wp.com/sixcolors.com/wp-content/uploads/2025/04/numbers-sheet-shortcut-new-6c.png?ssl=1" alt="A shortcut to open the linked file" data-image-w="" data-image-h="" class=" jetpack-broken-image"><figcaption></figcaption></figure>
<p>I was thus able to drop my old naming formula into the new construction and use LET to define it as a variable called <code>receiptname.</code> Then I could not only display that value in the field itself, but also pass it to the shortcut I‚Äôd created, without having to write all those pesky functions a second time.</p>
<p>As for that shortcut, I actually made two versions: the first was a native one, but I discovered that every time I ran it for the first time on a specific file, it would pop up a privacy dialog box to approve the action. No thanks.</p>
<p>For my second crack at it, I switched to just using the Run Shell Script action to open the file via the command line, which bypasses the privacy dialog.<sup id="fnref-34513-shush"><a href="https://sixcolors.com#fn-34513-shush" class="jetpack-footnote" title="Read footnote.">5</a></sup></p>
<p>I subsequently combined those two versions of the shortcut into one that detects which platform you‚Äôre on, using the shell script action if you‚Äôre on macOS while otherwise relying on native controls. That way it does at least <em>work</em> on iOS, even if you still have to contend with privacy warnings.<sup id="fnref-34513-applescript"><a href="https://sixcolors.com#fn-34513-applescript" class="jetpack-footnote" title="Read footnote.">6</a></sup></p>
<p>Before I could declare victory, however, I discovered the need one final tweak: though the formula for my receipt file name already explicitly filters out spaces as well as the other characters caught by Numbers‚Äôs CLEAN function, I‚Äôve had to replace ampersands with their URL-encoded equivalents.<sup id="fnref-34513-att"><a href="https://sixcolors.com#fn-34513-att" class="jetpack-footnote" title="Read footnote.">7</a></sup> Since I‚Äôm using the URL scheme to pass the filename to Shortcuts, ampersands are a big no-no (they‚Äôre interpreted as part of the URL syntax) and I found that filenames that included them were routinely being truncated on their way into Shortcuts.</p>
<p>So, I‚Äôve now fixed all the major problems with my accounting spreadsheet which means surely fame and fortune awaits! Any day now.</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn-34513-excel">
My wife, meanwhile, is a die-hard Excel fan, but reconciling your differences is what marriage is all about.¬†<a href="https://sixcolors.com#fnref-34513-excel" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-fulllist">
Alas, I could not find a full list of exactly which functions are new. Apple lists <a href="https://support.apple.com/guide/functions/welcome/web">all the functions available in the app</a>, but only broken down by type, not by when they were added.¬†<a href="https://sixcolors.com#fnref-34513-fulllist" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-retroactive">
As I revisited these, I wondered why I‚Äôd needed that hidden field at all, since it was possible to do the month check in one, but hindsight, etc.¬†<a href="https://sixcolors.com#fnref-34513-retroactive" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-security">
Probably for well-founded security concerns, since that would in theory let you run an external app or program.¬†<a href="https://sixcolors.com#fnref-34513-security" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-shush">
Is this a security risk? Technically, yes, but since I‚Äôm the only one using it, I‚Äôm not too worried. ü§´¬†<a href="https://sixcolors.com#fnref-34513-shush" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-applescript">
I also had to add a simple Apple Script to tell the Shortcuts app to quit at the end of the Shortcut, because when you‚Äôre using the URL scheme, it apparently forces the app to launch. Fun times!¬†<a href="https://sixcolors.com#fnref-34513-applescript" title="Return to main content.">‚Ü©</a>
</li>
<li id="fn-34513-att">
Thanks, AT&amp;T.¬†<a href="https://sixcolors.com#fnref-34513-att" title="Return to main content.">‚Ü©</a>
</li>
</ol>
</div>
