
<p><strong>Symbol highlighting</strong> is a useful feature for quickly identifying occurrences of a symbol in a buffer. For example, when reading an algorithm with nested loops and multiple function calls, the distinct colors for each symbol, variable, or function make it easier to identify where each is used by simply scanning the highlighted symbols. This article presents a function that simplifies toggling the highlight for the symbol at point in Emacs using the <strong>built-in hi-lock package</strong>, which provides dynamic text highlighting.</p>



<p class="has-small-font-size"><em>(The function provided in this article can serve as a replacement for packages like symbol-overlay or highlight-symbol if your primary goal is simply highlighting symbols. However, if you require advanced features such as jumping between occurrences, I recommend using a more full-featured package.)</em></p>



<figure class="wp-block-image size-full"><img fetchpriority="high" decoding="async" width="791" height="389" src="https://www.jamescherti.com/wp-content/uploads/highlight-symbol-emacs.png" alt="" class="wp-image-4456" srcset="https://www.jamescherti.com/wp-content/uploads/highlight-symbol-emacs.png 791w, https://www.jamescherti.com/wp-content/uploads/highlight-symbol-emacs-300x148.png 300w, https://www.jamescherti.com/wp-content/uploads/highlight-symbol-emacs-768x378.png 768w, https://www.jamescherti.com/wp-content/uploads/highlight-symbol-emacs-500x246.png 500w" sizes="(max-width: 791px) 100vw, 791px" /></figure>



<h2 class="wp-block-heading">The function to toggle symbol highlighting</h2>



<h4 class="wp-block-heading">Here is the function that enables or disables highlighting for the symbol at point:</h4>


<pre class="wp-block-code"><span><code class="hljs language-lisp">(<span class="hljs-name">require</span> 'hi-lock)  <span class="hljs-comment">; Built-in Emacs package</span>

(<span class="hljs-name">defun</span> simple-toggle-highlight-symbol-at-point ()
  <span class="hljs-string">"Toggle highlighting for the symbol at point."</span>
  (<span class="hljs-name">interactive</span>)
  (<span class="hljs-name">when-let*</span> ((<span class="hljs-name">regexp</span> (<span class="hljs-name">find-tag-default-as-symbol-regexp</span>)))
    (<span class="hljs-name">if</span> (<span class="hljs-name">member</span> regexp (<span class="hljs-name">hi-lock--regexps-at-point</span>))
        <span class="hljs-comment">;; Unhighlight symbol at point</span>
        (<span class="hljs-name">hi-lock-unface-buffer</span> regexp)
      <span class="hljs-comment">;; Highlight symbol at point</span>
      (<span class="hljs-name">hi-lock-face-symbol-at-point</span>))))</code></span></pre>


<p>One advantage of the built-in hi-lock function is that it highlights each symbol with a unique color, making it easier to distinguish between different symbols.</p>



<p>Here is how it works:</p>



<ol class="wp-block-list">
<li><strong>Checking if the symbol is already highlighted</strong>: The function first retrieves a list of regular expressions corresponding to currently highlighted text in the buffer using <code>hi-lock--regexps-at-point</code>. It then checks whether the symbol at point is among the highlighted expressions using <code>member</code>.</li>



<li><strong>Unhighlighting the symbol</strong>: If the symbol is already highlighted, the function calls <code>hi-lock-unface-buffer</code> with the appropriate regular expression, removing the highlighting.</li>



<li><strong>Highlighting the symbol</strong>: If the symbol is not currently highlighted, the function invokes <code>hi-lock-face-symbol-at-point</code>, which applies highlighting to the symbol.</li>
</ol>



<h2 class="wp-block-heading">Usage</h2>



<p>You can configure a key binding, such as <code>C-c h</code>, with the following:</p>


<pre class="wp-block-code"><span><code class="hljs language-lisp">(<span class="hljs-name">global-set-key</span> (<span class="hljs-name">kbd</span> <span class="hljs-string">"C-c h"</span>) #'simple-toggle-highlight-symbol-at-point)</code></span></pre>


<p>Alternatively, you can use the function interactively by placing the cursor on a symbol and executing:</p>


<pre class="wp-block-code"><span><code class="hljs">M-x simple-toggle-highlight-symbol-at-point</code></span></pre>


<p><em>(If the symbol is not highlighted, it will be highlighted. If it is already highlighted, the function will remove the highlighting.)</em></p>



<p>You can also remove a symbol highlight from the entire buffer by selecting it from the list and removing it using:</p>


<pre class="wp-block-code"><span><code class="hljs">M-x hi-lock-unface-buffer</code></span></pre>


<h2 class="wp-block-heading">Conclusion</h2>



<p>The <code>simple-toggle-highlight-symbol-at-point</code> function provides an efficient way to toggle symbol highlighting in Emacs without relying on external packages. It offers a lightweight solution for users who primarily need highlighting functionality. While it does not include advanced navigation features found in third-party packages, it serves as a simple and effective alternative for quick visual identification of symbols in a buffer.</p>
