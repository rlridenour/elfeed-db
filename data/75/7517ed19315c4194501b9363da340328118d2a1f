<div class="outline-2">
<h2>TOC&#xa0;&#xa0;&#xa0;<span class="tag"></span></h2>
<div class="outline-text-2">
<ul class="org-ul">
<li><a href="#preamble">Preamble</a></li>
<li><a href="#high-dpi">High DPI</a>
<ul class="org-ul">
<li><a href="#org5bbdc01">Update 2026-01-22</a></li>
</ul></li>
<li><a href="#keyboard-configuration">Keyboard configuration</a>
<ul class="org-ul">
<li><a href="#keyboard-configuration-xorg-conf">Rewrite configuration for xorg.conf</a></li>
<li><a href="#keyboard-multimedia-keys">Multimedia keys</a></li>
</ul></li>
<li><a href="#x-pointing-devices">Pointing devices</a>
<ul class="org-ul">
<li><a href="#x-touchpad">Touchpad</a></li>
<li><a href="#x-trackpoint">Trackpoint</a></li>
<li><a href="#x-trackball">Trackball</a></li>
<li><a href="#x-mouse">Mouse</a></li>
<li><a href="#x-drawing-tablet">Drawing tablet</a></li>
</ul></li>
<li><a href="#screensaver">Screensaver</a>
<ul class="org-ul">
<li><a href="#disable-screensaver-4-videos">Disable screensaver for fullscreen videos</a></li>
<li><a href="#xlock">Update 2025-12-13 (xlock):</a></li>
</ul></li>
<li><a href="#picom">Compositor (no, not that thing from Wayland)</a>
<ul class="org-ul">
<li><a href="#picom-usual-windows">Changing size of usual windows</a></li>
<li><a href="#picom-splash-screen">Transparent splash screens</a></li>
<li><a href="#picom-dialog">Sliding dialog windows</a></li>
<li><a href="#picom-emacs-effects">Effects for Emacs</a></li>
<li><a href="#picom-librewolf-fix">Librewolf: menu fix</a></li>
<li><a href="#picom-stumpwm">Effects for StumpWM parts</a></li>
</ul></li>
<li><a href="#x-disable-outputs">Disabling unwanted outputs</a></li>
<li><a href="#x-randr">Juggling with displays</a></li>
<li><a href="#xterm">Terminal</a></li>
<li><a href="#xdm">Display manager (XDM)</a>
<ul class="org-ul">
<li><a href="#xdm-tumfatig">Update 2025-10-20:</a></li>
<li><a href="#xdm-startup">Update 2025-12-13 (xdm startup):</a></li>
</ul></li>
<li><a href="#xdg-utils">Xdg-utils</a>
<ul class="org-ul">
<li><a href="#xdg-utils-directory">Emacs Dired as a default file manager</a></li>
<li><a href="#xdg-utils-mail-agent">Emacs Compose as a default mail agent</a></li>
<li><a href="#xdg-utils-nsxiv">nSxiv as a default image viewer</a></li>
<li><a href="#xdg-utils-mpv">MPV as a default video/audio player</a></li>
<li><a href="#xdg-utils-editor">Emacs as a default editor for some files</a></li>
<li><a href="#xdg-utils-pdf">Emacs PDF-tools as a default PDF viewer</a></li>
</ul></li>
<li><a href="#beauty">Beauty</a>
<ul class="org-ul">
<li><a href="#change-cursor-theme">Changing the cursor theme</a></li>
<li><a href="#gtk2-theme">GTK2 theme</a>
<ul class="org-ul">
<li><a href="#gtk2-vermaden-update">Update 2025-12-13 (hints from vermaden):</a></li>
</ul></li>
<li><a href="#gtk3-theme">GTK3 theme</a>
<ul class="org-ul">
<li><a href="#gtk3-vermaden-update">Update 2025-12-13 (tweaks from vermaden blog):</a></li>
<li><a href="#fonts-size-tweak">Update 2026-01-08</a></li>
</ul></li>
<li><a href="#gtk4-is-shit">GTK4 theme</a></li>
<li><a href="#qt-theme">Qt 5 theme</a></li>
<li><a href="#qt6-theme">Qt 6 theme</a></li>
<li><a href="#librewolf-theme">Librewolf theme</a></li>
<li><a href="#fonts">Fonts</a>
<ul class="org-ul">
<li><a href="#fonts-vermaden">Update 2025-12-13 (fonts changed):</a></li>
</ul></li>
<li><a href="#icons">Icons</a></li>
</ul></li>
<li><a href="#notes">Notes</a></li>
</ul>
</div>
</div>
<div id="outline-container-preamble" class="outline-2">
<h2 id="preamble">Preamble</h2>
<div class="outline-text-2" id="text-preamble">
<p>
The modern common Linux and as a result also a UNIX desktop is <i>heavily
bloated</i>. Even if you install not a full-scale DE like Gnome, but a
small WM: i3wm, WindowMaker, XFCE, StumpWM, etc. These window managers
are small itself, but when user installs a necessary GUI programs —
then a lot of <i>bloat</i> will be installed too: gsettings-daemon, D-Bus
daemon, polkitd, console-kit-daemon, etc, etc…
</p>

<p>
What can I do with all these <i>bloatware</i>? There are two solutions:
</p>
<ol class="org-ol">
<li>Disable unwanted compile-time options and recompile necessary stuff
by itself. I already wrote something about this approach <a href="https://eugene-andrienko.com/en/it/2025/03/30/freebsd-pkgs-wout-unwanted-deps.html">here</a>.
There is one disadvantage — sometimes you need to edit the source
code or port-related files to get rid of strange things, like
Krita's Wayland dependency when I'm using it in the pure X11
environment and so on.</li>
<li>Use good, old and mature, well-tested by time programs and
solutions. You aren't obliged to install a lot of Gnome/KDE-related
libraries if you want a simple program with GUI to achieve a simple
task, like draw a login window and check user's credentials for the
single-user box.</li>
</ol>

<p>
In this post I'll write about the second approach — how to make nice
things with simple (for the "modern" world; of course some purist will
say that even <i>these</i> things are bloated too) good old programs and
ways.
</p>

<p>
All nice things from desktop environments, like nice effects, nice
themes, automatic execution of mail client after click on the proper
link, etc — don't need tons of frameworks and libraries from big
desktop environments. They are totally acessible with an elegant
utilities from a more civilized era.
</p>

<p>
Actions, described in this blogpost, were (obviously) performed in the
FreeBSD 14.3, not in Linux :-) and with X server, not Wayland :-).
</p>

<p>
<b>UPDATE:</b> Also, all recipes from this blogpost were tested in FreeBSD
15.0 with XLibre 1.25.1.
</p>

<p>
Covered topics:
</p>
<ul class="org-ul">
<li>How to setup X server to operate with HighDPI display?</li>
<li>How to setup keyboard only with a shell and text editor?</li>
<li>How to setup different pointing devices, including tricky setup of
trackball for left-handed user?</li>
<li>Good old XScreenSaver.</li>
<li>How to setup nice effects: transparency, shadows and animations —
for a small WM (e.g. StumpWM)?</li>
<li>How to switch multi-monitor configurations and perform tricky things
with <code>xrandr</code>?</li>
<li>How to use XDM as a display manager and login screen? It has a very
limited set of dependencies, lesser than a "lightweight" LightDM.</li>
<li>How to use xdg-utils to open Emacs Dired as a default filemanager,
Emacs ComposeMode as a default e-mail composer, etc?</li>
<li>How to setup some nice themes without GUI utilities — just by
editing text files with any text editor?</li>
</ul>
</div>
</div>
<div id="outline-container-high-dpi" class="outline-2">
<h2 id="high-dpi">High DPI</h2>
<div class="outline-text-2" id="text-high-dpi">
<p>
I have a small 13.3" display with a 2K resolution in my laptop. As a
result, by default I see all GUI element on my screen very small, so I
can't see them without unnecessary strain in my eyes (and not only I,
of course).
</p>

<p>
The usual approach to this problem — instruct GUI environment that
this screen with a big resolution doesn't have a big diagonal too.
</p>

<p>
So, I read these articles:
</p>
<ul class="org-ul">
<li><a href="https://wiki.archlinux.org/title/HiDPI">HiDPI</a> in the ArchWiki</li>
<li><a href="https://linuxreviews.org/HOWTO_set_DPI_in_Xorg">HOWTO set DPI in Xorg</a></li>
</ul>

<p>
And also a <a href="https://man.freebsd.org/cgi/man.cgi?query=xorg.conf&amp;apropos=0&amp;sektion=5&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">man 5 xorg.conf</a>. Suddenly I found that I don't need to play
with tricky environment variables to please every GUI toolkit. All
that I need to do — is to specify active area dimensions in
millimeters for my monitor in X11 configuration! The neat part — this
settings will be applied to the whole system (login window, any WM,
etc), not only for logged in user with necessary environment
variables.
</p>

<p>
I got the necessary dimensions in millimeters from a display module
datasheet:
</p>


<div class="figure">
<p><img src="/assets/static/sharp-display-specs.png" alt="Sharp LQ125T1JW02 physical specifications. Width and height of active area 276.48x155.52 mm" align="center" width="70%" />
</p>
<p class="fignum"><i>Active area dimensions (mm) from Sharp LQ125T1JW02 datasheet</i></p>
</div>

<p>
And specified these dimensions in the proper section (file
<code>/usr/local/etc/X11/xorg.conf.d/10-intel.conf</code>):
</p>

<pre class="example">
Section "Monitor"
    Identifier  "MainMonitor"
    Option      "Primary" "true"
    DisplaySize 276.48 155.52
EndSection
</pre>

<p>
The <code>MainMonitor</code> is specified in the <code>Device</code> section as monitor
connected to the DP-3 bus:
</p>

<pre class="example">
Section "Device"
    Identifier  "intel"
    ...
    Option      "Monitor-DP-3"   "MainMonitor"
    Option      "Monitor-LVDS-1" "PhantomMonitor"
EndSection
</pre>

<p>
And both sections are connected in the <code>Screen</code> section:
</p>

<pre class="example">
Section "Screen"
    Identifier "MainScreen"
    Device     "intel"
    Monitor    "MainMonitor"
EndSection
</pre>

<p>
Also, for applications which are using GTK3, I added this line to the
<code>~/.config/gtk-3.0/settings.ini</code>, because looks like it doesn't respect
the X server settings and draws all letters very small:
</p>

<pre class="example">
gtk-font-name=DejaVu Serif Book 16
</pre>

<p>
After X server restart I happily found that almost all GUI
applications are displaying correctly! The Emacs, Conky, GIMP, Krita,
etc… With one exception — the Librewolf (Firefox). <i>Suddenly</i> it doesn't
want to use X settings.
</p>

<p>
The solution for Librewolf here — the tricky option <code>ui.textScaleFactor</code>
in the <code>about:config</code> (the <a href="https://nosh0b10.m0xee.net/m0xEE">@m0xEE@nosh0b10.m0xee.net</a> <a href="https://nosh0b10.m0xee.net/m0xEE/p/1752501336.492728">helped me with
that</a>). I set it to <code>170</code> and Librewolf now scaled properly like any
other GUI program in the system.
</p>
</div>
<div class="outline-3">
<h3>Update 2026-01-22</h3>
<div class="outline-text-3">
<p>
Also, one more way to set the desired DPI — launch X-server with <code>-dpi
144</code> option, if your monitor has 144 DPI.
</p>
</div>
</div>
</div>
<div id="outline-container-keyboard-configuration" class="outline-2">
<h2 id="keyboard-configuration">Keyboard configuration</h2>
<div class="outline-text-2" id="text-keyboard-configuration">
<p>
Previously I used next two commands in my <code>~/.xinitrc</code> to properly
configure keyboard in X:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span class="linenr">1: </span>setxkbmap -model <span style="color: #009c8f;">"thinkpad"</span> <span style="color: #ad8900; font-weight: bold;">\</span>
<span id="coderef-setxkbmap-layout" class="coderef-off"><span class="linenr">2: </span>          -layout us,ru <span style="color: #ad8900; font-weight: bold;">\</span></span>
<span id="coderef-setxkbmap-grp" class="coderef-off"><span class="linenr">3: </span>          -option grp:menu_toggle -option grp_led:caps <span style="color: #ad8900; font-weight: bold;">\</span></span>
<span id="coderef-setxkbmap-compose" class="coderef-off"><span class="linenr">4: </span>          -option compose:ralt <span style="color: #ad8900; font-weight: bold;">\</span></span>
<span id="coderef-setxkbmap-shift-caps" class="coderef-off"><span class="linenr">5: </span>          -option shift:both_capslock_cancel <span style="color: #ad8900; font-weight: bold;">\</span></span>
<span id="coderef-setxkbmap-swap-caps-ctrl" class="coderef-off"><span class="linenr">6: </span>          -option caps:ctrl_modifier</span>
<span id="coderef-xmodmap-stumpwm-hack" class="coderef-off"><span class="linenr">7: </span>xmodmap -e <span style="color: #009c8f;">"keycode 147  = ISO_Next_Group Menu ISO_Next_Group Menu"</span></span>
</pre>
</div>

<p>
The <code>setxkbmap</code> is the main command which does the all necessary magic.
It uses the X keyboard extension<sup><a id="fnr.xkb" class="footref" href="#fn.xkb" role="doc-backlink">1</a></sup> to control the keyboard
configuration:
</p>
<ul class="org-ul">
<li>keyboard layout</li>
<li>indicators actions (NumLock, CapsLock and ScrollLock and also the bell)</li>
<li>keyboard parameters like repeat speed and delay</li>
<li>behaviour of keyboard modifiers (Ctrl, Alt and so on)</li>
<li>manipulation of mouse cursor with keyboard keys</li>
<li>etc.</li>
</ul>

<p>
In the code above, I setup the next things:
</p>

<ol class="org-ol">
<li><p>
The keyboard model in the first line. The keyboard model specifies
physical layout of keyboard and maps the physical key with the
keycode. For example, the <code>Menu</code> key for <code>thinkpad</code> layout is mapped
with <code>147</code> keycode.
</p>

<p>
Usually user uses only one keyboard at a time (if user is not an
octopus), so only one keyboard model could be specified with the
<code>setxkbmap</code> command. If there are mutliple keyboards, then the X
keyboard extension should be configured through the <code>xorg.conf</code>.
</p>

<p>
The X server should determine the keyboard type automatically so it
is not necessary to specify keyboard model — the server will
determine keyboard and process the special keys (like volume
control keys or multimedia controls) by itself. But I explicitly
specified keyboard model as <code>thinkpad</code> keyboard just for clarity.
</p></li>

<li><p>
The line <a href="#coderef-setxkbmap-layout" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-setxkbmap-layout');" onmouseout="CodeHighlightOff(this, 'coderef-setxkbmap-layout');">2</a> specifies the used keyboard layouts.
Each layout describes how the keycode maps with real symbol.
</p>

<p>
For example, on my keyboard (for Russian market) on the key right
of <code>Tab</code> key there are the next symbols engraved: <code>q</code> and <code>й</code>. So, to use
both sets of symbols — English and Cyrillic — I should use <code>us</code> and
<code>ru</code> layouts. Obviously, it is possible to specify more layouts if
necessary — just add them with comma as a separator.
</p>

<p>
When I press this key on my <code>thinkpad</code> keyboard the keycode <code>24</code> will
be generated. And for <code>us</code> layout this keycode will generate <code>q</code> letter
with <code>0x71</code> keysym:
</p>

<pre class="example">
KeyPress event, serial 36, synthetic NO, window 0x2200001,
 root 0x26a, subw 0x0, time 71799711, (1351,400), root:(1351,400),
 state 0x0, keycode 24 (keysym 0x71, q), same_screen YES,
 XLookupString gives 1 bytes: (71) "q"
 XmbLookupString gives 1 bytes: (71) "q"
 XFilterEvent returns: False
</pre>

<p>
And when I press this key with <code>ru</code> layout, then the same keycode
(<code>24</code>) will be generated and letter <code>й</code> will be issued (<code>0xd0 0xb9</code>
keysym):
</p>

<pre class="example">
KeyPress event, serial 36, synthetic NO, window 0x2200001,
 root 0x26a, subw 0x0, time 71809991, (1351,400), root:(1351,400),
 state 0x2000, keycode 24 (keysym 0x6ca, Cyrillic_shorti), same_screen YES,
 XLookupString gives 2 bytes: (d0 b9) "й"
 XmbLookupString gives 2 bytes: (d0 b9) "й"
 XFilterEvent returns: False
</pre></li>

<li><p>
On the line <a href="#coderef-setxkbmap-grp" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-setxkbmap-grp');" onmouseout="CodeHighlightOff(this, 'coderef-setxkbmap-grp');">3</a> I specify which key is used to switch
between layouts. I use <code>Menu</code> key for it. But there are a rich set of
different keychords to switch layouts: from common <code>Alt+Shift</code> or
<code>Ctrl+Shift</code> to exotic <code>Left Ctrl+Left Win</code>. The full list of possible
keychords can be viewed in the section <code>OPTIONS</code> subsection <code>Switching
   to another layout</code> from the <a href="https://man.freebsd.org/cgi/man.cgi?query=xkeyboard-config&amp;sektion=7&amp;format=html">man 7 xkeyboard-config</a>.
</p>

<p>
Also, on the same line, I use CapsLock LED as an indicator of
selected layout. It is turned off when I'm using the <code>us</code> layout and
turned on when I'm using the <code>ru</code> layout. List of options for
different keyboard LEDs written in the <code>Use keyboard LED to show
   alternative layout</code> subsection of the same section of manual.
</p></li>

<li><p>
On the line <a href="#coderef-setxkbmap-compose" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-setxkbmap-compose');" onmouseout="CodeHighlightOff(this, 'coderef-setxkbmap-compose');">4</a> I setup one cool feature of X — the
<code>Compose</code> key. I use <code>Right Alt</code> key as a <code>Compose</code> key.
</p>

<p>
It was a separate and very valuable key on the old keyboards but
since some physical keys were removed because of <del>enshittification</del>
<i>"simplification"</i> — it is disappeared. This process still doesn't
stopped — the <code>Copilot</code> key was added to nudge Windows users to use
integrated LLM, some keys were labelled by manufacturers as <i>"less
valuable"</i> and they can be pressed with <code>Fn</code> key (for example,
<code>F1</code>-<code>F12</code> keys on the some laptops) or even removed like <code>Scroll
   Lock</code> key (it is necessary to scroll lines on the text terminal).
</p>

<p>
The <code>Compose</code> key is necessary to type some obscure symbols, which
are not accessible the usual way, like the <code>—</code>, <code>°</code>, <code>⇒</code>, <code>₽</code> and other
symbols. To type, for example <code>—</code> symbol, I press and release the
<code>Compose</code> (aka <code>Right Alt</code>) key and then triple press the <code>-</code> key. Full
list of these cool keychords can be viewed in the
<code>/usr/local/lib/X11/locale/en_US.UTF-8/Compose</code> file for <code>en_US.UTF-8</code>
locale and in the <code>/usr/local/lib/X11/locale/ru_RU.UTF-8/Compose</code> for
<code>ru_RU.UTF-8</code> locale.
</p></li>

<li><p>
Option on the line <a href="#coderef-setxkbmap-shift-caps" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-setxkbmap-shift-caps');" onmouseout="CodeHighlightOff(this, 'coderef-setxkbmap-shift-caps');">5</a> allows to enable CapsLock
by simultaneous press to the <code>Left Shift</code> and <code>Right Shift</code> keys.
CapsLock mode will be disabled if one of the <code>Shift</code> keys will be
pressed.
</p>

<p>
This tricky configuration was added because on the line
<a href="#coderef-setxkbmap-swap-caps-ctrl" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-setxkbmap-swap-caps-ctrl');" onmouseout="CodeHighlightOff(this, 'coderef-setxkbmap-swap-caps-ctrl');">6</a> I remap <code>CapsLock</code> to the <code>Ctrl</code> key — to
avoid <a href="https://en.wikipedia.org/wiki/Repetitive_strain_injury">"pinky finger problem"</a> while I'm using Emacs. But I'm still
need the CapsLock mode, because it is heavily used in the blind
typing to enter abbreviations and so on.
</p></li>
</ol>

<p>
On the last line (<a href="#coderef-xmodmap-stumpwm-hack" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-xmodmap-stumpwm-hack');" onmouseout="CodeHighlightOff(this, 'coderef-xmodmap-stumpwm-hack');">7</a>) I use <code>xmodmap</code> utility to
remap the <code>Menu</code> keycode (147) to the <code>ISO_Next_Group</code> keysym (if no
modifiers are pressed). There is a hack necessary for StumpWM — by
default it treats the <code>Menu</code> key in the wrong way, so in the Emacs I
can't use it to switch between keyboard layouts.
</p>
</div>
<div id="outline-container-keyboard-configuration-xorg-conf" class="outline-3">
<h3 id="keyboard-configuration-xorg-conf">Rewrite configuration for xorg.conf</h3>
<div class="outline-text-3" id="text-keyboard-configuration-xorg-conf">
<p>
Keyboard configuration via <code>setxkbmap</code> is good but not good enough. This
configuration works only after user's <code>~/.xinitrc</code> (or <code>~/.xsession</code>) was
launched. While I'm logging in the system via the graphical display
manager, or logged as another user, then this configuration will not
be applied.
</p>

<p>
So, it is better to make this configuration system-wide by writing
almost the same directives in the <code>xorg.conf</code>. How to do it? This is
described in the <a href="https://man.freebsd.org/cgi/man.cgi?query=xorg.conf&amp;apropos=0&amp;sektion=5&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">man 5 xorg.conf</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=kbd&amp;apropos=0&amp;sektion=4&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">man 4 xkb</a>, also look to the <a href="https://man.freebsd.org/cgi/man.cgi?query=xkeyboard-config&amp;sektion=7&amp;apropos=0&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports">man 7
xkeyboard-config</a> for available options.
</p>

<p>
The <code>setxkbmap</code> options, listed above, can be rewritten for <code>xorg.conf</code> in
the next manner:
</p>

<div class="org-src-container">
<label class="org-src-name">/usr/local/etc/X11/xorg.conf.d/23-keyboard.conf</label><pre class="src src-nil">Section "InputClass"
    Identifier      "X220 Keyboard"
    MatchIsKeyboard "on"
    Driver          "evdev"
    Option          "XkbModel"   "thinkpad"
    Option          "XkbLayout"  "us,ru"
    Option          "XkbOptions" "grp:menu_toggle,grp_led:caps,compose:ralt,shift:both_capslock_cancel,caps:ctrl_modifier"
EndSection
</pre>
</div>

<p>
Because there is only one keyboard connected to the laptop all the
time, I use simple <code>MatchIsKeyboard "on"</code> to select the every (only one)
keyboard, found by X server.
</p>
</div>
</div>
<div id="outline-container-keyboard-multimedia-keys" class="outline-3">
<h3 id="keyboard-multimedia-keys">Multimedia keys</h3>
<div class="outline-text-3" id="text-keyboard-multimedia-keys">
<p>
This is the most simple part. If OS kernel has necessary module(s) —
for example <code>acpi_ibm</code> for Thinkpad X220 — then X server will receive
necessary keycodes from underlying parts of system and will propagate
then to WM/DE as commonly known keysyms: <code>XF86AudioMute</code>,
<code>XF86MonBrightnessUp</code> and so on. The utility <code>xev</code> can be used to check
are the pressed keys correctly recognized.
</p>

<p>
Then, if WM allows to add keybindings, the necessary lines should be
added to it's configuration file. For example, for StumpWM:
</p>
<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">define-key</span> *top-map* <span style="color: #ad8900;">(</span>kbd <span style="color: #009c8f;">"XF86AudioMute"</span><span style="color: #ad8900;">)</span> <span style="color: #009c8f;">"mute"</span><span style="color: #009c8f;">)</span>
<span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">define-key</span> *top-map* <span style="color: #ad8900;">(</span>kbd <span style="color: #009c8f;">"XF86AudioLowerVolume"</span><span style="color: #ad8900;">)</span> <span style="color: #009c8f;">"volume-control down"</span><span style="color: #009c8f;">)</span>
<span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">define-key</span> *top-map* <span style="color: #ad8900;">(</span>kbd <span style="color: #009c8f;">"XF86AudioRaiseVolume"</span><span style="color: #ad8900;">)</span> <span style="color: #009c8f;">"volume-control up"</span><span style="color: #009c8f;">)</span>
<span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">define-key</span> *top-map* <span style="color: #ad8900;">(</span>kbd <span style="color: #009c8f;">"XF86AudioPrev"</span><span style="color: #ad8900;">)</span> <span style="color: #009c8f;">"playerctl previous"</span><span style="color: #009c8f;">)</span>
<span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">define-key</span> *top-map* <span style="color: #ad8900;">(</span>kbd <span style="color: #009c8f;">"XF86AudioNext"</span><span style="color: #ad8900;">)</span> <span style="color: #009c8f;">"playerctl next"</span><span style="color: #009c8f;">)</span>
</pre>
</div>

<p>
If, surprisingly, there are no such knobs in WM, then <code>xbindkeys</code>
utility should be used:
<a href="https://man.freebsd.org/cgi/man.cgi?query=xbindkeys&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">https://man.freebsd.org/cgi/man.cgi?query=xbindkeys&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-x-pointing-devices" class="outline-2">
<h2 id="x-pointing-devices">Pointing devices</h2>
<div class="outline-text-2" id="text-x-pointing-devices">
<p>
As visible from next sections, I'm using a lot of pointing devices.
Some of them need configuration to conform with my habits. And some
are not.
</p>
</div>
<div id="outline-container-x-touchpad" class="outline-3">
<h3 id="x-touchpad">Touchpad</h3>
<div class="outline-text-3" id="text-x-touchpad">
<p>
This is the most hateful thing in my laptop. Although, the size of
touchpand in the Thinkpad X220 is relatively small, comparing to the
modern laptops with A5 size [ <i>sarcasm</i> ] touchpads, it still gets under
my hands when I type some text.
</p>

<p>
The Thinkpad X200 palmrest is the ideal for me — no touchpad, only
left and right mouse buttons and the trackpoint!
</p>


<div class="figure">
<p><img src="/assets/static/thinkpad-x200-no-touchpad.png" alt="Thinkpad X200 laptop" align="center" width="70%" />
</p>
<p class="fignum"><i>Thinkpad X200 laptop</i></p>
</div>

<p>
So, I just disabled the touchpad completely with the next
configuration for X server:
</p>

<pre class="example">
Section "InputClass"
    Identifier "X220 Touchpad"
    MatchIsTouchpad "on"
    MatchDevicePath "/dev/input/event*"
    Driver "libinput"
    Option "Ignore" "true"
EndSection
</pre>

<p>
Instead of it I prefer to use the next device:
</p>
</div>
</div>
<div id="outline-container-x-trackpoint" class="outline-3">
<h3 id="x-trackpoint">Trackpoint</h3>
<div class="outline-text-3" id="text-x-trackpoint">
<p>
The iconic input device of the all Thinkpads!
</p>

<p>
It doesn't require configuration in X. If it fits it sits.
</p>

<p>
In the FreeBSD some setup for trackpoint may be performed in the
<code>/etc/sysctl.conf</code> (if kernel module <code>acpi_ibm</code> is loaded):
</p>

<pre class="example">
hw.psm.trackpoint.sensitivity=150
hw.psm.trackpoint.upper_plateau=125
</pre>
</div>
</div>
<div id="outline-container-x-trackball" class="outline-3">
<h3 id="x-trackball">Trackball</h3>
<div class="outline-text-3" id="text-x-trackball">
<p>
I'm using the Logitech Trackman Marble Trackball with my left hand:
</p>


<div class="figure">
<p><img src="/assets/static/x-trackball.png" alt="Logitech Trackman Marble Trackball" align="center" width="70%" />
</p>
</div>

<p>
It's configuration for X is tricky enough:
</p>

<div class="org-src-container">
<pre class="src src-nil"><span class="linenr">1: </span>Section "InputClass"
<span class="linenr">2: </span>    Identifier "Marble Mouse"
<span class="linenr">3: </span>    MatchProduct "Logitech USB Trackball"
<span class="linenr">4: </span>    Driver "evdev"
<span id="coderef-trackball-emulation" class="coderef-off"><span class="linenr">5: </span>    Option "EmulateWheel" "true"</span>
<span class="linenr">6: </span>    Option "EmulateWheelButton" "9"
<span id="coderef-trackball-btn-mapping" class="coderef-off"><span class="linenr">7: </span>    Option "ButtonMapping" "3 8 1 4 5 6 7 2 9"</span>
<span id="coderef-x-axis-mapping" class="coderef-off"><span class="linenr">8: </span>    Option "XAxisMapping"  "6 7"</span>
<span class="linenr">9: </span>EndSection
</pre>
</div>

<p>
By default trackball has four buttons: two big buttons operate as left
and right mouse buttons and two small buttons operate as forward and
backward buttons, e.g. in the browser. There are no scroll wheel or
any scroll device and no middle button.
</p>

<p>
But with information from <a href="https://man.freebsd.org/cgi/man.cgi?query=evdev&amp;sektion=4&amp;format=html">man 4 evdev</a> it is possible to add both
scrolling and a missing middle button by reusing unnecessary for me
Forward/Backward buttons.
</p>

<p>
The <code>evdev</code> driver supports "wheel emulation mode" for pointing
devices — if specified button is pressed (see two lines starting from
<a href="#coderef-trackball-emulation" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-trackball-emulation');" onmouseout="CodeHighlightOff(this, 'coderef-trackball-emulation');">5</a> line) and mouse moved when the corresponding
vertical/horizontal scrolling events from "mouse wheel" will be
generated. This mode may looks hard to use with mouse but for
trackball it is doing the right thing — I'm able to press button and
scroll anywhere just with the ball.
</p>

<p>
Then the some magic starts. The line <a href="#coderef-trackball-btn-mapping" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-trackball-btn-mapping');" onmouseout="CodeHighlightOff(this, 'coderef-trackball-btn-mapping');">7</a> remaps
some buttons and <i>axes</i> of the pointing device. Each number corresponds
to some button and by default evdev uses buttons in natural order,
like: <code>Option "ButtonMapping" "1 2 3 4 5 6 7 8 9"</code>. So, to remap some
buttons it is necessary just to rearrange these numbers.
</p>

<p>
I used <code>xev</code> to get some clues about mapping between real buttons and
numbers:
</p>

<div class="org-src-container">
<label class="org-src-name">xev output after pressing the big left button on the trackball</label><pre class="src src-nil">ButtonPress event, serial 36, synthetic NO, window 0xc00001,
    root 0x26a, subw 0x0, time 277844392, (1194,439), root:(1194,439),
    state 0x0, button 1, same_screen YES

ButtonRelease event, serial 36, synthetic NO, window 0xc00001,
    root 0x26a, subw 0x0, time 277844538, (1194,439), root:(1194,439),
    state 0x100, button 1, same_screen YES
</pre>
</div>


<div class="figure">
<p><img src="/assets/static/logitech-marble-trackball-mappings.png" alt="Logitech Marble Trackball buttons' mappings" align="center" width="90%" />
</p>
<p class="fignum"><i>Logitech Marble Trackball buttons' mappings</i></p>
</div>

<p>
Looks like the number <code>2</code> is related to the middle mouse button, which
is not exists in my device. Also, looks like the numbers from 4 to 7
relates to <i>axes</i>: first two numbers to the Y-axis and the last two to
the X-axis, I think. I didn't find any clues in the documentation
about it.
</p>

<p>
So, I change numbers' positions in <code>ButtonMapping</code> option to use
trackball with my left hand:
</p>

<table border="2" cellspacing="0" cellpadding="6" frame="void">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Position in list</th>
<th scope="col" class="org-right">Original value</th>
<th scope="col" class="org-right">Remapped value</th>
<th scope="col" class="org-left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-left">Left button becomes the right mouse button</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">8</td>
<td class="org-left">Use left small button (Backward) as a middle button</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-left">Right button becomes the left mouse button</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-left">Don't touch axes</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">5</td>
<td class="org-right">5</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-right">6</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">7</td>
<td class="org-right">7</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">8</td>
<td class="org-right">2</td>
<td class="org-left">Move non-existent middle button to the unused "Backward" button</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">9</td>
<td class="org-right">9</td>
<td class="org-left">Don't change right small (Forward) button keycode, will use it in "EmulateWheelButton" option</td>
</tr>
</tbody>
</table>

<p>
The line <a href="#coderef-x-axis-mapping" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-x-axis-mapping');" onmouseout="CodeHighlightOff(this, 'coderef-x-axis-mapping');">8</a> is necessary to use horizontal scrolling in
some applications: if in Gimp I can use horizontal scrolling without
this line, then horizontal scrolling in Librewolf (Firefox) will not
work without it.
</p>
</div>
</div>
<div id="outline-container-x-mouse" class="outline-3">
<h3 id="x-mouse">Mouse</h3>
<div class="outline-text-3" id="text-x-mouse">
<p>
I'm using a black IBM MU29J ball mouse with my right hand.
</p>


<div class="figure">
<p><img src="/assets/static/ibm_mu29j_mouse.jpg" alt="Black IBM MU29J ball mouse with two buttons" align="center" width="70%" />
</p>
</div>

<p>
It has two buttons, so I just explicitly specify the necessity of
third button emulation in X server (press left and right buttons
simultaneously to make the middle button click):
</p>

<pre class="example">
Section "InputClass"
    Identifier   "IBM MU29J Mouse"
    Driver       "libinput"
    MatchDevicePath "/dev/input/event9"
    Option       "MiddleEmulation" "on"
    Option       "AccelProfile" "flat"
    Option       "AccelSpeed" "1.0"
EndSection
</pre>

<p>
I'm using the old libinput driver to be able to tweak acceleration of
mouse cursor. Possibly, I can do this with evdev driver, but libinput
configuration looks like simpler for me.
</p>
</div>
</div>
<div id="outline-container-x-drawing-tablet" class="outline-3">
<h3 id="x-drawing-tablet">Drawing tablet</h3>
<div class="outline-text-3" id="text-x-drawing-tablet">
<p>
I'm using the <a href="https://www.wacom.com/en-us/products/pen-tablets/one-by-wacom">One by Wacom tablet</a> and it doesn't requre any special
configuration. Just plug and draw.
</p>
</div>
</div>
</div>
<div id="outline-container-screensaver" class="outline-2">
<h2 id="screensaver">Screensaver</h2>
<div class="outline-text-2" id="text-screensaver">
<p>
Here the good old <a href="https://www.jwz.org/xscreensaver/">XScreenSaver</a> exists. It is damn simple:
</p>

<pre class="example">
~ λ ldd /usr/local/bin/xscreensaver
/usr/local/bin/xscreensaver:
    libSM.so.6 =&gt; /usr/local/lib/libSM.so.6 (0x25289f1d000)
    libICE.so.6 =&gt; /usr/local/lib/libICE.so.6 (0x2528a90b000)
    libXi.so.6 =&gt; /usr/local/lib/libXi.so.6 (0x2528b61f000)
    libX11.so.6 =&gt; /usr/local/lib/libX11.so.6 (0x2528ba37000)
    libc.so.7 =&gt; /lib/libc.so.7 (0x2528c4ee000)
    libXext.so.6 =&gt; /usr/local/lib/libXext.so.6 (0x2528da6b000)
    libxcb.so.1 =&gt; /usr/local/lib/libxcb.so.1 (0x2528d724000)
    libthr.so.3 =&gt; /lib/libthr.so.3 (0x2528ea36000)
    libXau.so.6 =&gt; /usr/local/lib/libXau.so.6 (0x252904e4000)
    libXdmcp.so.6 =&gt; /usr/local/lib/libXdmcp.so.6 (0x2528f831000)
    [vdso] (0x25289788000)
</pre>

<p>
With <code>xscreensaver</code> FreeBSD package also the <code>xscreensaver-settings</code>
program installed, which helps to configure screensaver:
</p>


<div class="figure">
<p><img src="/assets/static/xscreensaver-settings.png" alt="XScreenSaver settings window with BSOD screensaver demo launched inside it." width="90%" />
</p>
<p class="fignum"><i>XScreenSaver settings GUI</i></p>
</div>

<p>
It requires some GTK 3 related libraries, but the <code>xscreensaver</code> itself
doesn't depend on these libraries because of security:
</p>

<blockquote>
<p>
The unlock dialog is funny looking, why not use GTK?
</p>

<p>
The short answer is, for security reasons. The unlock dialog is
implemented using raw Xlib because it would be very difficult to
implement it using a GUI toolkit and still have XScreenSaver be
secure. More technical details can be found on the On Toolkits page.
</p>
</blockquote>

<p>
<i>Source</i>: <a href="https://www.jwz.org/xscreensaver/faq.html#toolkits">https://www.jwz.org/xscreensaver/faq.html#toolkits</a>
</p>

<blockquote>
<p>
Today, the only libraries that are actually linked into the
xscreensaver daemon are Xlib and dependent libraries; and the few
crypto-related libraries needed to determine whether a typed password
is, in fact, the right one.
</p>

<p>
That's why I implemented the unlock dialog using only Xlib: not
because I think Xlib is a good way to write user interfaces, but
because I think this was the safest way. The amount of code in Xlib is
very small, and has been extensively security audited. It is very
unlikely that there are crashing bugs lurking in Xlib itself. The same
cannot be said for larger, more featureful libraries. So, by making
minimal use of Xlib (the dialog box is drawn using only the lowest
level text-printing and rectangle-drawing routines) we can keep the
code path short and auditable.
</p>
</blockquote>

<p>
<i>Source</i>: <a href="https://www.jwz.org/xscreensaver/toolkits.html">https://www.jwz.org/xscreensaver/toolkits.html</a>
</p>

<p>
Configuration, through the <code>xscreensaver-settings</code>, is damn simple too.
Anyway, all settings are written to the <code>~/.xscreensaver</code> file.
</p>

<p>
To use screensaver the <code>xscreensaver</code> should be started when the X
starts: via the <code>~/.xinitrc</code>, <code>~/.xsession</code> or configuration file for WM.
In my case, I use this line for StumpWM:
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #009c8f;">(</span>run-shell-command <span style="color: #009c8f;">"xscreensaver --no-splash"</span><span style="color: #009c8f;">)</span>
</pre>
</div>

<p>
Because xscreensaver will use DPMS and could blank a screen — these
commands should not be executed during the X startup:
</p>

<pre class="example">
xset s off
xset s noblank
xset -dpms
</pre>

<p>
And to increase security, according to the <a href="https://man.freebsd.org/cgi/man.cgi?query=xscreensaver&amp;sektion=1&amp;manpath=freebsd-release-ports">man 1 xscreensaver</a> (see the
section <code>SECURITY CONCERNS</code>, subsection <code>MAGIC BACKDOOR KEYSTROKES</code>),
there are some options in the X server configuration should be
disabled:
</p>
<ol class="org-ol">
<li>Magic <code>Ctrl+Alt+Backspace</code> keystroke. It should be disable because
someone could kill your X server for fun. And because if X server
was launched manually via <code>startx</code> then the attacker could get access
to the your text console.</li>
<li>Also manual recommends to disable some Linux-specific <a href="https://en.wikipedia.org/wiki/Magic_SysRq_key">Magic SysRq
keys</a>, which is not applicable to FreeBSD. And disable keys to
switch between virtual text consoles but I use these keybindings
sometimes, so I didn't disable them (anyway, I don't leave any text
console unlocked).</li>
</ol>

<p>
According to the man 5 xorg.conf there are these lines should be
placed in the X configuration files to disable <code>Ctrl+Alt+Backspace</code>
keybinding:
</p>

<pre class="example">
Section "ServerFlags"
    Option "DontZap"  "true"
EndSection
</pre>
</div>
<div id="outline-container-disable-screensaver-4-videos" class="outline-3">
<h3 id="disable-screensaver-4-videos">Disable screensaver for fullscreen videos</h3>
<div class="outline-text-3" id="text-disable-screensaver-4-videos">
<p>
Sadly, there are only two options:
</p>
<ol class="org-ol">
<li>Use systemd — there is some abomination named <code>xscreensaver-systemd</code>
exists, which disables the screensaver when multimedia player
reports to it about playing video via D-Bus. Obviously, this is not
acceptable.</li>
<li>Stop screensaver via <code>xscreensaver-command -exit</code> and start it again
via <code>xscreensaver --no-splash</code>.</li>
</ol>

<p>
Because I'm using StumpWM, I automated toggling the state of
XScreensaver with the next code:
</p>

<div class="org-src-container">
<pre class="src src-lisp">                                        <span style="color: #909995;">; XScreensaver automation</span>
<span style="color: #009c8f;">(</span><span style="color: #489100; font-weight: bold;">let</span> <span style="color: #ad8900;">(</span><span style="color: #0072d4;">(</span>xscreensaver-running t<span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span>
  <span style="color: #ad8900;">(</span><span style="color: #489100; font-weight: bold;">defun</span> <span style="color: #0072d4;">xscreensaver-toggle</span> <span style="color: #0072d4;">()</span>
    <span style="color: #009c8f;">"Toggle XScreensaver state if fullscreen video is playing."</span>
    <span style="color: #0072d4;">(</span><span style="color: #489100; font-weight: bold;">if</span> xscreensaver-running
        <span style="color: #8762c6;">(</span><span style="color: #489100; font-weight: bold;">progn</span>
          <span style="color: #489100;">(</span>run-shell-command <span style="color: #009c8f;">"xscreensaver-command --exit"</span><span style="color: #489100;">)</span>
          <span style="color: #489100;">(</span>run-shell-command <span style="color: #009c8f;">"xset -dpms"</span><span style="color: #489100;">)</span>
          <span style="color: #489100;">(</span>setf xscreensaver-running nil<span style="color: #489100;">)</span><span style="color: #8762c6;">)</span>
        <span style="color: #8762c6;">(</span><span style="color: #489100; font-weight: bold;">progn</span>
          <span style="color: #489100;">(</span>run-shell-command <span style="color: #009c8f;">"xscreensaver --no-splash"</span><span style="color: #489100;">)</span>
          <span style="color: #489100;">(</span>run-shell-command <span style="color: #009c8f;">"xset +dpms"</span><span style="color: #489100;">)</span>
          <span style="color: #489100;">(</span>setf xscreensaver-running t<span style="color: #489100;">)</span><span style="color: #8762c6;">)</span><span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span>
  <span style="color: #ad8900;">(</span><span style="color: #489100; font-weight: bold;">defun</span> <span style="color: #0072d4;">any-fullscreen-window-p</span> <span style="color: #0072d4;">()</span>
    <span style="color: #009c8f;">"Checks is any fullscreen window is displayed."</span>
    <span style="color: #0072d4;">(</span>find
     t
     <span style="color: #8762c6;">(</span>mapcar <span style="color: #489100;">(</span><span style="color: #489100; font-weight: bold;">lambda</span> <span style="color: #ad8900;">(</span>win<span style="color: #ad8900;">)</span> <span style="color: #ad8900;">(</span>window-fullscreen win<span style="color: #ad8900;">)</span><span style="color: #489100;">)</span> <span style="color: #489100;">(</span>all-windows<span style="color: #489100;">)</span><span style="color: #8762c6;">)</span><span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span>
  <span style="color: #ad8900;">(</span>run-with-timer 10 10
                  <span style="color: #0072d4;">(</span><span style="color: #489100; font-weight: bold;">lambda</span> <span style="color: #8762c6;">()</span>
                    <span style="color: #8762c6;">(</span><span style="color: #489100; font-weight: bold;">if</span> <span style="color: #489100;">(</span>any-fullscreen-window-p<span style="color: #489100;">)</span>
                        <span style="color: #489100;">(</span><span style="color: #489100; font-weight: bold;">if</span> xscreensaver-running <span style="color: #ad8900;">(</span>xscreensaver-toggle<span style="color: #ad8900;">)</span><span style="color: #489100;">)</span>
                        <span style="color: #489100;">(</span><span style="color: #489100; font-weight: bold;">if</span> <span style="color: #ad8900;">(</span>not xscreensaver-running<span style="color: #ad8900;">)</span> <span style="color: #ad8900;">(</span>xscreensaver-toggle<span style="color: #ad8900;">)</span><span style="color: #489100;">)</span><span style="color: #8762c6;">)</span><span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span><span style="color: #009c8f;">)</span>
</pre>
</div>

<p>
This code is simple enough. Here the <code>xscreensaver-running</code> variable in
the <code>let</code> clause which indicates the XScreensaver state. By default
XScreensaver is enabled after StumpWM startup. The function
<code>xscreensaver-toggle</code> toggles the xscreensaver and DPMS capabilities —
turning it on or off. Another function: <code>any-fullscreen-window-p</code>
returns <code>t</code> if there is any fullscreen window (like media player window
or online player window) in the StumpWM. Or <code>nil</code> if there are no such
windows.
</p>

<p>
And the last S-expression just starts 10-second repetitive timer which
disables XScreensaver if there is any fullscreen window and
XScreensaver is running. Or enables it otherwise.
</p>
</div>
</div>
<div id="outline-container-xlock" class="outline-3">
<h3 id="xlock">Update 2025-12-13 (xlock):</h3>
<div class="outline-text-3" id="text-xlock">
<p>
As I found from vermaden's blog, there is much simpler solution! The
<code>xlock</code>, see: <a href="https://vermaden.wordpress.com/2018/06/23/freebsd-desktop-part-10-key-components-locking-solution/">"FreeBSD Desktop – Part 10 – Key Components – Locking
Solution"</a>. All configuration can be made through X resources (see the
<a href="https://man.freebsd.org/cgi/man.cgi?query=xlock&amp;sektion=1&amp;manpath=FreeBSD+5.3-RELEASE+and+Ports">man (1) xlock</a>). For example, this is my configuration:
</p>
<pre class="example">
! xlock settings:
XLock.mode: matrix
XLock.erasemode: no_fade
XLock.description: off
XLock.echokeys: on
XLock.echokey: *
XLock.showdate: off
XLock.usefirst: off
XLock.lockdelay: 5
XLock.fontset: -*-trebuchet ms-medium-r-*-*-40-*-*-*-*-*-*
XLock.background: white
XLock.foreground: black
XLock.username: user:
XLock.password: pass:
XLock.info:
XLock.validate: Checking...
XLock.invalid: lol, nope :-D
XLock.icongeometry: 128x128
XLock.message:
XLock.dpmsoff: 300
XLock.matrix.saturation: 0.4
</pre>

<p>
This is how the screensaver looks like:
</p>


<div class="figure">
<p><img src="/assets/static/xlock-screensaver.png" alt="Matrix screensaver with saturated colors." align="center" width="100%" />
</p>
</div>

<p>
And the lock screen is damn simple!
</p>


<div class="figure">
<p><img src="/assets/static/xlock-lockscreen.png" alt="Lockscreen with white background and black foregraund and Trebuchet MS font. There are Matrix icon, line &quot;user: drag0n@drag0n-laptop.lair.internal&quot; and the line &quot;pass:&quot;." align="center" width="100%" />
</p>
</div>

<p>
To launch the xlock with aforementioned configuration, the command
<code>xlock</code> is enough.
</p>

<p>
And to launch xlock automatically, after some period of inactivity,
there is small utility called <code>xautolock</code>. It can also be configured via
the <code>~/.Xresources</code>, e.g.:
</p>
<pre class="example">
! xautolock settings:
Xautolock.time: 5
Xautolock.corners: 00--
Xautolock.cornersize: 50
</pre>

<p>
Here I use one cool feature, which doesn't exists in XScreenSaver.
Each corner of the desktop could be used to execute xlock immediately
or after some time, or to forbid execution of screensaver. In my case
I don't do any action when mouse is in one of the two upper corners.
And if mouse is in one of the two bottom corners — the xlock will not
be started after some period of inactivity.
</p>

<p>
So, I doesn't need any Lisp code to watch videos without screensaver
suddenly popping up — I'm able just to move mouse to the corner and
that's all.
</p>

<p>
So, to make all these machine work, it is enough to launch command
<code>xautolock -secure</code> somewhere in the <code>~/.xinitrc</code> or during the WM
startup.
</p>
</div>
</div>
</div>
<div id="outline-container-picom" class="outline-2">
<h2 id="picom">Compositor (no, not that thing from Wayland)</h2>
<div class="outline-text-2" id="text-picom">
<p>
Here, the word "compositor" means the "compositing
manager"<sup><a id="fnr.compositing-manager" class="footref" href="#fn.compositing-manager" role="doc-backlink">2</a></sup> — usually these software used to draw
nice shadows, make nice 3D effects and so on with the existing WM/DE.
The most known compositor is <a href="https://launchpad.net/compiz">Compiz</a>, which was used to have a nice "3D
rotating cube" effect for switching between workspaces, wobbly
windows, transparency and so on.
</p>

<p>
For lightweight WMs there are lightweigh compositors exists. First was
<a href="https://gitlab.freedesktop.org/xorg/app/xcompmgr/">xcompmgr</a>, with shadows and transparency for windows on the screen.
Then, xcompmgr was forked to the <a href="http://git.openbox.org/?p=dana/xcompmgr.git;a=summary">xcompmgr-dana</a> with support of
transparent menus and some bugfixes. Then xcompmgr-dana was forked to
the <a href="https://github.com/chjj/compton">Compton</a>, also with some bugfixes and with added windows' dimming,
colored shadows and blurring. Then Compton <a href="https://github.com/yshui/picom/blob/next/History.md">was forked</a> to the <a href="https://github.com/yshui/picom">Picom</a>
because the first became unmaintained.
</p>

<p>
And now I'm using the Picom to get some niceties in my StumpWM. All
nice things may be set right in the one configuration file:
<code>~/.config/picom.conf</code>.
</p>

<p>
I didn't change main settings a lot, just disable D-Bus support,
blurring, setup common shadow and fade settings:
</p>

<pre class="example">
# shadow
shadow = true;
shadow-radius = 10;
shadow-offset-x = -5;
shadow-offset-y = -5;

# fading
fading = true;
fade-in-step = 0.05;
fade-out-step = 0.05;
fade-delta = 7;

# background blurring
blur-background = false;

use-ewmh-active-win = true;
crop-shadow-to-monitor = true;
dbus = false;
unredir-if-possible = true;
</pre>

<p>
The last line here just disables picom effects if it is necessary by
rules, or if there is fullscreen window right now on the display, or
there are no windows managed by rules at all.
</p>

<p>
All niceties should be configured by rules — if rule matches a desired
window, then the effect, described in rule, will be applied to the
window.
</p>
</div>
<div id="outline-container-picom-usual-windows" class="outline-3">
<h3 id="picom-usual-windows">Changing size of usual windows</h3>
<div class="outline-text-3" id="text-picom-usual-windows">
<p>
For the all "usual" windows (not the dialog, not the splash-screen,
menu, etc) I use <code>geometry-change</code> animation preset when window size is
changed:
</p>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"window_type = 'normal'"</span>;
    animations = ({
        triggers = [ <span style="color: #009c8f;">"geometry"</span> ];
        preset = <span style="color: #009c8f;">"geometry-change"</span>;
        duration = <span style="color: #009c8f;">"0.2"</span>;
    });
}
</pre>
</div>

<p>
This <b>feature still experimental</b>, so it may looks not so good.
</p>

<p>
In StumpWM this feature may be triggered with frame split or with
<code>expose</code> command<sup><a id="fnr.screenrecord" class="footref" href="#fn.screenrecord" role="doc-backlink">3</a></sup>:
</p>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/picom-geometry-change.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>
</div>
</div>
<div id="outline-container-picom-splash-screen" class="outline-3">
<h3 id="picom-splash-screen">Transparent splash screens</h3>
<div class="outline-text-3" id="text-picom-splash-screen">
<p>
I made the splash screens transparent (and remove shadows for it) with
the next rule:
</p>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"window_type = 'splash'"</span>;
    shadow = <span style="color: #0072d4; font-weight: bold;">false</span>;
    opacity = 0.7;
}
</pre>
</div>

<p>
The result looks like this:
</p>


<div class="figure">
<p><img src="/assets/static/picom-transparent-splash-screens.jpg" alt="Gimp splash screen transparent with some text in Emacs under it." align="center" width="90%" />
</p>
</div>
</div>
</div>
<div id="outline-container-picom-dialog" class="outline-3">
<h3 id="picom-dialog">Sliding dialog windows</h3>
<div class="outline-text-3" id="text-picom-dialog">
<p>
With the next rule my dialog windows will nicely slide from the bottom
when pop up. And slide down when I close them. Also I add a small
rounded corners for the dialog windows — they'll be visible only if
dialog window background differs from the main window background.
</p>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"window_type = 'dialog'"</span>;
    corner-radius = 10;
    shadow = <span style="color: #0072d4; font-weight: bold;">false</span>;
    animations = ({
        triggers = [ <span style="color: #009c8f;">"open"</span>, <span style="color: #009c8f;">"show"</span> ];
        preset = <span style="color: #009c8f;">"slide-in"</span>;
        direction = <span style="color: #009c8f;">"down"</span>;
        duration = 0.2;
    },
    {
        triggers = [ <span style="color: #009c8f;">"close"</span>, <span style="color: #009c8f;">"hide"</span> ];
        preset = <span style="color: #009c8f;">"slide-out"</span>;
        direction = <span style="color: #009c8f;">"down"</span>;
        duration = 0.2;
    });
}
</pre>
</div>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/picom-sliding-dialog.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>

<p>
The dialog windows were pinned to the bottom, using the next Common
Lisp code in StumpWM:
</p>

<div class="org-src-container">
<pre class="src src-lisp">                                        <span style="color: #909995;">; Position for popup and transient windows</span>
<span style="color: #009c8f;">(</span>stumpwm::set-transient-gravity <span style="color: #53676d; font-weight: bold;">:bottom</span><span style="color: #009c8f;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-picom-emacs-effects" class="outline-3">
<h3 id="picom-emacs-effects">Effects for Emacs</h3>
<div class="outline-text-3" id="text-picom-emacs-effects">
<p>
For Emacs I use the next things in corresponding rule:
</p>
<ul class="org-ul">
<li>Nice rounded corners for Emacs frames.</li>
<li>Picom operates with Emacs frame even if it is fullscreen — to see
rounded corners when frame is fullscreen.</li>
<li>Effect of sliding from left to right when new Emacs frame is
opened. And effect of sliding down when frame is closed (or
minimized).</li>
</ul>


<div class="figure">
<p><img src="/assets/static/picom-emacs-rounded-corners.png" alt="Emacs frame with rounded corners" wdith="90%" />
</p>
<p class="fignum"><i>Emacs frame with rounded corners</i></p>
</div>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"class_i = 'emacs'"</span>;
    corner-radius = 25;
    unredir = <span style="color: #0072d4; font-weight: bold;">false</span>;
    animations = ({
        triggers = [ <span style="color: #009c8f;">"open"</span>, <span style="color: #009c8f;">"show"</span> ];
        preset = <span style="color: #009c8f;">"slide-in"</span>;
        direction = <span style="color: #009c8f;">"left"</span>;
        duration = 0.2;
    },
    {
        triggers = [ <span style="color: #009c8f;">"close"</span>, <span style="color: #009c8f;">"hide"</span> ];
        preset = <span style="color: #009c8f;">"slide-out"</span>;
        direction = <span style="color: #009c8f;">"down"</span>;
        duration = 0.2;
    });
}
</pre>
</div>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/picom-emacs-effects.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>
</div>
</div>
<div id="outline-container-picom-librewolf-fix" class="outline-3">
<h3 id="picom-librewolf-fix">Librewolf: menu fix</h3>
<div class="outline-text-3" id="text-picom-librewolf-fix">
<p>
Ah, it is Firefox / Librewolf again! I mentioned it above and will
mention below. Looks like it is that piece of software, which makes
problems when you are trying to do things in simple way.
</p>

<p>
Firefox draws it's own shadows on the menus. So, if I have shadows
from picom enabled, then only in Firefox (!) the menus will look like
this:
</p>


<div class="figure">
<p><img src="/assets/static/picom-firefox-menus-glitch.png" alt="Glitched Firefox menu with semi-transparent box around it" align="center" width="50%" />
</p>
<p class="fignum"><i>Glitched Firefox menu</i></p>
</div>

<p>
To fix it, I use the next rule, which disables shadows for such menus:
</p>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"class_g = 'librewolf' &amp;&amp; argb"</span>;
    shadow = <span style="color: #0072d4; font-weight: bold;">false</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-picom-stumpwm" class="outline-3">
<h3 id="picom-stumpwm">Effects for StumpWM parts</h3>
<div class="outline-text-3" id="text-picom-stumpwm">
<p>
Of course, it is possible to add a nice effects for different StumpWM
parts like mode-line, or menus, or input windows. There is only one
problem — the StumpWM didn't assign WM_CLASS or any other hint to such
windows, so it is impossible to use picom's match filter out of the
box.
</p>

<p>
To add WM_CLASS to the mentioned StumpWM parts I've used the next
Common Lisp code:
</p>

<div class="org-src-container">
<pre class="src src-lisp">                                        <span style="color: #909995;">; Assign WM_CLASS to the messages window</span>
<span style="color: #009c8f;">(</span>xlib:set-wm-class <span style="color: #ad8900;">(</span>screen-message-window <span style="color: #0072d4;">(</span>current-screen<span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span>
                   <span style="color: #009c8f;">"stumpwm-message"</span> <span style="color: #009c8f;">"stumpwm-message"</span><span style="color: #009c8f;">)</span>
                                        <span style="color: #909995;">; Assign WM_CLASS to the input window</span>
<span style="color: #009c8f;">(</span>xlib:set-wm-class <span style="color: #ad8900;">(</span>screen-input-window <span style="color: #0072d4;">(</span>current-screen<span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span>
                   <span style="color: #009c8f;">"stumpwm-input"</span> <span style="color: #009c8f;">"stumpwm-input"</span><span style="color: #009c8f;">)</span>

<span style="color: #909995;">;;; </span><span style="color: #909995;">Assign WM_CLASS to the mode-line</span>
<span style="color: #909995;">;;; </span><span style="color: #909995;">https://www.reddit.com/r/stumpwm/comments/12zes3j/how_can_i_find_property_of_message_box_and/</span>

<span style="color: #009c8f;">(</span>add-hook *new-mode-line-hook* <span style="color: #ad8900;">(</span><span style="color: #489100; font-weight: bold;">lambda</span> <span style="color: #0072d4;">(</span>mode-line<span style="color: #0072d4;">)</span>
                                 <span style="color: #0072d4;">(</span>xlib:set-wm-class <span style="color: #8762c6;">(</span>mode-line-window mode-line<span style="color: #8762c6;">)</span>
                                                    <span style="color: #009c8f;">"stumpwm-modeline"</span>
                                                    <span style="color: #009c8f;">"stumpwm-modeline"</span><span style="color: #0072d4;">)</span><span style="color: #ad8900;">)</span><span style="color: #009c8f;">)</span>
</pre>
</div>

<p>
And after that I'm able to write rules in the <code>picom.conf</code> as usual. For
example, the menus, sliding from the right:
</p>

<div class="org-src-container">
<pre class="src src-js">{
    match = <span style="color: #009c8f;">"class_i = 'stumpwm-message' || class_i = 'stumpwm-input'"</span>;
    opacity = 0.9;
    animations = ({
        triggers = [ <span style="color: #009c8f;">"open"</span>, <span style="color: #009c8f;">"show"</span> ];
        preset = <span style="color: #009c8f;">"fly-in"</span>;
        direction = <span style="color: #009c8f;">"right"</span>;
        duration = 0.2;
    },
    {
        triggers = [ <span style="color: #009c8f;">"close"</span>, <span style="color: #009c8f;">"hide"</span> ];
        preset = <span style="color: #009c8f;">"fly-out"</span>;
        direction = <span style="color: #009c8f;">"right"</span>;
        duration = 0.2;
    });
}
</pre>
</div>

<p>
The resulting effect looks like this:
</p>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/picom-stumpwm.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>
</div>
</div>
</div>
<div id="outline-container-x-disable-outputs" class="outline-2">
<h2 id="x-disable-outputs">Disabling unwanted outputs</h2>
<div class="outline-text-2" id="text-x-disable-outputs">
<p>
By default, my laptop has a 1366x768 display, which was connected via
the LVDS interface<sup><a id="fnr.lvds" class="footref" href="#fn.lvds" role="doc-backlink">4</a></sup> to the motherboard. Of course, after I
started to use a new 2K display, connected via the expansion board to
the DP-3 output, the old display was disconnected and lying somewhere
on the shelf now.
</p>

<p>
But the laptop's hardware still thinks that some 1366x768 display
still connected to the LVDS and the X server still can use it as a
working output. So, to completely stop X server from using this
output, I explicitly described my LVDS and DP-3 outputs in the
videocard section:
</p>

<pre class="example">
Section "Device"
    Identifier  "intel"
    Driver      "modesetting"
    BusID       "PCI:0:2:0"
    ...
    Option      "Monitor-DP-3"   "MainMonitor"
    Option      "Monitor-LVDS-1" "PhantomMonitor"
EndSection
</pre>

<p>
Here the outputs is described in the next format: <code>Monintor-OutputName</code>,
where the <code>OutputName</code> used right as they printed by <code>xrandr</code>.
</p>

<p>
Then, in the section for non-existent default monitor, I describe it
as disabled and ignored monitor:
</p>

<pre class="example">
Section "Monitor"
    Identifier  "PhantomMonitor"
    Option      "Primary" "false"
    Option      "Disable"  "true"
    Option      "Ignore"   "true"
EndSection
</pre>

<p>
As a result, the LVDS output not available even in the <code>xrandr</code> output:
</p>

<pre class="example">
~ λ xrandr
Screen 0: minimum 320 x 200, current 2560 x 1440, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
   2560x1440     59.95*+  39.97
VGA-1 disconnected (normal left inverted right x axis y axis)
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>
</div>
</div>
<div id="outline-container-x-randr" class="outline-2">
<h2 id="x-randr">Juggling with displays</h2>
<div class="outline-text-2" id="text-x-randr">
<p>
Speaking about <code>xrandr</code>. I tried some GUI applications, like <a href="https://christian.amsuess.com/tools/arandr/">arandr</a>, to
switch between various multimonitor configurations — but found that
they all are using just a limited subset of <code>xrandr</code> features.
</p>

<p>
For example, I can't use mixed DPI settings or scale some outputs with
arandr, but I can do it with xrandr:
<a href="https://mas.to/@evgandr/114394277310057344">https://mas.to/@evgandr/114394277310057344</a>. Yes, the X can do that!
The well-known rumors (usually spreaded by Wayland fans) that only
Wayland can do such things — looks like a fake.
</p>

<p>
There are some utilities to configure newly connected display(s)
automatically, like <a href="https://github.com/phillipberndt/autorandr">autorandr</a> or <a href="https://github.com/alex-courtis/xlayoutdisplay">xlayoutdisplay</a>. But I prefer to issue
<code>xrandr</code> commands by my hands, when I attach additional display(s) to my
laptop. Because automation not always works the necessary way.
</p>

<p>
For example, let's play with a big Benq XI2420z 24" monitor with
1920x1080 as a maximal available resoultion. I connected it to my
laptop via good old VGA cable. So by default it reports not so much
useful resolutions:
</p>

<pre class="example">
~ λ xrandr
Screen 0: minimum 320 x 200, current 2560 x 1440, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
   2560x1440     59.95*+  39.97
VGA-1 connected (normal left inverted right x axis y axis)
   1024x768      60.00
   800x600       60.32    56.25
   848x480       60.00
   640x480       59.94
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>

<p>
I can use the <code>--auto</code> key to let the <code>xrandr</code> use some automation and
connect my Benq as the monitor right of my main monitor:
</p>

<pre class="example">
~ λ xrandr --output VGA-1 --right-of DP-3 --auto
~ λ xrandr
Screen 0: minimum 320 x 200, current 3584 x 1440, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
   2560x1440     59.95*+  39.97
VGA-1 connected 1024x768+2560+0 (normal left inverted right x axis y axis) 0mm x 0mm
   1024x768      60.00*
   800x600       60.32    56.25
   848x480       60.00
   640x480       59.94
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>

<p>
And it looks like not so good:
</p>


<div class="figure">
<p><img src="/assets/static/xrandr-1024.png" alt="X output on the two displays, one is 2K with 2560x1440 resolution and the other with 1024x768 resolution." align="center" width="90%" />
</p>
<p class="fignum"><i>X output for primary display with 2560x1440 resolution and secondary with 1024x768 resolution</i></p>
</div>

<p>
No problem! I'll add 1920x1080 resolution by myself!
</p>

<p>
To calculate the proper modeline for necessary resolution, the <code>cvt</code>
utility exists (see <a href="https://man.freebsd.org/cgi/man.cgi?query=cvt&amp;apropos=0&amp;sektion=1&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">man 1 cvt</a>). It accepts the desired resolution (and
refresh rate if necessary) and outputs the modeline string, which
should be just passed to the xrandr. Then, added modeline could be
attached to the desired video output — to the <code>VGA-1</code> in my case:
</p>

<pre class="example">
~ λ cvt -r 1920 1080
# 1920x1080 59.93 Hz (CVT 2.07M9-R) hsync: 66.59 kHz; pclk: 138.50 MHz
Modeline "1920x1080R"  138.50  1920 1968 2000 2080  1080 1083 1088 1111 +hsync -vsync
~ λ xrandr --newmode "1920x1080R" 138.50  1920 1968 2000 2080  1080 1083 1088 1111 +hsync -vsync
~ λ xrandr --addmode VGA-1 1920x1080R
~ λ xrandr
Screen 0: minimum 320 x 200, current 3584 x 1440, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
   2560x1440     59.95*+  39.97
VGA-1 connected 1024x768+2560+0 (normal left inverted right x axis y axis) 0mm x 0mm
   1024x768      60.00*
   800x600       60.32    56.25
   848x480       60.00
   640x480       59.94
   1920x1080R    59.93
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>

<p>
And, as a result I can use the newly created modeline to "reconnect"
my second monitor with 1920x1080 resolution:
</p>

<pre class="example">
~ λ xrandr --output VGA-1 --right-of DP-3 --mode 1920x1080R
</pre>


<div class="figure">
<p><img src="/assets/static/xrandr-1920.png" alt="X output on the two displays, one is 2K with 2560x1440 resolution and the other with 1920x1080 resolution." align="center" width="90%" />
</p>
<p class="fignum"><i>X output for primary display with 2560x1440 resolution and secondary with 1920x1080 resolution</i></p>
</div>

<p>
Resulting output of <code>xrandr</code>:
</p>

<pre class="example">
~ λ xrandr
Screen 0: minimum 320 x 200, current 4480 x 1440, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
   2560x1440     59.95*+  39.97
VGA-1 connected 1920x1080+2560+0 (normal left inverted right x axis y axis) 0mm x 0mm
   1024x768      60.00
   800x600       60.32    56.25
   848x480       60.00
   640x480       59.94
   1920x1080R    59.93*
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>

<p>
Note, how size of "virtual" framebuffer changed with this operation.
When I used 1024x768 resolution it was <code>3584x1440</code>. And after switching
to 1920x1080 resolution for the second monitor it became: <code>4480x1440</code>.
</p>

<p>
Looks good, but on this second monitor things looks soo big, comparing
with my primary laptop monitor. No problem! I can scale down the
output on the second monitor, so more UI elements wil fit in it:
</p>

<pre class="example">
~ λ xrandr --output VGA-1 --right-of DP-3 --mode 1920x1080R --scale 1.9 --filter nearest
</pre>

<p>
Result:
</p>


<div class="figure">
<p><img src="/assets/static/xrandr-1920-scaled.png" alt="X output on the two displays, one is 2K with 2560x1440 resolution and the other with 1920x1080 resolution (scaled)." align="center" width="90%" />
</p>
<p class="fignum"><i>X output for primary display with 2560x1440 resolution and secondary with 1920x1080 resolution (scaled)</i></p>
</div>

<p>
Now the screen sizes on the both displays are representing a real
monitor dimensions (not ideally).
</p>

<p>
The number after the <code>--scaled</code> option was set after some experiments.
Ideally, it should has the some value which allows the GIU element
with 2 cm length on the primary screen has the same length on the
secondary display. But I just don't need such level of accuracy, so I
set this value "by eye".
</p>

<p>
Note, how size of virtual framebuffer changed again:
</p>

<pre class="example">
~ λ xrandr
Screen 0: minimum 320 x 200, current 6208 x 2052, maximum 8192 x 8192
DP-3 connected primary 2560x1440+0+0 (normal left inverted right x axis y axis) 277mm x 155mm
2560x1440     59.95*+  39.97
VGA-1 connected 3648x2052+2560+0 (normal left inverted right x axis y axis) 0mm x 0mm
1024x768      60.00
800x600       60.32    56.25
848x480       60.00
640x480       59.94
1920x1080R    59.93*
HDMI-1 disconnected (normal left inverted right x axis y axis)
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
HDMI-3 disconnected (normal left inverted right x axis y axis)
DP-2 disconnected (normal left inverted right x axis y axis)
</pre>

<p>
Here the one problem lies. See the <code>maximum 8192 x 8192</code> string? If I
connect tons of external monitors to my laptop, then I'll be
constrained with the 8192x8192 pixels as a size of global framebuffer.
So, some big resolutions will become unaccessible, e.g. if I connect
two additional 2K/4K monitors and try to use them with my laptop's 2K
monitor.
</p>

<p>
Looks like (according to the little search in the Internet:
<a href="https://bugs.freedesktop.org/show_bug.cgi?id=102508">https://bugs.freedesktop.org/show_bug.cgi?id=102508</a>), the maximal
resolution depends on the used graphical drivers or hardware…
</p>
</div>
</div>
<div id="outline-container-xterm" class="outline-2">
<h2 id="xterm">Terminal</h2>
<div class="outline-text-2" id="text-xterm">
<p>
Usually, I'm using eshell when I need a terminal.
</p>


<div class="figure">
<p><img src="/assets/static/x-eshell.png" alt="Eshell buffer in the Emacs" align="center" width="90%" />
</p>
<p class="fignum"><i>Eshell buffer</i></p>
</div>

<p>
But <i>sometimes</i> I need the plain old-school terminal. E.g. when I
configure some FreeBSD ports — somehow both eshell and <code>/bin/sh</code> in
<code>ansi-term</code> didn't behave well with displaying these ncurses interfaces.
</p>

<p>
So, for this rare curcumstances I'm using plain old <code>xterm</code>. It is
configuration is pretty simple — just write necessary X resources
lines in the file and source it with <code>xrdb -merge /path/to/file</code>. The
list of all available X resources for XTerm available in the <a href="https://man.freebsd.org/cgi/man.cgi?query=xterm&amp;apropos=0&amp;sektion=1&amp;manpath=FreeBSD+14.3-RELEASE+and+Ports&amp;arch=default&amp;format=html">man 1
xterm</a> manpage.
</p>

<p>
So, I apply the next settings with lines from my
<code>~/.Xresources.d/xterm</code>:
</p>
<ul class="org-ul">
<li>double buffering</li>
<li>use Scroll Lock key to really lock scrolling</li>
<li>blinking cursor, displayed as a rectangle</li>
<li>just reverse colors for text selection and don't keep selection if
some new output is displayed</li>
<li>don't cut new line when select some text</li>
<li>insert selection to the <code>CLIPBOARD</code> (text could be inserted via the
<code>Shift+Insert</code>) not to the <code>PRIMARY</code> (inserted via middle mouse button)
buffer.</li>
<li>use UTF8</li>
</ul>

<pre class="example">
XTerm.buffered:                  true
XTerm.bufferedFPS:               60
XTerm.maximized:                 true
XTerm.sameName:                  true
XTerm.vt100.allowBoldFonts:      true
XTerm.vt100.allowScrollLock:     true
XTerm.vt100.alwaysHighlight:     true
XTerm.vt100.autoWrap:            true
XTerm.vt100.cursorBar:           false
XTerm.vt100.cursorBlink:         always
XTerm.vt100.cutNewLine:          false
XTerm.vt100.fastScroll:          true
XTerm.vt100.highlightReverse:    true
XTerm.vt100.hightlightSelection: true
XTerm.vt100.keepSelection:       false
XTerm.vt100.logInhibit:          true
XTerm.vt100.loginShell:          true
XTerm.vt100.maxGraphicSize:      2560x1440
XTerm.vt100.utf8:                always
XTerm.vt100.wideChars:           true
</pre>

<p>
Then, the color settings going on. Here I define only 16 colors from
the Solarized Light color theme:
</p>

<pre class="example">
!
! Solarized Light colors:
!
! Background color for Solarized Light:
XTerm.vt100.background:          #fdf6e3
! Foreground color for Solarized Light
XTerm.vt100.foreground:          #1c1c1c
! Black
XTerm.vt100.color0:              #262626
! Red
XTerm.vt100.color1:              #dc322f
! Green
XTerm.vt100.color2:              #859900
! Yellow
XTerm.vt100.color3:              #b58900
! Blue
XTerm.vt100.color4:              #268bd2
! Magenta
XTerm.vt100.color5:              #d33682
! Cyan
XTerm.vt100.color6:              #2aa198
! White
XTerm.vt100.color7:              #eee8d5
!
! Solarized Light bright colors:
!
! Black
XTerm.vt100.color8:              #002b36
! Red
XTerm.vt100.color9:              #cb4b16
! Green
XTerm.vt100.color10:             #586e75
! Yellow
XTerm.vt100.color11:             #657b83
! Blue
XTerm.vt100.color12:             #839496
! Magenta
XTerm.vt100.color13:             #6c71c4
! Cyan
XTerm.vt100.color14:             #93a1a1
! White
XTerm.vt100.color15:             #fdf6e3
</pre>

<p>
Then, finally the lines for font configuration. Here I just using
DejaVu Sans Mono font with 8 size:
</p>

<pre class="example">
!
! Fonts:
!
XTerm.vt100.faceName:            xft:DejaVu Sans Mono:style=Book:antialias=true:autohint=false
XTerm.vt100.faceSize:            8
XTerm.vt100.fontWarnings:        2
XTerm.vt100.initialFont:         DejaVu Serif
XTerm.vt100.renderFont:          true
</pre>

<p>
The result looks like this:
</p>


<div class="figure">
<p><img src="/assets/static/x-XTerm-1.png" alt="XTerm window with fortune and ls output." align="center" width="90%" />
</p>
</div>


<div class="figure">
<p><img src="/assets/static/x-XTerm-2.png" alt="XTerm window with `make configure' for editors/emacs FreeBSD port." align="center" width="90%" />
</p>
</div>
</div>
</div>
<div id="outline-container-xdm" class="outline-2">
<h2 id="xdm">Display manager (XDM)</h2>
<div class="outline-text-2" id="text-xdm">
<p>
The <a href="https://www.x.org/releases/X11R7.6/doc/man/man1/xdm.1.xhtml">XDM</a> (X display manager) just exists. It depends only on X11
libraries and XSM (X session manager) which depends only on X11
libraries too.
</p>

<p>
Goodbye <a href="https://github.com/canonical/lightdm">LightDM</a>, you bring too many unwanted dependencies to my
system:
</p>

<pre class="example">
~ λ pkg info -d lightdm
lightdm-1.32.0_7:
    libxklavier-5.3_4,1
    libxcb-1.17.0
    libXdmcp-1.1.5
    libX11-1.8.12,1
    consolekit2-1.2.6_5
    accountsservice-23.13.9_3
    libgcrypt-1.11.1
    glib-2.84.1_2,2
    gettext-runtime-0.23.1
~ λ pkg info -d accountsservice
accountsservice-23.13.9_3:
    libxslt-1.1.43_1
    libxml2-2.14.5
    polkit-125_1
    consolekit2-1.2.6_5
    glib-2.84.1_2,2
    gettext-runtime-0.23.1
~ λ pkg info -d consolekit2
consolekit2-1.2.6_5:
    libX11-1.8.12,1
    libxslt-1.1.43_1
    libxml2-2.14.5
    polkit-125_1
    libdrm-2.4.123,1
    libudev-devd-0.6.0
    libevdev-1.13.2
    glib-2.84.1_2,2
    gettext-runtime-0.23.1
    dbus-1.16.2_3,1
~ λ pkg info -d polkit
polkit-125_1:
    expat-2.7.1
    duktape-lib-2.7.0
    glib-2.84.1_2,2
    gettext-runtime-0.23.1
    dbus-1.16.2_3,1
</pre>

<p>
The XDM installation was simple:
</p>
<ol class="org-ol">
<li><code>doas pkg install xdm</code></li>
<li><p>
Added the line:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #0072d4;">xdm_enable</span>=<span style="color: #009c8f;">"YES"</span>
</pre>
</div>
<p>
to the <code>/etc/rc.conf</code>.
</p></li>
<li><p>
Issued the next commands:
</p>
<div class="org-src-container">
<pre class="src src-shell">chmod ug+x ~/.xinitrc
ln -s ~/.xinitrc ~/.xsession
</pre>
</div></li>
<li><p>
In the <code>~/.xinitrc</code> the first line should be <code>#!/bin/sh</code> and the last
line should execute the desired WM as usual:
</p>
<pre class="example">
. ~/.profile
exec /usr/local/bin/stumpwm
</pre>
<p>
Also, I instruct X server to read and execute the <code>~/.profile</code> file,
because it has some environment variables valuable for StumpWM
(<code>SBCL_HOME</code> and <code>ASDF_DATA_DIR</code>).
</p></li>
</ol>

<p>
Then, I slightly configured XDM to match with my preferences. First, I
disabled XConsole startup, which shows kernel messages in my X
session — I just opened the <code>/usr/local/etc/X11/xdm/Xsetup_0</code> file and
removed this line from it:
</p>

<div class="org-src-container">
<pre class="src src-shell">xconsole -geometry 480x130-0-0 -daemon -notify -verbose -fn fixed -exitOnFail
</pre>
</div>

<p>
After careful reading of <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=8&amp;format=html">man 8 xdm</a>, I changed some X resources for XDM
in the <code>/usr/local/etc/X11/xdm/Xresources</code> file — setup Solarized Light
colors in the login window:
</p>

<pre class="example">
xlogin*shdColor:   #073642
xlogin*hiColor:    #002b36
xlogin*background: #fdf6e3
xlogin*inpColor:   #eee8d5
xlogin*greetColor: #268bd2
xlogin*failColor:  #dc322f
*Foreground:       #002b36
*Background:       #fdf6e3
</pre>

<p>
Use classic X cursor (a black one):
</p>

<pre class="example">
Xcursor.theme: hicolor
</pre>

<p>
Change a password prompt so input boxes for login and for password now
using the same width:
</p>

<pre class="example">
xlogin*namePrompt: \040\040\040\040\040\040\040Login:
xlogin*passwdPrompt: \040\040\040\040Password:
</pre>

<p>
Use DejaVu Serif fonts (will work if XDM was compiled with XFT
support):
</p>

<pre class="example">
xlogin*greetFace:	DejaVu Serif-24:bold:italic
xlogin*face: 		DejaVu Serif-18
xlogin*promptFace: 	DejaVu Serif-18:bold
xlogin*failFace: 	DejaVu Serif-18:bold
</pre>

<p>
Disallowed root login and passwordless logins, also echo <code>6</code> symbol when
I type password (for fun):
</p>

<pre class="example">
xlogin*Login*allowRootLogin:  false
xlogin*Login*allowNullPasswd: false
xlogin*Login*echoPasswd:      true
xlogin*Login*echoPasswdChar:  6
</pre>

<p>
I didn't cover XSM (X Session Manager) setup in this section because I
never used this function and don't know how it can be helpful for me —
all two programs, which should save the state (Emacs and Librewolf)
able to do it with it's internal mechanisms.
</p>
</div>
<div id="outline-container-xdm-tumfatig" class="outline-3">
<h3 id="xdm-tumfatig">Update 2025-10-20:</h3>
<div class="outline-text-3" id="text-xdm-tumfatig">
<p>
I recommend to read <a href="https://www.tumfatig.net/2019/customizing-openbsd-xenodm/">this wonderful blogpost</a> from TuM'Fatig about
ricing the <code>xdm</code>. This blogpost about <code>xenodm</code> in OpenBSD, which is
shipped with X-server's fork Xenocara. But the same techniques could
be applied to the <code>xdm</code> itself.
</p>
</div>
</div>
<div id="outline-container-xdm-startup" class="outline-3">
<h3 id="xdm-startup">Update 2025-12-13 (xdm startup):</h3>
<div class="outline-text-3" id="text-xdm-startup">
<p>
The way to enable XDM via the <code>/etc/rc.conf</code> looks like wrong, according
to the documentation and to the my experience as well. Yes, the XDM
will start this way, but (at least in the FreeBSD 14.3-p6) it will put
a lot of garbage strings to the 1st text console and the <i>Ctrl+Alt+Fn</i>
keys will not switch from X to the text terminal.
</p>

<p>
The right way to start XDM is to add this line to the <code>/etc/ttys</code>:
</p>
<pre class="example">
ttyv7	"/usr/local/bin/xdm -nodaemon"	xterm	on secure
</pre>
</div>
</div>
</div>
<div id="outline-container-xdg-utils" class="outline-2">
<h2 id="xdg-utils">Xdg-utils</h2>
<div class="outline-text-2" id="text-xdg-utils">
<p>
There are set of utils exists, which used to simplify DE/WM and
different programs integration — the <a href="https://www.freedesktop.org/wiki/Software/xdg-utils/">xdg-utils</a>. For example, I could
open URL with my default browser from Emacs with <code>browse-url-xdg-open</code>
command. Or send e-mail with my preferred e-mail client using the
<code>xdg-email</code> console command.
</p>

<p>
It works the next way. First, the type of given <i>object</i> is determined:
</p>

<pre class="example">
~ λ xdg-mime query filetype .emacs.d
inode/directory
</pre>

<p>
Then the default application for computed type is called. E.g. in my
system the RawTherapee somehow set as a program to open directories:
</p>

<pre class="example">
~ λ xdg-mime query default inode/directory
rawtherapee.desktop
</pre>

<p>
So, when I click the button with folder icon in the list of downloaded
files in Librewolf — then the RawTherapee will be opened…
</p>

<p>
Of course, it is possible to setup things in the right way in my
minimalistic environment. So different programs will operate with each
other and I shouldn't install gigantic DEs to obtain the same level of
interoperability.
</p>
</div>
<div id="outline-container-xdg-utils-directory" class="outline-3">
<h3 id="xdg-utils-directory">Emacs Dired as a default file manager</h3>
<div class="outline-text-3" id="text-xdg-utils-directory">
<p>
For this topic I should write my own desktop entry to use EmacsClient
and Dired to view contents of given catalog.
</p>

<p>
The local <code>*.desktop</code> files lies in the <code>~/.local/share/applications/</code> and
I used them as a reference. As a result this
<code>~/.local/share/applications/dired.desktop</code> was created:
</p>

<pre class="example">
[Desktop Entry]
Hidden=false
Exec=/usr/local/bin/emacsclient -a= -c -s /var/run/drag0n/emacs/main -e '(dired "%f")'
Type=Application
NoDisplay=false
Terminal=false
Version=1.0
MimeType=inode/directory;
StartupNotify=true
StartupWMClass=Emacs
DBusActivatable=false
Categories=Development;TextEditor;
Terminal=false
Comment=Open directory
Name=Emacs (Dired)
GenericName=Dired
Icon=emacs
</pre>

<p>
And installed with this command:
</p>

<pre class="example">
~ λ xdg-mime default dired.desktop inode/directory
</pre>

<p>
Note that all MIME type(s), used with <code>xdg-mime</code> command here, should be
listed in the <code>MimeType</code> line in the <code>*.desktop</code> file. Different MIME
types should be divided with <code>;</code> symbol.
</p>

<p>
The result — when I trying to open the directory of downloaded file in
Librewolf then the new Emacs frame with Dired buffer with desired
directory will be opened:
</p>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/xdg-dired.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>
</div>
</div>
<div id="outline-container-xdg-utils-mail-agent" class="outline-3">
<h3 id="xdg-utils-mail-agent">Emacs Compose as a default mail agent</h3>
<div class="outline-text-3" id="text-xdg-utils-mail-agent">
<p>
The <code>/usr/local/share/applications/emacsclient-mail.desktop</code> file
already exists in my system, but it doesn't work well with my Emacs
setup. So I rewrite it. This is my <code>compose.desktop</code> contents:
</p>

<pre class="example">
[Desktop Entry]
Categories=Network;Email;
Comment=Compose e-mail in Emacs
Exec=/usr/local/bin/emacsclient -a= -c -s /var/run/drag0n/emacs/main -e "(message-mailto (pop server-eval-args-left))" %u
Icon=emacs
Name=Emacs (Mail, Client)
MimeType=x-scheme-handler/mailto;
NoDisplay=false
Terminal=false
Type=Application
Keywords=emacsclient;
StartupNotify=true
StartupWMClass=Emacs
DBusActivatable=false
</pre>

<p>
And the command to install it to use with <code>xdg-email</code>:
</p>

<pre class="example">
~ λ xdg-mime default compose.desktop x-scheme-handler/mailto
</pre>

<p>
How it works when I click on the e-mail link in the browser:
</p>

<p align="center">
    <video align="center" width="90%" height="auto" controls>
        <source src="/assets/static/xdg-email.mp4" type="video/mp4">
        Your browser doesn't support video tag.
    </video>
</p>
</div>
</div>
<div id="outline-container-xdg-utils-nsxiv" class="outline-3">
<h3 id="xdg-utils-nsxiv">nSxiv as a default image viewer</h3>
<div class="outline-text-3" id="text-xdg-utils-nsxiv">
<p>
The file <code>/usr/local/share/applications/nsxiv.desktop</code> already exists in
my system, so it was necessary to switch all listed MIME types to use
nsxiv:
</p>

<pre class="example">
~ λ xdg-mime default nsxiv.desktop image/bmp
~ λ xdg-mime default nsxiv.desktop image/gif
~ λ xdg-mime default nsxiv.desktop image/jpeg
~ λ xdg-mime default nsxiv.desktop image/jpg
~ λ xdg-mime default nsxiv.desktop image/png
~ λ xdg-mime default nsxiv.desktop image/tiff
~ λ xdg-mime default nsxiv.desktop image/x-bmp
~ λ xdg-mime default nsxiv.desktop image/x-portable-anymap
~ λ xdg-mime default nsxiv.desktop image/x-portable-bitmap
~ λ xdg-mime default nsxiv.desktop image/x-portable-graymap
~ λ xdg-mime default nsxiv.desktop image/x-tga
~ λ xdg-mime default nsxiv.desktop image/x-xpixmap
~ λ xdg-mime default nsxiv.desktop image/webp
</pre>

<p>
And that's all.
</p>
</div>
</div>
<div id="outline-container-xdg-utils-mpv" class="outline-3">
<h3 id="xdg-utils-mpv">MPV as a default video/audio player</h3>
<div class="outline-text-3" id="text-xdg-utils-mpv">
<p>
The same is true for MPV: the file
<code>/usr/local/share/applications/mpv.desktop</code> already exists. So I just
issued the next command:
</p>

<pre class="example">
~ λ xdg-mime default mpv.desktop 'extremely-big-list-of-mime-types-from-mentioned-desktop-file'
</pre>
</div>
</div>
<div id="outline-container-xdg-utils-editor" class="outline-3">
<h3 id="xdg-utils-editor">Emacs as a default editor for some files</h3>
<div class="outline-text-3" id="text-xdg-utils-editor">
<p>
The proper <code>emacsclient.desktop</code> already was installed in my system,
with the proper commandline arguments. So I just copy it's contents
here:
</p>

<pre class="example">
[Desktop Entry]
Hidden=false
Exec=/usr/local/bin/emacsclient -a= -c -s /var/run/drag0n/emacs/main
Icon=emacs
Type=Application
NoDisplay=false
Version=1.0
MimeType=text/english;text/plain;text/x-makefile;text/x-c++hdr;text/x-c++src;text/x-chdr;text/x-csrc;text/x-java;text/x-moc;text/x-pascal;text/x-tcl;text/x-tex;application/x-shellscript;text/x-c;text/x-c++;x-scheme-handler/org-protocol;
StartupNotify=true
StartupWMClass=Emacs
GenericName[en_US]=Text Editor
Comment=Edit text
DBusActivatable=false
Categories=Development;TextEditor;
Terminal=false
Name=Emacs (Client)
GenericName=Text Editor
Icon[en_US]=emacs
Name[en_US]=Emacs (Client)
Comment[en_US]=Edit text
</pre>
</div>
</div>
<div id="outline-container-xdg-utils-pdf" class="outline-3">
<h3 id="xdg-utils-pdf">Emacs PDF-tools as a default PDF viewer</h3>
<div class="outline-text-3" id="text-xdg-utils-pdf">
<p>
The PDF files have the next MIME:
</p>

<pre class="example">
~ λ xdg-mime query filetype ~/rsync/projects/thinkpad/12AH3_Fuse.pdf
application/pdf
</pre>

<p>
And for this MIME type the next <code>pdf-tools.desktop</code> file was created (it
opens the given PDF file with <code>find-file</code>, the Emacs will call the PDF
Tools by itself):
</p>

<pre class="example">
[Desktop Entry]
Hidden=false
Exec=/usr/local/bin/emacsclient -a= -c -s /var/run/drag0n/emacs/main %u
Type=Application
NoDisplay=false
Terminal=false
Version=1.0
MimeType=application/pdf;
StartupNotify=true
StartupWMClass=Emacs
DBusActivatable=false
Categories=Development;TextEditor;
Terminal=false
Comment=Open PDF
Name=Emacs (PDF Tools)
GenericName=PDF Tools
Icon=emacs
</pre>

<p>
This command necessary to use Emacs PDF Tools as a default PDF viewer:
</p>

<pre class="example">
~ λ xdg-mime default pdf-tools.desktop application/pdf
</pre>
</div>
</div>
</div>
<div id="outline-container-beauty" class="outline-2">
<h2 id="beauty">Beauty</h2>
<div class="outline-text-2" id="text-beauty">
<p>
I'll write about ricing the GUI applications at the end. I'm using the
<a href="https://ethanschoonover.com/solarized/">Solarized Light theme</a> almost everywhere<sup><a id="fnr.solarized-light" class="footref" href="#fn.solarized-light" role="doc-backlink">5</a></sup> — it is good
enough for my eyes (can't use dark themes without strain in my eyes).
So, here I'll describe how to make things nice with small X11
utilities and text editor.
</p>
</div>
<div id="outline-container-change-cursor-theme" class="outline-3">
<h3 id="change-cursor-theme">Changing the cursor theme</h3>
<div class="outline-text-3" id="text-change-cursor-theme">
<p>
I'm using the MacOS-inspired cursor from <a href="https://github.com/ful1e5/apple_cursor">here</a>:
</p>


<div class="figure">
<p><img src="/assets/static/macos-cursor.png" alt="Image with different MacOS cursors, taken from beforementioned link." align="center" width="90%" />
</p>
</div>

<p>
To use it system-wide the archive should be extracted to the <code>~/.icons/macos</code>
catalog:
</p>

<pre class="example">
~ λ ls ~/.icons/macos/
cursor.theme  cursors  index.theme
</pre>

<p>
Then the cursor should be added to the X resources. In my case the
<code>~/.Xresources.d/cursor</code> file was added and it's contents was merged to
the X resources database with <code>xrdb</code> utility:
</p>

<div class="org-src-container">
<pre class="src src-shell">xrdb -merge ~/.Xresources.d/cursor
</pre>
</div>

<p>
Or the more nice approach — there is a <code>~/.Xresources</code> file which
contains necessary include statement(s):
</p>

<pre class="example">
#include ".Xresources.d/cursor"
</pre>

<p>
And it is sourced with the next command:
</p>

<div class="org-src-container">
<pre class="src src-shell">xrdb -I$<span style="color: #0072d4;">HOME</span> ~/.Xresources
</pre>
</div>

<p>
The contents of the <code>~/.Xresources/cursor</code> file:
</p>

<pre class="example">
Xcursor.theme: macos
Xcursor.size: 32
</pre>

<p>
And after X server restart the MacOS cursor will be used in all GUI
applications: which use Qt graphical toolkit, GTK2 or GTK3 toolkit,
and the native X applications of course.
</p>

<p>
But … the Emacs doesn't respect all these settings🙁. Because:
</p>

<pre class="example">
GNU Emacs 30.1 (build 2, amd64-portbld-freebsd14.2, GTK+ Version 3.24.49, cairo version 1.18.2)
</pre>

<p>
And the configuration of GTK+ version 3 resources is full of <del>horrors</del>
CSS — while it is ok for me to tweak some CSS for my blog, then doing
the same only to use a proper cursor inside Emacs is not
ok<sup><a id="fnr.emacs-gtk-plus-resources" class="footref" href="#fn.emacs-gtk-plus-resources" role="doc-backlink">6</a></sup>:
</p>

<blockquote>
<p>
In GTK+ version 3, GTK+ resources have been replaced by a completely
different system. The appearance of GTK+ widgets is now determined by
CSS-like style files
</p>
</blockquote>

<p>
The solution I used — recompile Emacs with right options:
</p>


<div class="figure">
<p><img src="/assets/static/emacs-configuration.png" alt="Emacs build options from FreeBSD ports. The GTK 3 GUI toolkit is disabled and Athena is enabled." align="center" width="90%" />
</p>
<p class="fignum"><i>Athena toolkit is used instead of GTK3</i></p>
</div>
</div>
</div>
<div id="outline-container-gtk2-theme" class="outline-3">
<h3 id="gtk2-theme">GTK2 theme</h3>
<div class="outline-text-3" id="text-gtk2-theme">
<p>
I found Solarized Light theme for GTK2 here:
<a href="https://github.com/rtlewis88/rtl88-Themes/tree/Solarized-Light/Solarized-Light">https://github.com/rtlewis88/rtl88-Themes/tree/Solarized-Light/Solarized-Light</a>.
</p>

<p>
Installation is simple enough:
</p>
<ol class="org-ol">
<li>Clone repository</li>
<li>Checkout the <code>Solarized-Light</code> branch</li>
<li>Copy <code>Solarized-Light/</code> directory to the <code>~/.themes/</code></li>
<li><p>
Add or edit the next line in the <code>~/.gtkrc-2.0</code>:
</p>
<pre class="example">
gtk-theme-name = "Solarized-Light"
</pre></li>
<li>Install <code>gtk-murrine-engine</code> package.</li>
</ol>

<p>
Done!
</p>


<div class="figure">
<p><img src="/assets/static/gtk2-themed.png" alt="GTK 2 message box themed with Solarized Light" align="center" width="50%" />
</p>
<p class="fignum"><i>Themed GTK 2 message box</i></p>
</div>

<p>
Also I added the next lines to the <code>~/.gtkrc-2.0</code> to remove some
annoyances:
</p>

<pre class="example">
gtk-button-images = 0
gtk-menu-images = 0
gtk-cursor-blink = 1
gtk-application-prefer-dark-theme = 0
gtk-key-theme-name = "Emacs"
gtk-enable-event-sounds = 0
gtk-enable-input-feedback-sounds = 0
</pre>
</div>
<div id="outline-container-gtk2-vermaden-update" class="outline-4">
<h4 id="gtk2-vermaden-update">Update 2025-12-13 (hints from vermaden):</h4>
<div class="outline-text-4" id="text-gtk2-vermaden-update">
<p>
After reading <a href="https://vermaden.wordpress.com/2018/08/18/freebsd-desktop-part-15-configuration-fonts-frameworks/#:~:text=1-,GTK2">this section</a> in the Vermaden's blog, I've added the next
lines to the mine <code>~/.gtkrc-2.0</code>:
</p>
<pre class="example">
gtk-xft-antialias=1
gtk-xft-hinting=0
gtk-xft-hintstyle="hintnone"
gtk-xft-rgba="rgb"
</pre>
</div>
</div>
</div>
<div id="outline-container-gtk3-theme" class="outline-3">
<h3 id="gtk3-theme">GTK3 theme</h3>
<div class="outline-text-3" id="text-gtk3-theme">
<p>
Most of the necessary actions already done in the previous section. To
enable the same theme for the GTK3 application only the next steps are
necessary:
</p>

<ol class="org-ol">
<li>Open the <code>~/.config/gtk-3.0/settings.ini</code> file</li>
<li><p>
Add or edit the next line:
</p>
<pre class="example">
gtk-theme-name=Solarized-Light
</pre></li>
</ol>

<p>
Done!
</p>


<div class="figure">
<p><img src="/assets/static/gtk3-themed.png" alt="GTK 3 message box themed with Solarized Light" align="center" width="50%" />
</p>
<p class="fignum"><i>Themed GTK 3 message box</i></p>
</div>

<p>
Also I added the next lines like in the previous section:
</p>

<div class="org-src-container">
<pre class="src src-nil"><span class="linenr">1: </span>gtk-enable-animations=0
<span class="linenr">2: </span>gtk-application-prefer-dark-theme=false
<span class="linenr">3: </span>gtk-key-theme-name=Emacs
<span class="linenr">4: </span>gtk-overlay-scrolling=false
<span class="linenr">5: </span>gtk-menu-images=0
<span id="coderef-gtk3-remove-csd" class="coderef-off"><span class="linenr">6: </span>gtk-decoration-layout=menu:</span>
<span class="linenr">7: </span>gtk-enable-event-sounds=0
<span class="linenr">8: </span>gtk-enable-input-feedback-sounds=0
</pre>
</div>

<p>
On the line <a href="#coderef-gtk3-remove-csd" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-gtk3-remove-csd');" onmouseout="CodeHighlightOff(this, 'coderef-gtk3-remove-csd');">6</a> the I remove the Client Side Decorations
(CSD) from GTK 3 windows — an ugly thing which draws the window header
and minimize/maximize/close buttons, so the window decorations from WM
become duplicated. This line works with the next lines from
<code>~/.config/gtk-3.0/gtk.css</code>:
</p>

<div class="org-src-container">
<pre class="src src-css">.window-frame, .window-frame:backdrop {
    <span style="color: #489100; font-weight: bold;">box-shadow</span>: 0 0 0 <span style="color: #ffffff; background-color: #000000;">black</span>;
    <span style="color: #489100; font-weight: bold;">border-style</span>: none;
    <span style="color: #489100; font-weight: bold;">margin</span>: 0;
    <span style="color: #489100; font-weight: bold;">border-radius</span>: 0;
}

<span style="color: #0072d4;">.titlebar</span> {
    <span style="color: #489100; font-weight: bold;">border-radius</span>: 0;
}

<span style="color: #0072d4;">.window-frame.csd.popup</span> {
    <span style="color: #489100; font-weight: bold;">box-shadow</span>: 0 1px 2px <span style="color: #ffffff; background-color: #000000;">rgba(0, 0, 0, 0.2)</span>, 0 0 0 1px <span style="color: #ffffff; background-color: #000000;">rgba(0, 0, 0, 0.13)</span>;
}

<span style="color: #0072d4;">.header-bar</span> {
    <span style="color: #489100; font-weight: bold;">background-image</span>: none;
    <span style="color: #489100; font-weight: bold;">background-color</span>: <span style="color: #000000; background-color: #ededed;">#ededed</span>;
    <span style="color: #489100; font-weight: bold;">box-shadow</span>: none;
}

<span style="color: #0072d4;">GtkLabel.title</span> {
    <span style="color: #489100; font-weight: bold;">opacity</span>: 0;
}
</pre>
</div>

<p>
Also I recommend to use <a href="https://edugit.org/-/snippets/31">this hack</a> for GTK 3 applications to bring back
the normal scrolls, not that unbearable abomination invented by people
who never used the computer mouse in their life.
</p>

<p>
I've made some changes in the CSS file to use Solarized Light colors
and increase size of scrollbars, so they looks good on my hi-res
display. The diff file is <a href="/assets/static/gtk3-scrollbars-solarized-light-diff.txt">here</a> and the result looks like this:
</p>


<div class="figure">
<p><img src="/assets/static/gtk3-scrollbars-solarized-light.png" alt="The sample GTK3 application with a big text view and horizontal and vertical scrollbars in Windows 95 style." align="center" width="90%" />
</p>
<p class="fignum"><i>Text View⇒Automatic Scrolling application from gtk3-demo</i></p>
</div>
</div>
<div id="outline-container-gtk3-vermaden-update" class="outline-4">
<h4 id="gtk3-vermaden-update">Update 2025-12-13 (tweaks from vermaden blog):</h4>
<div class="outline-text-4" id="text-gtk3-vermaden-update">
<p>
After reading this section in the Vermaden's blog, I've added the next
lines to the mine <code>~/.config/gtk-3.0/settings.ini</code>:
</p>
<pre class="example">
gtk-xft-antialias       = 1
gtk-xft-hinting         = 0
gtk-xft-hintstyle       = hintnone
gtk-xft-rgba            = rgb
</pre>
</div>
</div>
<div id="outline-container-fonts-size-tweak" class="outline-4">
<h4 id="fonts-size-tweak">Update 2026-01-08</h4>
<div class="outline-text-4" id="text-fonts-size-tweak">
<p>
For proper font size on the HighDPI screen — if I set <i>Trebushet MS 9</i>,
I want to see letters the same size as in GTK2 or Qt applications, not
enormously small one. Sadly, the GTK3 has it's own mind about font
sizing when HighDPI screen is present.
</p>

<p>
BTW, I found the next hack in the Arch Wiki: just add two these
environment variables to the <code>~/.profile</code>:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #0072d4;">GDK_SCALE</span>=0.5
<span style="color: #53676d; font-weight: bold;">export</span> GDK_SCALE
<span style="color: #0072d4;">GDK_DPI_SCALE</span>=2
<span style="color: #53676d; font-weight: bold;">export</span> GDK_DPI_SCALE
</pre>
</div>

<p>
With them, the letters will have reasonable size and the GUI size
willn't have enormously big size.
</p>
</div>
</div>
</div>
<div id="outline-container-gtk4-is-shit" class="outline-3">
<h3 id="gtk4-is-shit">GTK4 theme</h3>
<div class="outline-text-3" id="text-gtk4-is-shit">
<blockquote>
<p>
Lasciate ogne speranza, voi ch'intrate.
</p>

<p>
Abandon all hope, ye who enter here.
</p>

<p>
— Inferno, Dante.
</p>
</blockquote>

<p>
This <i>abomination</i> doesn't respect anything: the X resources, size of
display's active area, etc — it is all ignored.
</p>


<div class="figure">
<p><img src="/assets/static/gtk4-gajim.png" alt="Gajim main window" align="center" width="90%" />
</p>
<p class="fignum"><i>Gajim main window</i></p>
</div>

<p>
So, I don't use any GTK4 applications anymore.
</p>
</div>
</div>
<div id="outline-container-qt-theme" class="outline-3">
<h3 id="qt-theme">Qt 5 theme</h3>
<div class="outline-text-3" id="text-qt-theme">
<p>
Since GTK2 and GTK3 is successfully configured, I'm able to reuse it
look and feel in the Qt 5 applications. There are next steps
necessary:
</p>

<ol class="org-ol">
<li>Install <code>qt5-style-plugins</code> and <code>qt5ct</code> packages</li>
<li><p>
Set environment variable <code>QT_QPA_PLATFORMTHEME</code> in the <code>~/.profile</code>:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #0072d4;">QT_QPA_PLATFORMTHEME</span>=<span style="color: #009c8f;">"qt5ct"</span>
<span style="color: #53676d; font-weight: bold;">export</span> QT_QPA_PLATFORMTHEME
</pre>
</div></li>
<li>Relogin</li>
<li>Open <code>qt5ct</code> application</li>
<li>Change the next settings:
<ul class="org-ul">
<li>Style: gtk2</li>
<li>Standard dialogs: GTK2. With this setting the file open dialog
will look like in other programs.</li>
<li>Pallete: Default</li>
<li>Also I change fonts to my preferred DejaVu Serif and DejaVu Sans
Mono.</li>
</ul></li>
<li>Press OK.</li>
</ol>


<div class="figure">
<p><img src="/assets/static/qmapshack-themed.png" alt="QMapShack main window themed with Solarized Light" align="center" width="90%" />
</p>
<p class="fignum"><i>Styled QMapShack main window</i></p>
</div>
</div>
</div>
<div id="outline-container-qt6-theme" class="outline-3">
<h3 id="qt6-theme">Qt 6 theme</h3>
<div class="outline-text-3" id="text-qt6-theme">
<p>
The Qt 6 is an another beast. It could be configured in the same way
as the Qt 5, but devil is in details.
</p>

<p>
To configure look&amp;feel the <code>qt6ct</code> application exists. It isn't
necessary to change environment variable <code>QT_QPA_PLATFORMTHEME</code> from
<code>qt5ct</code> to <code>qt6ct</code> value — looks like the <code>qt6ct</code> application accepts both
values.
</p>

<p>
And in the FreeBSD packages there is an <code>qt6gtk2</code> package, which brings
previously configured GTK 2 theme for the Qt 6 programs. But, if you
try to select <code>qt6gtk2</code> style, then <code>qt6ct</code> simply crashes with
segmentation fault.
</p>

<p>
Luckily, I found a solution:
</p>
<ol class="org-ol">
<li>Temporarily unset <code>QT_QPA_PLATFORMTHEME</code> variable.</li>
<li>Launch <code>qt6ct</code>.</li>
<li>Select <code>qt6gtk2</code> theme.</li>
<li>Apply changes and close the program. Then, bring the
<code>QT_QPA_PLATFORMTHEME</code> back.</li>
</ol>

<p>
After this trick the Qt 6 application will use the same Solarized
Light theme as any other application in my system. With two unsolved
(for now) problems:
</p>
<ol class="org-ol">
<li><p>
The menu items are big. I'm not ranting, because it is good for me.
But I didn't find how to make them smaller if I need to.
</p>

<div class="figure">
<p><img src="/assets/static/qbittorrent.png" alt="Enormously big menus in the qBittorent (Qt 6)" align="center" width="90%" />
</p>
<p class="fignum"><i>Big menus in the qBittorrent (Qt 6)</i></p>
</div></li>
<li><p>
The buttons' icons (not in the toolbar!) are shifted outside of the
buttons' margins. So they looks like ugly:
</p>

<div class="figure">
<p><img src="/assets/static/qbittorrent-buttons.png" alt="Ugly buttons at the bottom in the qBittorrent (Qt 6)" align="center" width="90%" />
</p>
<p class="fignum"><i>Ugly buttons in the qBittorrent (Qt 6)</i></p>
</div></li>
</ol>

<p>
The second strange thing in Qt 6 — it ignores X server data about my
display physical size and resolution. So on the 2K 13" monitor all
things are very small by default. I found that to bring to desired
behaviour back — one tricky variable should be set in the <code>~/.profile</code>:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #909995;"># </span><span style="color: #909995;">To use data from X server configuration</span>
<span style="color: #909995;"># </span><span style="color: #909995;">and calculate DPI with them in Qt6 applications:</span>
<span style="color: #0072d4;">QT_USE_PHYSICAL_DPI</span>=1
<span style="color: #53676d; font-weight: bold;">export</span> QT_USE_PHYSICAL_DPI
</pre>
</div>

<p>
Done! After that Qt 6 applications will look like all other
applications in the system (almost).
</p>
</div>
</div>
<div id="outline-container-librewolf-theme" class="outline-3">
<h3 id="librewolf-theme">Librewolf theme</h3>
<div class="outline-text-3" id="text-librewolf-theme">
<p>
Luckily, Librewolf can use the system GTK theme. But the result wasn't
too <i>solarized</i> as I want:
</p>


<div class="figure">
<p><img src="/assets/static/librewolf-gtk-theme.png" alt="Librewolf main window styles as &quot;Solarized Light&quot; GTK theme" align="center" width="90%" />
</p>
</div>

<p>
So I started to use this Firefox theme:
<a href="https://addons.mozilla.org/en-US/firefox/addon/somehow-solarized-light/">https://addons.mozilla.org/en-US/firefox/addon/somehow-solarized-light/</a>.
</p>


<div class="figure">
<p><img src="/assets/static/librewolf-solarized-theme.png" alt="Librewolf main window with &quot;Solarized Light&quot; Firefox theme" align="center" width="90%" />
</p>
</div>
</div>
</div>
<div id="outline-container-fonts" class="outline-3">
<h3 id="fonts">Fonts</h3>
<div class="outline-text-3" id="text-fonts">
<p>
I prefer to use DejaVu fonts family, especially DejaVu Serif.
</p>

<p>
To start using these fonts I installed a <code>dejavu</code> package and added path
to installed fonts in the proper part of X server configuration, along
with paths to other fonts from my system:
</p>

<pre class="example">
Section "Module"
    Load "freetype"
EndSection

Section "Files"
    FontPath "/usr/local/share/fonts/dejavu/"
    FontPath "/usr/local/share/fonts/bitstream-vera/"
    FontPath "/usr/local/share/fonts/inconsolata-ttf/"
    FontPath "/usr/local/share/fonts/Liberation/"
    FontPath "/usr/local/share/fonts/webfonts/"
    FontPath "/usr/local/share/fonts/twemoji-color-font-ttf/"
EndSection
</pre>

<p>
Module <code>freetype</code> here is necessary to use TrueType fonts. According to
FreeBSD handbook (section <a href="https://docs.freebsd.org/en/books/handbook/x11/#truetype">5.6.1. TrueType® Fonts</a>) it is more
consistent than other similar modules.
</p>

<p>
There are some tricks for fonts look&amp;feel available — for applications
using the Xft library (most of the applications now, according to the
<a href="https://docs.freebsd.org/en/books/handbook/x11/#antialias">5.6.3. Anti-Aliased Fonts</a> section in the FreeBSD handbook). Some of
them I enabled globally by going to the <code>/usr/local/etc/fonts/conf.d</code>
and making some symlinks to desired settings along with removing
symlinks to conflicting settings:
</p>

<pre class="example">
ln -s ../conf.avail/10-hinting-none.conf
ln -s ../conf.avail/10-unhinted.conf
ln -s ../conf.avail/10-sub-pixel-rgb.conf
ln -s ../conf.avail/11-lcdfilter-default.conf
</pre>

<p>
Same settings can be enabled per-user by using these Xresources with
<code>xrdb</code>:
</p>

<pre class="example">
Xft.rgba:       rgb
Xft.hinting:    0
Xft.antialias:  1
Xft.hintstyle:  hintnone
Xft.lcdfilter:  lcddefault
Xft.autohint:   0
</pre>

<p>
DejaVu font(s) for frameworks were set via <code>gtk-font-name</code> option in the
<code>~/.gtkrc-2.0</code>, and <code>~/.config/gtk-3.0/settings.ini</code>, and via <code>qt5ct</code>
configurator:
</p>

<div class="org-src-container">
<label class="org-src-name">~/.gtkrc-2.0</label><pre class="src src-nil">gtk-font-name = "DejaVu Serif Book 10"
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name">~/.config/gtk-3.0/settings.ini</label><pre class="src src-nil">gtk-font-name=DejaVu Serif Book 16
</pre>
</div>

<p>
Also, for some applicatons (Emacs and Librewolf) I changed the using
fonts via it's own settings.
</p>
</div>
<div id="outline-container-fonts-vermaden" class="outline-4">
<h4 id="fonts-vermaden">Update 2025-12-13 (fonts changed):</h4>
<div class="outline-text-4" id="text-fonts-vermaden">
<p>
I found this brilliant blogpost of vermaden about fonts configuration
for X11: <a href="https://vermaden.wordpress.com/2018/08/18/freebsd-desktop-part-15-configuration-fonts-frameworks/">"FreeBSD Desktop – Part 15 – Configuration – Fonts &amp;
Frameworks"</a>. So, my favourite fonts and it's configuration are
slightly changed:
</p>


<div class="figure">
<p><img src="/assets/static/x-fonts-dejavu.png" alt="My desktop with Emacs and XTerm alongside. The used fonts are DejaVu Serif and DejaVu Sans Mono." align="center" width="100%" />
</p>
<p class="fignum"><i>My previously used fonts: DejaVu Serif and DejaVu Sans Mono</i></p>
</div>


<div class="figure">
<p><img src="/assets/static/x-fonts-ibm-plex-trebuchet-ms.png" alt="My desktop with XTerm and Emacs alongside. The used fonts are IBM Plex and Trebuchet MS." align="center" width="100%" />
</p>
<p class="fignum"><i>But for now I'm using IBM Plex Mono and Trebuchet MS fonts</i></p>
</div>

<p>
I heavily recommend read this blogpost for a lot of good advices about
fonts (and <code>fontconfig</code>) setup for FreeBSD.
</p>
</div>
</div>
</div>
<div id="outline-container-icons" class="outline-3">
<h3 id="icons">Icons</h3>
<div class="outline-text-3" id="text-icons">
<p>
I use the "Solarized-Deluxe-iconpack" from the same <a href="https://github.com/rtlewis88/rtl88-Themes/tree/Solarized-Light">rtl88-Themes</a>
repository where I got the GTK2 and GTK3 themes.
</p>

<p>
To install them I just copied the <code>./Solarized-Deluxe-iconpack</code> catalog
to the <code>~/.icons/</code> with <code>cp -R</code> option to avoid problems with symlinks,
followed by the <code>find ~/.icons/Solarized-Deluxe-iconpack/ -type f -exec
chmod -v 644 {} \;</code> command because some files from the repo has the
wrong 755 mode.
</p>

<p>
And enabled these icons for GTK 2 in the <code>~/.gtkrc-2.0</code>:
</p>

<pre class="example">
gtk-icon-theme-name = "Solarized-Deluxe-iconpack"
</pre>

<p>
And for GTK 3 in the <code>~/.config/gtk-3.0/settings.ini</code>:
</p>

<pre class="example">
gtk-icon-theme-name=Solarized-Deluxe-iconpack
</pre>

<p>
For Qt the icons could be selected via the <code>qt5ct</code> program.
</p>

<p>
The result in the "Select file" dialog will look like this:
</p>


<div class="figure">
<p><img src="/assets/static/iconized-dialog.png" alt="Solarized Light icons in the file dialog" align="center" width="50%" />
</p>
<p class="fignum"><i>Solarized Light icons in the file dialog</i></p>
</div>
</div>
</div>
</div>
<div id="outline-container-notes" class="outline-2">
<h2 id="notes">Notes</h2>
<div class="outline-text-2" id="text-notes">
</div>
</div>
<div id="footnotes">

<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.xkb" class="footnum" href="#fnr.xkb" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
See the next links:
<a href="https://en.wikipedia.org/wiki/X_keyboard_extension">https://en.wikipedia.org/wiki/X_keyboard_extension</a>, and
<a href="https://www.x.org/wiki/XKB/">https://www.x.org/wiki/XKB/</a>, and
<a href="https://web.archive.org/web/20190324055556/http://pascal.tsu.ru/en/xkb/setup.html">https://web.archive.org/web/20190324055556/http://pascal.tsu.ru/en/xkb/setup.html</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.compositing-manager" class="footnum" href="#fnr.compositing-manager" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://en.wikipedia.org/wiki/Compositing_manager">https://en.wikipedia.org/wiki/Compositing_manager</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.screenrecord" class="footnum" href="#fnr.screenrecord" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Screenrecords were made with FFmpeg with the next
command:
</p>

<pre class="example">
ffmpeg -video_size 2560x1440 -framerate 60 -f x11grab -i :0 -c:v libx264rgb -crf 0 -preset ultrafast -color_range 2 filename.mkv
</pre>

<p class="footpara">
Then, I scaled the video to the 1200x675 resolution:
</p>

<pre class="example">
ffmpeg -i filename.mkv -vf scale=1200:-1 filename_scaled.mkv
</pre>

<p class="footpara">
And recoded the video to reduce it's size:
</p>

<pre class="example">
ffmpeg -i filename_scaled.mkv -vcodec libx265 -crf 28 filename_encoded.mp4
</pre>

<p class="footpara">
Sizes of resulting files:
</p>

<pre class="example">
-rw-r--r--   1 drag0n         drag0n    23M 2025-07-22 11:22 filename.mkv
-rw-r--r--   1 drag0n         drag0n   836k 2025-07-22 11:30 filename_scaled.mkv
-rw-r--r--   1 drag0n         drag0n    637k 2025-07-22 11:39 filename_encoded.mp4
</pre>

<p class="footpara">
Used resources:
</p>
<ul class="org-ul">
<li><a href="https://trac.ffmpeg.org/wiki/Capture/Desktop">https://trac.ffmpeg.org/wiki/Capture/Desktop</a></li>
<li><a href="https://trac.ffmpeg.org/wiki/Scaling">https://trac.ffmpeg.org/wiki/Scaling</a></li>
<li><a href="https://linuxhint.com/how-reduce-video-size-with-ffmpeg/">https://linuxhint.com/how-reduce-video-size-with-ffmpeg/</a></li>
</ul></div></div>

<div class="footdef"><sup><a id="fn.lvds" class="footnum" href="#fnr.lvds" role="doc-backlink">4</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://en.wikipedia.org/wiki/Low-voltage_differential_signaling">https://en.wikipedia.org/wiki/Low-voltage_differential_signaling</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.solarized-light" class="footnum" href="#fnr.solarized-light" role="doc-backlink">5</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Maybe there is a better and nicer theme exists. But
I'm too lazy to search for new favourite color theme.
</p></div></div>

<div class="footdef"><sup><a id="fn.emacs-gtk-plus-resources" class="footnum" href="#fnr.emacs-gtk-plus-resources" role="doc-backlink">6</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/GTK-resources.html">https://www.gnu.org/software/emacs/manual/html_node/emacs/GTK-resources.html</a>
</p></div></div>


</div>
</div>