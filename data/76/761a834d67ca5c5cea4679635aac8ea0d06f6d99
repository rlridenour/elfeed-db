<p>
Wait! What? I&rsquo;ve been programming most of my life and have a PhD in Mathematics but I&rsquo;ve never seen <a href="https://hueffner.de/falk/blog/a-leap-year-check-in-three-instructions.html">this</a> before. It&rsquo;s about checking for a leap year. The first thing we all learn is that it&rsquo;s a leap year if it&rsquo;s divisible by 4 but that&rsquo;s not quite right. It&rsquo;s a bit more complicated. The usual check is something like
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">is_a_leap_year</span>( <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span> )
{
    <span style="color: #a020f0;">if</span> ( ( y % 4 ) != 0 ) <span style="color: #a020f0;">return</span> 0;
    <span style="color: #a020f0;">if</span> ( ( y % 100 ) != 0 ) <span style="color: #a020f0;">return</span> 1;
    <span style="color: #a020f0;">if</span> ( ( y % 400 ) == 0 ) <span style="color: #a020f0;">return</span> 1;
    <span style="color: #a020f0;">return</span> 0;
}    
</pre>
</div>
<p>
Code like that has been written thousands (millions?) of times in just about every language there is.
</p>
<p>
What to make of this, then?
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">is_a_leap_year</span>( <span style="color: #228b22;">int</span> <span style="color: #a0522d;">y</span> )
{
    <span style="color: #a020f0;">return</span> ( ( y * 1073750999 ) &amp; 3221352463 ) &lt;= 126976;
}
</pre>
</div>
<p>
According to the link, you can make this check in 3 CPU instructions. It seems like magic but there&rsquo;s a pretty good explanation of how it works at the link. Oddly enough, it&rsquo;s a pretty direct translation of the normal check. Again, see the link for the details.
</p>
<p>
Checking for a leap year is not something you usually do in a loop—although it&rsquo;s easy enough to imagine cases where you would—so it&rsquo;s probably not a worthwhile project to replace your leap year checks with this code. Nonetheless, you have to love it if only as a curiosity.
</p>
<p>
Of course, if you&rsquo;re one of those people who obsess about squeezing every cycle out of your code—I was like that when I was younger—this may seem like gold to you. If nothing else, it will confound and amaze your colleagues.</p>
