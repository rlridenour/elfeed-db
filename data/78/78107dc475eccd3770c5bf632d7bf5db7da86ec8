<p><code>org-mode</code> files can be used for any kind of outline, including makeshift calendars and makeshift address books.</p>

<p>To make this work with <code>org-capture</code> to insert a new thing into such files, which always just appends, you can auto-sort a file e.g. before saving. That guarantees that the file is in a consistent state (sorted alphabetically) without you having to be clever about finding the corrent insertion point.</p>

<p>With Emacs, you can create file-local variables to set a <code>before-save-hook</code> (which usually is <code>nil</code>, so you don’t lose anything) to keep an <code>org-mode</code> file sorted at all times automatically, so there’s not much you need to do!</p>

<p>Create a file with this content to test:</p>

<pre><code class="language-org"># -*- before-save-hook: (my/org-sort); -*-

* Z
* B
* A
* D
* C
</code></pre>

<p>Then evaluate this snippet to add the function that accomplishes alphabetical sorting:</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">my/org-sort</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">mark-whole-buffer</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">org-sort-entries</span> <span class="no">nil</span> <span class="nv">?a</span><span class="p">))</span>
</code></pre></div></div>

<p>Now when you have <code>my/org-sort</code> in your Emacs Lisp environment, reload the file so that it asks whether you want to apply any local variables. Confirm. Then edit it and save.</p>

<p>Expected output, in case you’re not sure:</p>

<pre><code class="language-org"># -*- before-save-hook: (my/org-sort); -*-

* A
* B
* C
* D
* Z
</code></pre>

<p>Now if you need more complex sorting, you can implement a sort function that does whatever you need to accomplish based on the transformation of an unsorted buffer into a sorted one. The setup remains equally simple. You still don’t need to tweak the <code>org-capture</code> insertion point.</p>

<p>That’s the power of robust (and idempotent, in case of already sorted) algorithms for you.</p>
<hr><p><small><a href="https://christiantietze.de/hire-me/">Hire me</a> for freelance macOS/iOS work and consulting.</small></p><p><small><a href="https://christiantietze.de/apps/">Buy</a> my apps.</small></p><p><small><a href="https://christiantietze.de/newsletter/">Receive</a> new posts via email.</small></p>