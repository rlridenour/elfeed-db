
	
<p>
<a href="https://dx.doi.org/10.1201/9781003326977-2">The second chapter</a> of <em>Data Science for Water Utilities</em> introduces the basic principles of the R language and RStudio to analyse and visualise data. Writing code is not only about using the correct syntax and the appropriate functions; this chapter also covers some issues regarding styling your code, making it easy to understand. This chapter concludes with a case study to measure water flow in an open channel using the Kindsvater-Carter formula. The learning objectives for this chapter are:</p>
<ul>
<li>Install R and RStudio and identify the different parts of the RStudio screen.</li>
<li>Understand the principles of writing code to analyse data.</li>
<li>Apply R code to solve a simple water problem.


   <div class="box">
     <div class="media">
       <figure class="media-left">
         <p class="image is-128x128">
           <img src="https://lucidmanager.org/images/books/2023_ds4wu.jpg" alt = "Data Science for Water Utilities" title = "Data Science for Water Utilities">
         </p>
       </figure>
       <div class="media-content">
         <div class="content">
           <p class="is-size-5 has-text-weight-bold">Data Science for Water Utilities</p>
           <p class="mb-2">Data Science for Water Utilities published by CRC Press is an applied, practical guide that shows water professionals how to use data science to solve urban water management problems using the R language for statistical computing.</p>
           <div class="buttons">
             <a class="button is-info" href="https://routledge.com/9781032354545" target="_blank">
               <span class="icon">
                 <i class="fas fa-shopping-cart"></i>
               </span>
               <span>Routledge</span>
             </a>
             <a class="button is-info" href="https://www.amazon.com/Data-Science-Water-Utilities-Chapman/dp/1032354550" target="_blank">
               <span class="icon">
                 <i class="fas fa-shopping-cart"></i>
               </span>
               <span>Amazon</span>
             </a>
           </div>
         </div>
       </div>
     </div>
   </div>
</li>
</ul>
<p>The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Installing R and Rstudio
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The best way to use R is through an <em>Integrated Development Environment</em> (IDE). This type of software helps you to write and manage code. An IDE typically comprises a source code editor, automation tools, and functionality to simplify crafting and running code. Of course, you can use R without the IDE, but it will be less user-friendly.</p>
<p>
Several IDEs are available to help you write R code. RStudio by Posit is the most popular option.</p>
<p>
This software is also an open-source project, with free and paid versions for companies that want to use advanced features and support services. RStudio can also work with other languages, such as SQL and Python. Follow these steps to install the required software:</p>
<ol>
<li>Go to the R Project website: <a href="https://cran.r-project.org/">cran.r-project.org</a></li>
<li>Download the base version for your operating system and install the software</li>
<li>Go to the download page on the RStudio website: <a href="https://posit.co/download/rstudio-desktop/">posit.co</a></li>
<li>Download the installer for the free desktop version and install the software</li>
</ol>
<p>Alternatively, you can sign up for a free and fully featured account to access RStudio’s cloud version (<a href="https://posit.cloud/">posit.cloud</a>). This service gives you full access to R and RStudio in your browser without installing software. The free version provides enough hours of computing time to work through this book. You’ll have to pay for a subscription or install the desktop version if you need more time.</p>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/rstudio.jpg" alt="The RStudio IDE interface" title="The RStudio IDE interface"/>
<figcaption>
The RStudio IDE interface.
</figcaption>
</figure>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
Other R IDEs
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<ul>
<li><a href="https://microsoft.github.io/RTVS-docs/installation.html">R Tools for Visual Studio</a>: Microsoft’s development environment.</li>
<li><a href="https://rattle.togaware.com/">Rattle</a> is a popular graphical user interface for data mining in the R programming language.</li>
<li><a href="https://ess.r-project.org/">Emacs Speaks Statistics</a>: For advanced computer users.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Principles of Writing Code
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>Writing code has a steep learning curve and can be both frustrating and rewarding at the same time. Here are some principles that will help you write good code that is easy to understand:</p>
<ol>
<li>Use descriptive variable names. Don’t, for example, use <code class="verbatim">d</code>, but <code class="verbatim">pipe-diameter</code> or another descriptive name.</li>
<li>Add plenty of whitespace in your code.</li>
<li>Use comments starting with a hashtag: <code class="verbatim">#</code> (comments are not evaluated)</li>
<li>Follow a coding style guide, for example, the <a href="https://style.tidyverse.org/">Tidyverse Style Guide</a>.</li>
</ol>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/r-learning-curve.jpg" alt="The R Learning Curve can be steep and full of surprises" title="The R Learning Curve can be steep and full of surprises" width="400"/>
<figcaption>
The R Learning Curve can be steep and full of surprises.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
R is Meme Proof
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>The basic arithmetic in the R language follows the BODMAS rules (Brackets, Order, Division, Multiplication, Addition, and Subtraction). R is thus meme-proof and can solve the silly mathematical ‘challenges’ spread on social media.</p>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/memes.jpg" alt="R is meme-proof and can solve arithmetic challenges" title="R is meme-proof and can solve arithmetic challenges" width="200"/>
<figcaption>
R is meme-proof and can solve arithmetic challenges.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Channel Flow Case Study
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>Determining the flow in an open channel is usually achieved by measuring the water depth through a section with a known shape. Forcing the water through a given shape over a sharp weir creates a boundary condition that allows us to calculate the flow. A mathematical relationship determines the volume of water that passes through the channel. This case study uses a rectangular weir. A simplified version of the Kindsvater-Carter formula:</p>
<p>
$$Q = \frac{2}{3} C_d \sqrt{2g} \\ bh^{\frac{3}{2}}$$</p>
<ul>
<li>$Q$: Flow rate ($m^3/s$)</li>
<li>$C_d$ : Discharge coefficient</li>
<li>$g$: Gravitational acceleration (9.81 $m/s^2$ )</li>
<li>$b$: Measured width of the notch [$m$]</li>
<li>$h$: Upstream head above crest level [$m$]</li>
</ul>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/rectangular-weir.png" alt="Rectangular weir" title="Rectangular weir" width="400"/>
<figcaption>
Rectangular weir.
</figcaption>
</figure>
<p>
Questions:</p>
<ul>
<li>What is the flow in $m^3/s$ when $h=100$</li>
<li>What is the average flow when the level above the weir is 150, 136 and 75mm? </li>
</ul>
</div>
</div>
<div id="outline-container-headline-6" class="outline-2">
<h2 id="headline-6">
Cheat Sheet
</h2>
<div id="outline-text-headline-6" class="outline-text-2">
<p>To help you remember the various functions discussed in the first five chapters of the book, a <a href="https://lucidmanager.org/pdf/r4h2o-cheat-sheet.pdf">cheat sheet</a> is available.</p>
<figure>
<img src="https://lucidmanager.org/images/r4h2o/r4h2o-cheat-sheet.jpg" alt="R4H2O Cheat Sheet" title="R4H2O Cheat Sheet" width="400"/>
<figcaption>
Data Science for Water Utilities Cheat Sheet.
</figcaption>
</figure>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
Basics of the R Language Screencast 
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p>Chapter two of <em>Data Science for Water Utilities</em> explains the principles of writing code to analyse data in more detail. This screencast runs through the code in this chapter.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/iYO7rbAeatU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Basics of the R Language.
</figcaption>
</figure>
<p>
 The data and code used in this chapter are available on GitHub:</p>
<p>
<a href = "https://github.com/pprevos/r4h2o/" target="_blank"
   title="Download r4h2o from GitHub"
   alt="Download r4h2o from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">r4h2o</span>
  </button>
</a>

</p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-2">
<h2 id="headline-8">
Additional Resources
</h2>
<div id="outline-text-headline-8" class="outline-text-2">
<p>To help you remember the various functions discussed in the first five chapters of the book, a <a href="https://lucidmanager.org/pdf/r4h2o-cheat-sheet.pdf">cheat sheet</a> is available.</p>
<p>
<a href="https://lucidmanager.org/tags/project-euler/">Project Euler</a> provides an excellent way to practice solving basic mathematical methods in the R language.</p>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
Other Chapters
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p><a href="https://lucidmanager.org/data-science/r-for-water-utilities/">Previous Chapter</a>: <em>Introduction to Data Science for Water Utilities</em></p>
<p>
<a href="https://lucidmanager.org/data-science/loading-and-exploring-water-quality-data/">Next Chapter</a>: <em>Loading and Exploring Water Quality Data</em></p>
<p>
Feel free to <a href="https://lucidmanager.org/contact/">contact me</a> if you have any comments, suggestions or questions about this book.</p>
</div>
</div>
</div>
</div>

      