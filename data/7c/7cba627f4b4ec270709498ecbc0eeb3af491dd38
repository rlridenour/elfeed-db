<p>I recently reinstalled my laptop and copied across my git repositories from an external backup drive.  However most of my repositories were flagged by <code>magit</code> as having been <em>updated</em> mainly with the following issue on multiple files:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">old mode 100644
new mode 100755
</code></pre><p>I found a fix for a single repository on <code>stackoverflow</code> but I have quite a few repositories now, so I wrote the following bash script borrowing the core git diff command fix and then ran it in <code>eshell</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>LIST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;DCIM/Art/Content/ArtAssets
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/Art/Content/ArtRage
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/Art/Content/ArtRagePenTool
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/Art/Content/ArtRageTabletFriend
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/Art/Content/InfinitePainter
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/Art/Content/Krita
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  DCIM/content
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  bin
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  publish&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item in $LIST; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>   echo $item
</span></span><span style="display:flex;"><span>   cd ~/$item
</span></span><span style="display:flex;"><span>   git diff -p -R --no-ext-diff --no-color <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>      | grep -E <span style="color:#e6db74">&#34;^(diff|(old|new) mode)&#34;</span> --color<span style="color:#f92672">=</span>never <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>      | git apply
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><p>This is where the integrated nature of emacs can come in useful, although the <code>stackoverflow</code> example was the git diff line I wanted to perform this for each of my repositories and to achieve this I just simply grabbed the Path column output of <code>magit-list-repositories</code> using <code>rectangle-mark-mode</code> and trimmed down using some macros so I could iterate through each repository directory and run the command each time to clean up.</p>
<figure class="emacs-img"><img src="https://emacs.dyerdwelling.family/ox-hugo/20230617200412-emacs--Revert-Git-Permission-Changes-On-Transfer.jpg">
</figure>