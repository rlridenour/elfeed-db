<p>I have been delving into the nuts and bolts of the <strong>Sway window manager</strong> lately and especially its fork <strong>SwayFX</strong> which adds a little eye candy in the style of <strong>Hyprland</strong>.</p>
<p>This has led to lots of sway config file editing and hence trying to work out the best way in emacs to work with them.</p>
<p>By default a typical sway/config file has its own configuration format and emacs tries its best to figure out which best mode to use and settles on <code>conf-space-mode</code>.  This is a basic starter mode for a config that is space separated and gives me a rudimentary level of highlighting, for example :</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/2023-10-22-20-14-13.jpg" width="100%">
</figure>

<p>I would like indentation to be a little more intelligent and currently this mode applies an ever increasing indent but I shall figure that out at a later date.</p>
<p>I was generally not unhappy with <code>conf-space-mode</code> as it gave me a rudimentary keyword form of highlighting and typically as a sway configuration file doesn&rsquo;t need to be particularly structured I wasn&rsquo;t ever really indenting anyway, but lets see if I can improve the syntax highlighting.</p>
<p>The first port of call is <code>list-packages</code> and searching for <code>sway</code>:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">sway - Communication with the Sway window manager
sway-lang-mode - Major mode for sway
</code></pre><p>Unfortunately both don&rsquo;t suit my use case and in fact the second is for the sway programming language of which this is not!.</p>
<p>Well how about <code>treesitter</code>?, a big hard nope for this as well.</p>
<p>Next up is a little ace up my sleeve and one that continues to prove advantageous when working with the Sway tiling manager.  It is the fact that SwayWM is a drop in replacement for i3wm.  Well if the sway config files are of the same format as i3 config files then surely I can use some kind of i3 emacs mode? and so it proved to be the case!</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">i3wm-config-mode - Better syntax highlighting for i3wm&#39;s config file
</code></pre><p>Explicitly running this mode gives me:</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/2023-10-22-20-32-51.jpg" width="100%">
</figure>

<p>Much nicer! and comes with the following <code>auto-mode-alist</code> definition:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(<span style="color:#e6db74">&#34;i3/config\\&#39;&#34;</span> <span style="color:#f92672">.</span> i3wm-config-mode)
</span></span></code></pre></div><p>which of course requires a little adjustment to auto associate this new i3 mode with my sway files.  I came up with the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;/sway/.*config.*/&#34;</span> <span style="color:#f92672">.</span> i3wm-config-mode))
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;/sway/config\\&#39;&#34;</span> <span style="color:#f92672">.</span> i3wm-config-mode))
</span></span></code></pre></div><p>It took me a little while to figure out the <code>regex</code> as there are a few subtleties, for example it is recommended to always use <strong>\\&rsquo;</strong> rather than <strong>$</strong> to eliminate the confusion around new lines.</p>
<p>Note that I put an extra directory slash at the regex start to stop the mode being applied to any other potential directories that might end in <strong>sway</strong> which I feel might be a more common future occurrence than a config directory containing <strong>i3</strong>.</p>