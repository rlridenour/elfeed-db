<p>Just a quick one today.  One of the great strengths of Emacs is its extensibility, I have mentioned before in adding the ability to disk report on the size of a directory in <code>dired</code> but I thought I would quickly revisit the topic, demonstrating the function I currently use.</p>
<p>This functionality will allow you to run disk usage reports directly within Dired, using the <code>du -hc</code> command. This will make it easier to figure out how much space directories are taking up.</p>
<p>The aim of this function is to run the Linux command <code>du -hc</code> on the directory currently under the cursor in Dired mode. The command <code>du -hc</code> provides a human-readable summary of disk usage for the specified directory.</p>
<p>Here&rsquo;s the function that accomplishes this task:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(defun my/dired-du ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Run &#39;du -hc&#39; on the directory under the cursor in Dired.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (let ((current-dir (dired-get-file-for-visit)))
</span></span><span style="display:flex;"><span>    (if (<span style="color:#a6e22e">file-directory-p</span> current-dir)
</span></span><span style="display:flex;"><span>        (dired-do-async-shell-command <span style="color:#e6db74">&#34;du -hc&#34;</span> <span style="color:#66d9ef">nil</span> (<span style="color:#a6e22e">list</span> current-dir))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;The current point is not a directory.&#34;</span>))))
</span></span></code></pre></div><figure><img src="https://emacs.dyerdwelling.family/ox-hugo/20240918092253-emacs--Adding-Disk-Usage-Reporting-to-Emacs-Dired-Mode.jpg" width="100%">
</figure>

<p>and that is it!</p>