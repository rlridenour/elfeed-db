<p>UPDATE: <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> is now available on <a href="https://melpa.org/#/dwim-shell-command">melpa</a>.</p>
<p><img src="https://xenodium.github.io/images/png-to-icns-emacs-dwim-style/icns.gif" alt=""></p>
<p>Since <a href="https://xenodium.com/emacs-dwim-shell-command/">writing a DWIM version of the shell-command</a>, I've been having a little fun <a href="https://xenodium.com/emacs-password-protect-current-pdf-revisited/">revisiting command line utilities</a> I sometimes invoke from my beloved editor. In this instance, converting a png file to an icns icon. What's more interesting about this case is that it's not just a one-liner, but a short script in itself. Either way, it's just as easy to invoke from Emacs using <code>dwim-shell-command--on-marked-files</code>.</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-command-convert-image-to-icns ()
  &quot;Convert png to icns icon.&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;Convert png to icns icon&quot;
   &quot;
    # Based on http://stackoverflow.com/questions/12306223/how-to-manually-create-icns-files-using-iconutil
    # Note: png must be 1024x1024
    mkdir &lt;&lt;fne&gt;&gt;.iconset
    sips -z 16 16 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_16x16.png'
    sips -z 32 32 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_16x16@2x.png'
    sips -z 32 32 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_32x32.png'
    sips -z 64 64 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_32x32@2x.png'
    sips -z 128 128 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_128x128.png'
    sips -z 256 256 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_128x128@2x.png'
    sips -z 256 256 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_256x256@2x.png'
    sips -z 512 512 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_512x512.png'
    sips -z 512 512 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_256x256@2x.png'
    sips -z 1024 1024 '&lt;&lt;f&gt;&gt;' --out '&lt;&lt;fne&gt;&gt;.iconset/icon_512x512@2x.png'
    iconutil -c icns '&lt;&lt;fne&gt;&gt;.iconset'&quot;
   :utils '(&quot;sips&quot; &quot;iconutil&quot;)
   :extensions &quot;png&quot;))
</code></pre>
