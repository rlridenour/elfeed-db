
	
<p>
Project Euler 3 is about prime factors, which are some of the most important numbers of the digital economy. RSA encryption is based on the fact that determining the prime factors of huge numbers takes a very long time. So much time in fact that the cost of breaking the encryption outweigh the benefits of obtaining the secret.</p>
<p>
Prime numbers are the basic building blocks of the natural numbers as every number, except the primes themselves. Every natural number can be written as the product of a series of primes. The RSA encryption system uses large primes to keep electronic messages away from prying eyes, as explained in the Numberphile video below.</p>
<p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/M7kEpw1tn50?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>
</p>
<p>
Prime numbers are a favourite topic in Project Euler. <a href="https://lucidmanager.org/data-science/project-euler-7/">Problem 7</a> asks for the first ten thousand primes, and <a href="https://lucidmanager.org/data-science/project-euler-10/">Problem 10</a> looks at the sum of all the primes below two million.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 3 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The prime factors of 13195 are 5, 7, 13 and 29. What is the <a href="https://projecteuler.net/problem=3">largest prime factor</a> of the number 600851475143?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Generating Prime Numbers
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>This solution relies on two functions that can be used for multiples problems. The Sieve of Eratosthenes generates prime numbers from 2 to <em>n</em>. The code is commented to explain the sieve. The image shows how numbers from 1 to 100 are sieved to find the primes.</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Sieve_of_Eratosthenes_animation.gif" alt="Sieve of Eratosthenes (Source: SKopp at German Wikipedia / CC BY-SA)." title="Sieve of Eratosthenes (Source: SKopp at German Wikipedia / CC BY-SA)."/>
<figcaption>
Sieve of Eratosthenes (Source: SKopp at German Wikipedia / CC BY-SA).
</figcaption>
</figure>
<p>
This problem uses two functions: <code class="verbatim">prime.factors()</code> and <code class="verbatim">esieve()</code>. The <code class="verbatim">prime.factors()</code> function generates the list of unique prime divisors and then produces the factors. The factors are identified by dividing the number by the candidate prime factors until the result is 1.</p>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Base R Solution
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>


<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 3: Largest Prime Factor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Base R solution</span>
</span></span><span style="display:flex;"><span>  esieve <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(n) {
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (n <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#080;font-weight:bold">NULL</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (n <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#080;font-weight:bold">return</span>(n)
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Create a list of consecutive integers {2,3,... n}.</span>
</span></span><span style="display:flex;"><span>      l <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">2</span><span style="color:#333">:</span>n
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Start counter</span>
</span></span><span style="display:flex;"><span>      i <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Select p as the first prime number in the list, p = 2.</span>
</span></span><span style="display:flex;"><span>      p <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">while</span> (p^2 <span style="color:#333">&lt;=</span> n) {
</span></span><span style="display:flex;"><span>          <span style="color:#888">## Remove all multiples of p from the l.</span>
</span></span><span style="display:flex;"><span>          l <span style="color:#333">&lt;-</span> l[l <span style="color:#333">==</span> p <span style="color:#333">|</span> l <span style="color:#333">%%</span> p<span style="color:#333">!=</span> <span style="color:#60e;font-weight:bold">0</span>]
</span></span><span style="display:flex;"><span>          <span style="color:#888">## set p equal to the next integer in l which has not been removed.</span>
</span></span><span style="display:flex;"><span>          i <span style="color:#333">&lt;-</span> i <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888">## Repeat steps 3 and 4 until p^2 &gt; n,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#888">## all the remaining numbers in the list are primes</span>
</span></span><span style="display:flex;"><span>          p <span style="color:#333">&lt;-</span> l[i]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">return</span>(l)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  prime.factors <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span> (n) {
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Define list of factors</span>
</span></span><span style="display:flex;"><span>      factors <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Define primes to be tested</span>
</span></span><span style="display:flex;"><span>      primes <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">esieve</span>(<span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">sqrt</span>(n)))
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Idenitfy prime divisors</span>
</span></span><span style="display:flex;"><span>      d <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">which</span>(n <span style="color:#333">%%</span> primes <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) 
</span></span><span style="display:flex;"><span>      <span style="color:#888">## No prime divisors</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">length</span>(d) <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) 
</span></span><span style="display:flex;"><span>          <span style="color:#080;font-weight:bold">return</span>(n)
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Test candidate primes</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">for</span> (q <span style="color:#080;font-weight:bold">in</span> primes[d]) {
</span></span><span style="display:flex;"><span>          <span style="color:#888">## Generate list of factors</span>
</span></span><span style="display:flex;"><span>          <span style="color:#080;font-weight:bold">while</span> (n <span style="color:#333">%%</span> q <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>              factors <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(factors, q)
</span></span><span style="display:flex;"><span>              n <span style="color:#333">&lt;-</span> n<span style="color:#333">/</span>q } } 
</span></span><span style="display:flex;"><span>              <span style="color:#080;font-weight:bold">if</span> (n <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">1</span>) 
</span></span><span style="display:flex;"><span>                  factors <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(factors, n)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">return</span>(factors)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">max</span>(<span style="color:#06b;font-weight:bold">prime.factors</span>(<span style="color:#60e;font-weight:bold">600851475143</span>))</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
Number package
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>The solution can also be found by using the <code class="verbatim">primeFactors()</code> function in the <a href="https://cran.r-project.org/web/packages/numbers/index.html">numbers package</a>. This package provides a range of functions related to prime numbers and is much faster than the basic R code.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Numbers package</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(numbers)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">max</span>(<span style="color:#06b;font-weight:bold">primeFactors</span>(<span style="color:#60e;font-weight:bold">600851475143</span>))</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>
</div>
</div>

      