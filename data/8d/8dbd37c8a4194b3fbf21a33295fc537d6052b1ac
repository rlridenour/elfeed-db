<div>  <p>Sometimes you want to repeat an Emacs function, even when calling it originally took a few keystrokes. Here's how to make it easily repeatable. Say we have a simple function that inserts "here":</p>  <pre><code class="code-emacs-lisp">(defun insert-here ()  (interactive)  (insert "here"))</code></pre>  <p>And bind it to <code>C-c h h</code>:</p>  <pre><code class="code-emacs-lisp">(global-set-key (kbd "C-c h h") #'insert-here)</code></pre>  <p>This works; every time we type <code>C-c h h</code>, we insert "here" into the buffer. But often we want to repeat the command. Although we could use <code>C-x z</code> to repeat the last command, that's still two keypresses, and isn't the easiest thing to press once you've typed <code>C-c h h</code>. So instead, we can make a <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Keymaps.html#index-make_002dsparse_002dkeymap">sparse keymap</a> and in it, set "h" to this command.</p>  <pre><code class="code-emacs-lisp">(setq insert-here-keymap      (let ((map (make-sparse-keymap)))        (define-key map (kbd "h") #'insert-here)        map))</code></pre>  <p>Now we just need to use this keymap inside <code>#'insert-here</code>. We can't use <code>#'use-local-map</code>, because that will mean we can <em>never</em> insert <code>h</code> again: we'd always call <code>#'insert-here</code>. Instead, we can use <code>#'set-transient-map</code>, which still uses the local keymap, but deactivates the keymap after a single key is pressed.</p>  <pre><code class="code-emacs-lisp">(defun insert-here ()  (interactive)  (insert "here")  (set-transient-map   insert-here-keymap))</code></pre>  <p>Now, after activating <code>#'insert-here</code>, we can repeat it by pressing <code>h</code>. But if <em>anything</em> else is pressed, the keymap disables. Further presses of <code>h</code> will insert the letter; the keymap is no longer used. So we've accomplished our goal of easily repeating this command with a single keypress.</p></div>