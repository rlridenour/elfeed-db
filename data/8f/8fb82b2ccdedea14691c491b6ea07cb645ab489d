<p>[Equations in this post may not look right (or appear at all) in your RSS reader. Go to <a href="https://leancrew.com/all-this/2025/09/barycentric-coordinates-and-random-distribution-of-points/">the original article</a> to see them rendered properly.]</p>
  <hr />
  <p>This morning, <a href="https://www.johndcook.com/blog/2025/09/11/random-inside-triangle/">John D. Cook posted an article</a> about generating uniformly distributed points over the interior of a triangle. He offered three options, one that failed to distribute the points uniformly and two that succeeded. I want to talk about the failure.</p>
<p>In the failure, he used <a href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system"><em>barycentric coordinates</em></a> to describe locations within the triangle. These coordinates, which I called <em>area coordinates</em> (because that’s the terminology I learned 40 years ago) in <a href="https://leancrew.com/all-this/2022/12/triangles-and-area-coordinates/">a post written a few years ago</a> are a set of three values in the [0, 1] range, each representing how close the point in question is to one of the triangle’s corners. You can follow the links to get more complete descriptions. One important characteristic of these coordinates is that they are not independent of one another—their sum has to equal one.</p>
<p>Cook’s failed approach (which he knew would fail) consisted of three steps:</p>
<blockquote>
<ol>
<li>Generate random numbers α, β, and γ from the interval [0, 1].</li>
<li>Normalize the points to have sum 1 by dividing each by their sum.</li>
<li>Return αA + βB + γC.</li>
</ol>
</blockquote>
<p>where A, B, and C are the three corner points of the triangle.</p>
<p>He gives an example of randomly generated points and shows that this procedure doesn’t lead to a uniform distribution of the points over the interior of the triangle. But he doesn’t explain why, which is what I spent some time this afternoon exploring.</p>
<p>Cook’s first step generates uniformly distributed points in the unit cube that has one of its corners at the origin of the Cartesian <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo form="prefix" stretchy="false">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo form="postfix" stretchy="false">)</mo></mrow></math> coordinate system.</p>
<p><img alt="Cube of uniform distribution" class="ss" src="https://leancrew.com/all-this/images2025/20250911-Cube%20of%20uniform%20distribution.png" title="Cube of uniform distribution" width="80%"/></p>
<p>The normalization in the second step creates three new values, <math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>α</mi><mo>-</mo></mover></math>, <math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>β</mi><mo>-</mo></mover></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>γ</mi><mo>-</mo></mover></math>, where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>α</mi><mo>-</mo></mover><mo>=</mo><mfrac><mi>α</mi><mrow><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi></mrow></mfrac></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>β</mi><mo>-</mo></mover><mo>=</mo><mfrac><mi>β</mi><mrow><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi></mrow></mfrac></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mover><mi>γ</mi><mo>-</mo></mover><mo>=</mo><mfrac><mi>γ</mi><mrow><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi></mrow></mfrac></math></p>
<p>This projects the point onto the <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mi>γ</mi><mo>=</mo><mn>1</mn></mrow></math> plane, which slices through the cube, making a tilted equilateral triangle whose corners are at the (1, 0, 0), (0, 1, 0), and (0, 0, 1) corners of the cube. I’m going to call this the <em>normalization plane</em>.</p>
<p><img alt="Cube with normalization plane" class="ss" src="https://leancrew.com/all-this/images2025/20250911-Cube%20with%20normalization%20plane.png" title="Cube with normalization plane" width="80%"/></p>
<p>By “projection,” I mean the point is moved along the line defined by the point and the origin until it intersects with the plane. That movement could be either toward the origin or away from it, depending on which side of the normalization plane the original point lies. Here’s a figure that illustrates this idea:</p>
<p><img alt="Projection onto normalization plane" class="ss" src="https://leancrew.com/all-this/images2025/20250911-Projection%20onto%20normalization%20plane.png" title="Projection onto normalization plane" width="80%"/></p>
<p>If the point generated in Step 1 lies anywhere on the red line, the normalization in Step 2 will move it to the red dot. I’ve changed the viewing angle so it’s easier to see that the red dot is on the normalization plane.</p>
<p>The line I’ve drawn above, which runs out from the origin to the opposite corner of the cube, is the longest such line that can be drawn. It’s length is <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msqrt><mn>3</mn></msqrt><mo>≈</mo><mn>1.732</mn></mrow></math>. The shortest such lines, of which there are three, run out from the origin to the adjacent corner on an axis; they all have lengths of <math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math>.</p>
<p>The lengths of the lines correspond to the relative likelihood of a point on the normalization plane being generated by the combination of Steps 1 and 2. So a point near the center, as in the image above, is 1.732 times as likely to be generated as a point out near one of the corners. This is how we get nonuniformity in the normalized points even though the original random points are uniform.</p>
<p>Here’s an illustration. I generated 10,000 points uniformly in the unit cube and normalized them. An isometric view looking toward the origin from the opposite corner of the cube shows the points on the normalization plane distributed like this:</p>
<p><img alt="Random points after normalization" class="ss" src="https://leancrew.com/all-this/images2025/20250911-Random%20points%20after%20normalization.png" title="Random points after normalization" width="80%"/></p>
<p>This matches the distribution over an equilateral triangle shown on <a href="file:///Users/mark/git/blog-preview/post-preview.html">this MathWorld page</a>, which uses the same procedure we are.<sup id="fnref:mw"><a href="#fn:mw" rel="footnote">1</a></sup></p>
<p>Cook’s final step is just a distortion of the above equilateral triangle to a more general triangle. If you look at <a href="https://www.johndcook.com/blog/2025/09/11/random-inside-triangle/">his first figure</a>, it should be pretty obvious how it’s just a squeezed, stretched, and rotated version of the figure above. The main features of the distribution—sparse near the corners, denser at the midsides, and densest at the centroid—are maintained through the distortion.</p>
<p>I suppose I could work out the joint probability distribution of the normalized coordinates using the technique I talked about in <a href="https://leancrew.com/all-this/2025/05/random-points-without-rejection/">this post</a> and <a href="https://leancrew.com/all-this/2025/07/cauchy-coup/">this one</a>. But my goal was to understand why the distribution had the pattern it does, not to work out all its mathematical details. Thinking about the line lengths got me there.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:mw">
<p>MathWorld calls them <em>trilinear coordinates</em> instead of barycentric or area coordinates. Varying nomenclature can be fun! <a href="#fnref:mw" rev="footnote">↩</a></p>
</li>
</ol>
</div>
  
