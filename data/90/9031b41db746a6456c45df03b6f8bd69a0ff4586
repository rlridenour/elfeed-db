<p>If you are a Comcast Xfinity customer, you hopefully know that you can log into WiFi hotspots wherever other Xfinity customers have them enabled, all using the SSID <code class="language-plaintext highlighter-rouge">xfinitywifi</code>. You may have also figured out by now that <a href="https://www.wireguard.com/">WireGuard</a> doesn’t seem to work over this WiFi service without additional tweaking.</p>

<p>Well, I have tweaked a WireGuard configuration until it seems to work.
<!--more--></p>

<p>I searched the Web for quite a while to find a good solution, and there seemed to be a general <em>feeling</em> that the MTU needed to be adjusted. Lots of people offered various solutions.</p>

<p>Through some experimentation, I discovered that on the client-side WireGuard configuration, the maximum transmission unit (MTU) needed to be set to 1280. Apparently this is a significant number because it’s the <a href="https://en.wikipedia.org/wiki/Maximum_transmission_unit#MTUs_for_common_media">lowest possible MTU for an IPv6 network</a>. Setting the MTU so low will impact performance, but if you are going through a WireGuard VPN, performance probably isn’t your biggest concern.</p>

<p>In the end, your client-side WireGuard configuration, which is located in <code class="language-plaintext highlighter-rouge">/etc/wireguard/wg0.conf</code> if you are on Linux, should look like the example below. Note in particular the <code class="language-plaintext highlighter-rouge">MTU</code> and <code class="language-plaintext highlighter-rouge">AllowedIPs</code> line.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Interface]
PrivateKey = &lt;your private key&gt;
Address = &lt;your ip address and netmask&gt;
DNS = &lt;your DNS server&gt;
# This MTU line is the important one!
MTU = 1280

[Peer]
PublicKey = &lt;your public key&gt;
PresharedKey = &lt;your pre-shared key&gt;
Endpoint = &lt;your endpoint&gt;:51820
# This is important for client-side routing!
AllowedIPs = 0.0.0.0/0, ::0/0
PersistentKeepalive = 25
</code></pre></div></div>

<p><a href="https://amzn.to/4hI6hMI"><img src="/assets/img/sft1200_1.webp#right" alt="GL.iNet GL-SFT1200 Opal" /></a>
This became important to me because I’ve been shifting over to using a secure travel router when I am out and about. The router I chose to go with is the <a href="https://amzn.to/4hI6hMI">GL.iNet GL-SFT1200 Opal</a>, and it has built-in WireGuard support that you can enable with a switch on the side. It is very cute and effective. This allows me to use WireGuard to create a VPN tunnel back to <a href="/2016/07/a-poor-mans-dynamic-dns-with-ansible-and-amazon-route53/">my home network</a>, which gives me the ability to use my dual <a href="https://pi-hole.net/">pi-hole</a> setup from anywhere in the world!</p>

<p>If you have been struggling with that pesky <code class="language-plaintext highlighter-rouge">xfinitywifi</code> network and its weird settings, I hope this helps. It took me too long to find the right solution!</p>