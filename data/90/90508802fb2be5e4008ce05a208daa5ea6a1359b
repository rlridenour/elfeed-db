<p><img src="https://bledley.xyz/2025-03-26-image-previews-in-lf-file-manager/screenshot1.png" alt="Image 1"></p>
<p>Despite swearing by <a href="https://github.com/ranger/ranger">ranger</a> for quite a few years I am a recent convert to the very similar <a href="https://github.com/gokcehan/lf">lf file manager</a>. It just feels a little lighter, faster and simpler and lets me fly around my system super fast. Today I finally got image previews working and very nicely too. I can do away with Ranger and the no longer maintained <a href="https://github.com/seebye/ueberzug">ueberzug</a> for terminal image previews.</p>
<p>The answer for me was that I needed to install <a href="https://github.com/hpjansson/chafa">chafa</a>. You may also need to install libsixel - I already had this installed so maybe go look into that. We need to make a previewer script that uses chafa for pictures and bat when it&rsquo;s text/not an image file. <a href="https://github.com/sharkdp/bat">bat</a> gives you nicely coloured previews of text files with syntax highlighting. I&rsquo;m using the <a href="https://codeberg.org/dnkl/foot">foot terminal</a> on Wayland in <a href="https://hyprland.org/">hyprland</a> and on Arch Linux. If you want to implement it this way you will need to use a terminal with <a href="https://www.arewesixelyet.com/">sixel support</a></p>
<p><img src="https://bledley.xyz/2025-03-26-image-previews-in-lf-file-manager/screenshot2.png" alt="Image 2"></p>
<p>Feel free to use this code below or check out my dotfiles repo on <a href="https://github.com/bleds1/dotfiles">GitHub</a></p>
<p>First up install chafa via your package manager. On Arch Linux you should find this in the regular repos. Installation may vary on different distros.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>    sudo pacman -S chafa
</span></span></code></pre></div><p>Next up create a bash script. I&rsquo;ve called it pv.sh but name it as you like. It can be placed in any directory so long as you include it&rsquo;s full path in your lf config. I keep my scripts in a <em>~/.scripts</em> folder or sometimes in <em>~/.local/bin</em></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>    <span style="color:#60a0b0;font-style:italic">#!/bin/sh</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    <span style="color:#60a0b0;font-style:italic"># use chafa/sixel to preview images in lf. If it&#39;s not an image use bat with colour</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#60a0b0;font-style:italic"># chmod +x on the command line to make the script executable.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#007020;font-weight:bold">case</span> <span style="color:#4070a0">&#34;</span><span style="color:#007020;font-weight:bold">$(</span>file -Lb --mime-type -- <span style="color:#4070a0">&#34;</span><span style="color:#bb60d5">$1</span><span style="color:#4070a0">&#34;</span><span style="color:#007020;font-weight:bold">)</span><span style="color:#4070a0">&#34;</span> in
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>        image/*<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>            chafa -f sixel -s <span style="color:#4070a0">&#34;</span><span style="color:#bb60d5">$2</span><span style="color:#4070a0">x</span><span style="color:#bb60d5">$3</span><span style="color:#4070a0">&#34;</span> --animate off --polite on <span style="color:#4070a0">&#34;</span><span style="color:#bb60d5">$1</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>            <span style="color:#007020">exit</span> <span style="color:#40a070">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>            ;;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>        *<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>            bat --color<span style="color:#666">=</span>always --style<span style="color:#666">=</span><span style="color:#4070a0">&#34;numbers,snip&#34;</span> <span style="color:#4070a0">&#34;</span><span style="color:#bb60d5">$1</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>            ;;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>    <span style="color:#007020;font-weight:bold">esac</span>
</span></span></code></pre></div><p>Now in your lf config <em>(~/.config/lfrc)</em> you will need the following options set. Save and launch a new instance of lf and you should be in business.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>    <span style="color:#007020">set</span> preview <span style="color:#007020">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#007020">set</span> previewer ~/.config/lf/pv.sh <span style="color:#60a0b0;font-style:italic">#full path the above script</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#007020">set</span> sixel <span style="color:#007020">true</span>
</span></span></code></pre></div><p><em>Related: <a href="https://bledley.xyz/significantly-reduce-video-file-size-with-ffmpeg/">Significantly reduce video file size with ffmpeg</a></em></p>
<hr>
<p><em>Leave a comment by <a href="mailto:bledley@posteo.com">email</a> or you can find me on the <a href="https://mastodon.social/@bledley">Fediverse</a></em></p>
