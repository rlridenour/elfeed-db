<p>As I write this, I am imagining one of those slightly cheesy voiceovers for a TV show, reminding viewers of the previous episode: &ldquo;Last time on &lsquo;BSAG Gets Nerdy About Emacs&rsquo;&hellip;&rdquo;. You may remember that I was <a href="https://www.rousette.org.uk/archives/on-the-emacs-from-scratch-cycle/">on the Emacs from Scratch cycle again</a>, and enjoying the process of learning the default Emacs keybindings, instead of installing <code>evil-mode</code> like I usually do. Well, I am still doing that, but a random meander around the Emacs-y corners of the internet turned up <a href="https://github.com/susam/devil">susam&rsquo;s</a> <a href="https://susam.github.io/devil/">devil-mode</a>, a sort of modeless modal editing mode. A what now?</p>
<p>I know, I had trouble wrapping my head around that myself initially. <a href="https://susam.github.io/devil/">Devil mode</a> very cleverly combines elements of <a href="https://github.com/emacsorphanage/god-mode">god-mode</a> (letting you enter standard Emacs chords sequentially rather than simultaneously) with aspects of <code>evil-mode</code> navigation, but using standard Emacs shortcuts rather than vim-specific ones.</p>
<p>The clever trick that <code>devil-mode</code> pulls off is that &mdash; like standard Emacs keyboard shortcuts &mdash; you don&rsquo;t need to enter or exit a special mode in order to issue a command. It does this by using the comma key as a kind of leader that substitutes for the <code>Ctrl</code> modifier in commands. I know this sounds like a crazy plan. Commas are common in programming and normal text, so how does that work? I should say that this is configurable, so you can choose another key if you like. However, using the comma works out remarkably well, because there are built-in translators that substitute two successive commas into a literal comma, and a comma at the end of a word followed by a space into a comma and space. The latter works well in almost all real world cases, so you rarely have to use the double comma trick.</p>
<p>In <code>devil-mode</code>, a comma represents <code>Ctrl</code>. So issuing the command for <code>find-file</code> becomes <code>,x,f</code> entered successively, rather than <code>C-x C-f</code>. Commands with a chord followed by a single key (like <code>C-x k</code> for <code>kill-buffer</code>) would use <code>,xk</code>. Chords using <code>M-</code> or <code>C-M-</code> are also catered for using <code>,m</code> and <code>,mm</code> respectively. Finally, since comma space (by default, you can change it) translates to a literal comma space, it becomes impossible to issue <code>C-SPC</code> to set the mark using <code>devil-mode</code>. However, another sequence of keys acts as an alternative way to represent <code>Ctrl</code> so you can enter <code>,z SPC</code> instead. As I said, this is configurable, so if you would rather always enter two commas for a literal comma, you can reverse this behaviour.</p>
<p>Of course, the beauty of <code>devil-mode</code> is that you can very freely mix and match standard Emacs keystrokes with the devilish versions of them, and because you never need to think about what mode you are in, this feels easy and fluid. Some devilish versions require more keystrokes than the Emacs version (e.g. <code>M-x</code> vs. <code>,mx</code>), so I find that I tend to use the Emacs versions for those. However, there are times when holding down chords feels tiring, so you can use the devil version instead. The best part is &mdash; if you are familiar with vanilla Emacs commands &mdash; you don&rsquo;t need to learn anything new. The mapping between Emacs and devil-mode commands is extremely straightforward.</p>
<p>Another benefit is that the mode cleverly works similarly to Emacs&rsquo; <code>repeat-mode</code> to chain together commands that belong in the same sequence, so that you can use single keys (not even having to use the comma activation after the first instance) to navigate around semantic units for example. So you can set things up so that after you enter <code>,n</code> (for example) to move to the next line, you can enter just <code>p</code> to go back up a line, <code>a</code> to go to the start of the line, <code>e</code> to the end and so on. Entering any other key or <code>C-g</code> gets out of the repeat mode. I have set up a similar chain for semantic movement around text by word or sentence which is very handy for quickly bopping around text while editing. <code>devil-mode</code> uses its own syntax to define these keys, which I personally find much easier to use than the Emacs <code>repeat-mode</code> syntax. However, if you prefer the latter, you can disable devil-mode repeatable keys and use the Emacs configuration instead.</p>
<p>I&rsquo;ve used <code>devil-mode</code> for a few weeks now, and really like it for its flexibility and transparency. I have found very few downsides to its use. One is that &mdash; by default &mdash; <code>which-key</code> doesn&rsquo;t recognise the comma activator and so does not pop up the relevant available commands. This is a <a href="https://github.com/susam/devil/issues/3">known issue</a>, and I have used <a href="https://github.com/wesnel/emacs-which-key">wesnel&rsquo;s fork of which-key</a> to solve this. The second very minor issue is that when you are in the only properly modal bit of <code>devil-mode</code> (repeatable keys) you don&rsquo;t see any visual indication that you are in that mode. This is also a requested feature which would be nice to have, but in practice, <code>C-g</code> is an easy escape hatch, and since I tend to use the feature to quickly hop around then exit the repeatable keys mode, it isn&rsquo;t much of an issue in practice.</p>
<p>I get the impression that not many people know about <code>devil-mode</code>, which is a great shame, as I think it is the perfect solution when you want to use vanilla Emacs, but you also get a bit tired of holding chords down. I should mention that this is especially handy if you use a split keyboard with homerow mods mirrored on each side of the keyboard (as I do), as there can be a bit of hand-switching needed for some Emacs chords. Anyway, give <code>devil-mode</code> a try &mdash; you might find you love it.</p>