<p>When it comes to sharing written documents with my co-workers, I usually need to use Word or PDFs. Org-mode includes an export option to odt files, which does the job in a pinch, but it&rsquo;s a bit harder to customize, especially if I want to preserve certain formatting elements. In the past, I used to create ODT files, import them into Word, make whatever changes I needed, and save them in a docx file. The problem there, besides the manual work, is consistency. If I want to make sure I use the same style for fonts, header sizes, and table formats, things get annoying fast.</p>
<p>About a year ago, I discovered that Pandoc can use an external Word document (docx) as a style template. As long as I have this file accessible, every org file I convert to docx will automatically (and beautifully, I may add) retain the exact style changes I need. This, of course, can be automated later inside Emacs, so the export process is basically seamless.</p>
<p>The problem lies in the fact that you need to work with Word and understand how its styles. Readers of this blog know I love to complain about Microsoft&rsquo;s UI and its lack of consistency, and the instructions here are one fine example in my opinion. Be it as it may, I will try to keep the snarky comments in check.</p>
<h3 id="creating-the-default-style-sheet">Creating the default style sheet</h3>
<p>The first thing to do is get Pandoc to create its default style reference document as a .docx. This can be done with <code>pandoc -o custom-reference.docx --print-default-data-file reference.docx</code>.</p>
<p>What you&rsquo;re telling Pandoc here is to output (<code>-o</code>) a file named <code>custom-reference.docx</code> (you can call it whatever you&rsquo;d like, as long as it&rsquo;s a docx, since you want to work with Word). What to output goes into this file? The default reference document.</p>
<p>Once you do that, you will have a <code>custom-reference.docx</code> in the folder you ran the command from.</p>
<p>Now it&rsquo;s time to work inside Word.</p>
<h3 id="modifying-the-styles">Modifying the styles</h3>
<p>What you will see is a rather plain file listing a bunch of styles and their name. First, you will see &ldquo;Title,&rdquo; and it will be nice and big because it&rsquo;s using the Title style in Word. Heading 1 will use the Heading 1 style, Body Text (further down) will use the Body Text style, and so on.</p>
<p>What you want to do is to access these styles in Word. You will be modifying them to fit to your liking.</p>
<p>To do that, search for the <strong>Styles Pane</strong>. In my case, Office 365 for macOS, I can find it in the ribbon under <strong>Home</strong>, but I wouldn&rsquo;t be surprised if that&rsquo;s a little different if you&rsquo;re using Windows, or a different version of Word.</p>
<p>With the <strong>Style Pane</strong> open, you will see a long list of the available styles. You can navigate this way, but I find it&rsquo;s easier to just look for them in the document to the left and select them; it will then show under <strong>Current style:</strong> to the right.</p>
<p>Now that you have a style selected, select the name of that style from the <strong>Style Pane</strong> and choose <strong>Modify Style&hellip;</strong><sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>. You will see the options available to you, such as the font name, text color, alignment, etc.</p>
<p>Make sure that you do not change the <strong>Name:</strong> of the style! You&rsquo;re modifying existing default styles that Pandoc recognizes; if you create a new one (by giving it a new name), Pandoc will not know what to do with it and will ignore it. Remember, you are modifying a reference sheet of existing styles, not creating new styles. Likewise, this means that you have no reason to change anything in the document itself (the content) - Pandoc doesn&rsquo;t care about that and will ignore it. You&rsquo;re only touching the options in the <strong>Modify Style&hellip;</strong> window.</p>
<center><video src="https://cdn.uploads.micro.mov/96826/2026/style-pane-word/playlist.m3u8" poster="https://cdn.uploads.micro.blog/96826/2026/frames/1669476-0-9cdad2.jpg" width="1058" height="836" controls="controls" preload="metadata"></video></center>
<p>That&rsquo;s basically all there is to it. As you will see soon, some items can get a bit more complicated as they are not available in the same way. Save the files when you&rsquo;re done modifying the styles. You will probably keep going back to this document as you export docx files, tweaking things until you like them.</p>
<h3 id="using-pandoc-to-export-from-org-mode-to-a-docx-file">Using Pandoc to export from org-mode to a docx file</h3>
<p>The next step is to tell Pandoc to convert an existing org file to a docx file using the reference sheet we just worked on. To do that, use the following command:</p>
<p><code>pandoc -s &lt;input_file.org&gt; -o &lt;output_file.docx&gt; --reference-doc custom-reference.docx</code>.</p>
<p>The idea is the same as before, but we use a stationary option, <code>-s</code> (the reason for that is that we&rsquo;re telling Pandoc to use a &ldquo;full&rdquo; version of a document, needed with the reference doc option, otherwise it can&rsquo;t use our reference document).</p>
<p>Then, we&rsquo;re pointing Pandoc to our org file and using the output, <code>-o</code>, as the doc file we want, then finally using the <code>reference-doc</code> option by utilizing our reference file, <code>custom-reference.docx</code> (unless you change the name to something else). That&rsquo;s it, Pandoc will create the file in the folder you are in.</p>
<h3 id="images-and-tables">Images and Tables</h3>
<p>For me, things get a bit more complicated. My technical documents often include screenshots, and I need those embedded in the resulting Word docx file.</p>
<p>The above command will embed images in the Word document, as long as org-mode can find and display your images (using the <a href="https://orgmode.org/manual/Images.html">inlineimages</a> option in org-mode). My org-mode technical notes are all written with <a href="https://taonaw.com/2026/01/25/why-i-use-denote.html">Denote</a> these days, which keeps everything organized, including the images, which are inside the default data subfolder. If your workflow is different, be mindful of your path to the images; you&rsquo;d probably want to use an absolute path in org-mode (use <code>C-u C-u C-c C-l</code> when linking an image instead of the usual <code>C-u C-c C-l</code> for this). There&rsquo;s also the option to extract media in Pandoc (see the <a href="https://pandoc.org/MANUAL.html">&ndash;extract-media</a> option). In my opinion, it&rsquo;s simpler and cleaner to dedicate a folder for your org documents, completed with a subfolder for attachments.</p>
<p>Another issue that stumbled me was the tables.</p>
<p>Pandoc&rsquo;s default style for tables is minimal - without borders. This might look nice if you want to hide your tables, but if you need a table with borders and perhaps some shading, you&rsquo;ll run into issues.</p>
<p>The problem is with Word. The style for the table is not included in the Style Pane. In order to change the style for your table in the reference doc, you need to locate <strong>Table Design</strong> in your ribbon. Notice that if you work on a small screen (like in my recording), you might have to expand your options to find it. Then, you will have to extend the pane further and locate the <strong>Modify Table Style</strong> below. Once again, this is true for my case, Office 365 on macOS. If you&rsquo;re using a different Office version or on Windows, this menu might be located elsewhere.</p>
<p>Once you have <strong>Modify Table Style</strong> open, you can change the borders and shading to your heart&rsquo;s content, but as before, make sure the style name remains <strong>Table</strong>. If you create a new style, Pandoc will ignore it.</p>
<center><video src="https://cdn.uploads.micro.mov/96826/2026/tables-style-in-word/playlist.m3u8" poster="https://cdn.uploads.micro.blog/96826/2026/frames/1669484-0-ffbfcb.jpg" width="1060" height="836" controls="controls" preload="metadata"></video></center>
<h3 id="a-few-tricks-i-picked-up">A few tricks I picked up</h3>
<p>Under the name of the style, in the <strong>Modify Style</strong> or <strong>Modify Table Style</strong> window, you will see the <strong>Style based on</strong> option. You can change this option and browse through different colors and fonts to find something you like, and then customize further instead of starting from scratch. As long as you don&rsquo;t change the name of the style, you&rsquo;re OK. I found this useful when working with tables, as I was looking for a table with shading on every other row.</p>
<p>Speaking of tables, the border button is the little square icon in the middle. I spent a few moments trying to find it.</p>
<h3 id="bonus-use-dwim-shell-command-for-quick-export">Bonus: use dwim-shell-command for quick export</h3>
<p>If you&rsquo;re an Emacs user, you like shortcuts, and you like to use shell commands from within Emacs. If you haven&rsquo;t yet, check out <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a>.</p>
<p>Here&rsquo;s how I have it set up. All I have to do is mark the org file(s) I want to convert to a docx, and that&rsquo;s it. It doesn&rsquo;t matter if I want to export only one file or fifty; it&rsquo;s the same ease of use.</p>
<pre><code>(defun jtr/dwim-shell-command-pandoc-org-to-docx ()
  &quot;uses pandoc to convert an org file to docx using a template docx file. The docx template file is stored in my Notes sync folder&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;converting from org to docx&quot;
   &quot;pandoc -s '&lt;&lt;f&gt;&gt;' -o '&lt;&lt;fne&gt;&gt;.docx' --reference-doc ~/Sync/Notes/Info/custom-reference.docx&quot;
   :utils &quot;pandoc&quot;))
</code></pre>
<h3 id="footnotes">Footnotes</h3>
<p><sup><a id="fn.1" href="#fnr.1">1</a></sup> : Or, another way to work is to use to select the text you want to modify, then go to <strong>Format</strong> and select <strong>Style</strong> from there; you will need to then choose <strong>Modify</strong> in the window that shows.</p>
