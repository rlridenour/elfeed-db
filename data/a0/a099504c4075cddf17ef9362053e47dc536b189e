
<p><a href="https://getsops.io/">SOPS: Secrets OPerationS</a> &#8211; A silent tool for Ghost Operators. Silent Architects.</p>



<p>Ansible Vault safeguards your data.</p>



<ul class="wp-block-list">
<li>The team grows.</li>



<li>The data is more complex.</li>



<li>Encrypted files are too much noise.</li>
</ul>



<p>SOPS restores the signal.</p>



<span id="more-8266"></span>



<h3 class="wp-block-heading">Get Your New Blade</h3>



<p>Download the SOPS Linux binary from <a href="https://github.com/getsops/sops/releases">Github</a>.<br>Verify the binary with <code>SHA256</code> checksum.<br>Move it to the <code>$PATH</code>.</p>



<p>Create or import your GPG keys.</p>



<h3 class="wp-block-heading">Sharpen The Blade</h3>



<p>Configure SOPS to use the SOPS GPG fingerprint.</p>



<p>Get the fingerprint:</p>



<pre class="wp-block-code"><code>gpg --list-keys
</code></pre>



<p>Copy and use it:</p>



<pre class="wp-block-code"><code> export  SOPS_PGP_FP= "27846AFA62AC8475754E28ACFC0537D05D1D146B"
</code></pre>



<p>Test it.</p>



<pre class="wp-block-code"><code>sops edit test.sops.yaml
</code></pre>



<h3 class="wp-block-heading">The Silent Ansible Upgrade</h3>



<p>Install the Ansible SOPS collection if missing:</p>



<pre class="wp-block-code"><code>ansible-galaxy collection install community.sops
</code></pre>



<p>In the <code>ansible.cfg</code> enable the SOPS vars plugin:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: yaml; title: ; notranslate">
&#91;defaults]
vars_plugins_enabled = host_group_vars,community.sops.sops

</pre></div>


<p>The <code>host_vars</code> or <code>group_vars</code> files&#8217; extension must be:</p>



<ul class="wp-block-list">
<li>.sops.yaml</li>



<li>.sops.yml</li>
</ul>



<p>Configure the SOPS creation rules in the <code>.sops.yaml</code> file:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: yaml; title: ; notranslate">
 ---
 creation_rules:
  -  path_regex: inventories/.*\.sops\.yml
     key_groups:
      -  pgp:
          - 27846AFA62AC8475754E28ACFC0537D05D1D146B

</pre></div>


<h3 class="wp-block-heading">The Ghosts In Action</h3>



<p>Create a SOPS encrypted file in <code>host_vars</code> or <code>group_vars</code>.</p>



<pre class="wp-block-code"><code>sops edit inventories/host_vars/hostname.yml
</code></pre>



<p>Remove the <strong>example content</strong> and add your data.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: yaml; title: ; notranslate">
 ---
 my_data:
  - Hello
  - this is from
  - SOPS

</pre></div>


<p>Ansible can decrypt and use it.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: yaml; title: ; notranslate">
 ---
-  name:  SOPS test
   hosts: hostname

   tasks:
    -  name:  Echo the test variable
       ansible.builtin.debug:
         var: my_data

</pre></div>


<p>The system bends to you, Ghost Operator.</p>



<h3 class="wp-block-heading">Sharpening For The Team</h3>



<p>Operators rotate. Keys must too.</p>



<h4 class="wp-block-heading">Add a new teammate</h4>



<p>Import their public GPG key:</p>



<pre class="wp-block-code"><code>gpg --import teammate_pubkey.asc
</code></pre>



<p>Update the <code>key_groups</code> in <code>.sops.yaml</code> with their fingerprint:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: yaml; title: ; notranslate">
 creation_rules:
  -  path_regex: inventories/.*\.sops\.yml
     key_groups:
      -  pgp:
          - Your Fingerprint
          - Teammate Fingerprint

</pre></div>


<p>Re-encrypt the files so SOPS includes both keys:</p>



<pre class="wp-block-code"><code>sops updatekeys inventories/host_vars/ghost-infra.sops.yml
</code></pre>



<h4 class="wp-block-heading">Remove a teammate</h4>



<p>Delete their fingerprint from <code>.sops.yaml</code>.</p>



<p>Re-encrypt again:</p>



<pre class="wp-block-code"><code>sops updatekeys inventories/host_vars/ghost-infra.sops.yml
</code></pre>



<p>Only the fingerprints listed will keep future access.</p>



<h3 class="wp-block-heading">Final Whisper</h3>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>Silence keeps the secrets. SOPS keeps them safe.</p>
</blockquote>



<p></p>
