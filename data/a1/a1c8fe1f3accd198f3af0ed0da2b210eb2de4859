<p>After implementing my simple occur indexing in my last post :</p>
<p><a href="https://emacs.dyerdwelling.family/emacs/20230308203648-emacs--indexing-my-emacs-init-file/">Indexing My Emacs Init File</a></p>
<p>A suggestion was made to put this into an <code>imenu</code>.</p>
<p>I thought that was rather a good idea and it would also give me the opportunity to explore <code>imenu</code></p>
<p>I came up with the following to add to the emacs init file :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;emacs-lisp-mode-hook</span>
</span></span><span style="display:flex;"><span>  (lambda ()
</span></span><span style="display:flex;"><span>    (setq imenu-sort-function <span style="color:#e6db74">&#39;imenu--sort-by-name</span>)
</span></span><span style="display:flex;"><span>    (setq imenu-generic-expression
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>(
</span></span><span style="display:flex;"><span>         (<span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#34;^;;[[:space:]]+-&gt; \\(.*\\)$&#34;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>         (<span style="color:#e6db74">&#34;defun&#34;</span> <span style="color:#e6db74">&#34;^.*([[:space:]]*defun[[:space:]]+\\([[:word:]-/]+\\)&#34;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>         (<span style="color:#e6db74">&#34;use-package&#34;</span> <span style="color:#e6db74">&#34;^.*([[:space:]]*use-package[[:space:]]+\\([[:word:]-]+\\)&#34;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>         )
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    (imenu-add-menubar-index)))
</span></span></code></pre></div><p>which produces the following:</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/20230414111409-emacs--indexing-emacs-init.jpg" width="100%">
</figure>

<p>I thought for good measure I would also add in some menus for <code>defuns</code> and <code>use-package</code> declarations (just for fun!) with my main defined sections forming the top level due to the MENU-TITLE being set to nil in the <code>imenu-generic-expression</code> variable.</p>
<p>This implementation has the added benefit of integrating nicely into the local completion system.  For example I use <code>vertico</code> and running <code>imenu</code> calls up the defined sections in the mini-buffer and as an extra benefit running <code>consult-imenu</code> does its consult thing to quickly step through the sections or of course to complete.  As I have defined section names for <code>defun</code> and <code>use-package</code> the completion search can search on these too to quickly narrow things down.</p>
<p>I had never looked into <code>imenu</code> before and it was quite an interesting learning experience and in fact I went all the way to defining my own <code>imenu-create-index-function</code> where I can create my own alist index in any way I want to, that was until I found a more simple method!</p>