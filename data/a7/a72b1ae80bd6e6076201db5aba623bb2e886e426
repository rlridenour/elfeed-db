
	
<p>
Project Euler 24 asks to develop lexicographic permutations. These are ordered arrangements of objects in lexicographic order. Tushar Roy of Coding Made Simple has shared a great introduction on how to generate lexicographic permutations.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/nYFd7VHKyWQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
String Permutation Algorithm.
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 24 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>A permutation is an ordered arrangement of objects. For example, 3124 is one possible permutation of the digits 1, 2, 3 and 4. If all of the permutations are listed numerically or alphabetically, we call it lexicographic order. The lexicographic permutations of 0, 1 and 2 are:</p>
<p>
$$012 \quad 021 \quad 102 \quad 120 \quad 201 \quad 210$$</p>
<p>
What is the <a href="https://projecteuler.net/problem=24">millionth lexicographic permutation</a> of the digits 0, 1, 2, 3, 4, 5, 6, 7, 8 and 9?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>The digits 0 to 9 have $10! = 362880$  permutations (including combinations that start with 0). Most of these permutations are, however, not in lexicographic order. A brute-force way to solve the problem is to determine the next lexicographic permutation of a number string and repeat this one million times.
This code takes the following steps:</p>
<ul>
<li>Find largest index $i$ such that$a_{i-1} &lt; a_i$.</li>
<li>If no such index exists, then this is already the last permutation.</li>
<li>Find largest index $j$ such that $j \geq i$ and $a_j &gt; a_{i-1}$.</li>
<li>Swap $a_j$  and $a_{i-1}$.</li>
<li>Reverse the suffix starting at $a_i$.</li>
</ul>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>


<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 24: Lexicographic permutations</span>
</span></span><span style="display:flex;"><span>  nextPerm <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(a) {
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Find longest non-increasing suffix</span>
</span></span><span style="display:flex;"><span>      i <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">length</span>(a)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">while</span> (i <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#333">&amp;&amp;</span> a[i <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>] <span style="color:#333">&gt;=</span> a[i])
</span></span><span style="display:flex;"><span>          i <span style="color:#333">&lt;-</span> i <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888"># i is the head index of the suffix</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Are we at the last permutation?</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (i <span style="color:#333">&lt;=</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#080;font-weight:bold">return</span> (<span style="color:#080;font-weight:bold">NA</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#888"># a[i - 1] is the pivot</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Frind rightmost element that exceeds the pivot</span>
</span></span><span style="display:flex;"><span>      j <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">length</span>(a)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">while</span> (a[j] <span style="color:#333">&lt;=</span> a[i <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>]) 
</span></span><span style="display:flex;"><span>          j <span style="color:#333">&lt;-</span> j <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Swap pivot with j</span>
</span></span><span style="display:flex;"><span>      temp <span style="color:#333">&lt;-</span> a[i <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>]
</span></span><span style="display:flex;"><span>      a[i <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>] <span style="color:#333">&lt;-</span> a[j]
</span></span><span style="display:flex;"><span>      a[j] <span style="color:#333">&lt;-</span> temp
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Reverse the suffix</span>
</span></span><span style="display:flex;"><span>      a[i<span style="color:#333">:</span><span style="color:#06b;font-weight:bold">length</span>(a)] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">rev</span>(a[i<span style="color:#333">:</span><span style="color:#06b;font-weight:bold">length</span>(a)])
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">return</span>(a)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  numbers <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span><span style="color:#333">:</span><span style="color:#60e;font-weight:bold">9</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">1</span><span style="color:#333">:</span>(<span style="color:#60e;font-weight:bold">1E6</span> <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)) numbers <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">nextPerm</span>(numbers)
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">paste</span>(numbers, collapse <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Combinatorics
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>A more efficient solution is to use combinatorics, thanks to the now defunct <em>MathBlog</em>. The last nine digits can be ordered in 9! = 362880 ways. So the first 9! permutations start with a 0. By extending this thought, it follows that the millionth permutation must start with a 2.</p>
<p>
$$\lfloor (1000000 - 1) / 9 ! \rfloor  = 2$$</p>
<p>
From this rule, it follows that the 725761<sup>st</sup> permutation is 2,013,456,789. We now need 274,239 more lexicographic permutations:</p>
<p>
$$(1000000 - 1) - (2 \times 9!) = 274239$$</p>
<p>
We can repeat this logic to find the next digit. The last 8 digits can be ordered in 40320 ways. The second digit is the 6th digit in the remaining numbers, which is 7 (2013456789).</p>
<p>
$$\lfloor 274239 / 8 ! \rfloor  = 6$$</p>
<p>
$$274239 - (6 \times 7 !) = 32319$$</p>
<p>
This process is repeated until all digits have been used.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  numbers <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span><span style="color:#333">:</span><span style="color:#60e;font-weight:bold">9</span>
</span></span><span style="display:flex;"><span>  n <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">length</span>(numbers)
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">vector</span>(length <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>)
</span></span><span style="display:flex;"><span>  remain <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1E6</span> <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">1</span><span style="color:#333">:</span>n) {
</span></span><span style="display:flex;"><span>      j <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(remain <span style="color:#333">/</span> <span style="color:#06b;font-weight:bold">factorial</span>(n <span style="color:#333">-</span> i))
</span></span><span style="display:flex;"><span>      answer[i] <span style="color:#333">&lt;-</span> numbers[j <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>]
</span></span><span style="display:flex;"><span>      remain <span style="color:#333">&lt;-</span> remain <span style="color:#333">%%</span> <span style="color:#06b;font-weight:bold">factorial</span>(n <span style="color:#333">-</span> i)
</span></span><span style="display:flex;"><span>      numbers <span style="color:#333">&lt;-</span> numbers[<span style="color:#333">-</span>(j <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>)]
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">paste</span>(answer, collapse <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>
</div>
</div>

      