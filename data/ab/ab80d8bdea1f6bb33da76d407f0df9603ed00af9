<hr>
<div class="ox-hugo-toc toc local">
<ul>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#lets-create-a-new-package">Lets Create a New Package!</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#building-our-foundation">Building Our Foundation</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#package-naming-conventions">Package Naming Conventions</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#testing-our-foundation">Testing Our Foundation</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#our-complete-foundation">Our Complete Foundation</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#what-we-ve-accomplished">What We&rsquo;ve Accomplished</a></li>
<li><a href="https://emacs.dyerdwelling.family/emacs/20250719094720-emacs--building-an-emacs-cursor-heatmap-pt1/#next-time">Next Time</a></li>
</ul>
</div>
<!--endtoc-->
<hr>
<h2 id="lets-create-a-new-package">Lets Create a New Package!</h2>
<p>Given that I now have greater experience in Emacs package creation, I thought I would create a short series of blog posts over the next few weeks in taking an initial idea I have for a new Emacs package and working it up into a full, working version!</p>
<p>The idea here is to hopefully be useful to someone who has an idea for doing something new in Emacs and would like to start working it up into a package. There are resources out there, but I thought I would give a go at creating my own.</p>
<p>As usual with writing a blog and having to explain a concept to someone in an understandable format, I suspect that I&rsquo;m also actually likely to learn something from this activity.</p>
<p>Right, so what is my idea?</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/cursor-heatmap-banner_pt1.jpg" width="100%">
</figure>

<hr>
<style>.org-center { margin-left: auto; margin-right: auto; text-align: center; }</style>
<div class="org-center">
<p><em>Have you ever wondered where your cursor/point spends most of its time when you are fiddling around with Emacs?, do you generally split two windows side-by-side and which window do you typically work in?, do you use olivetti or a similar mode to centralise the text, do you use a four window split on a large monitor and where do you spend most of your time?</em></p>
<p><em>So how about an Emacs package that monitors your cursor/point position and can provide a graphical report showing by some kind of graphical heat map the often used Emacs window locations</em></p>
</div>
<hr>
<p>Lets quickly break this concept down into a very high level design (so high it is in fact just a speck!), should we go the full software engineering approach and define requirements?, then start deriving a design, (maybe not!), so lets see what functional aspects we can start with:</p>
<ul>
<li>Tracks cursor movements throughout your Emacs editing session</li>
<li>Creates a visual heat map showing movement patterns</li>
<li>Provides analytics about your editing behaviour</li>
<li>Persists data across sessions so we can have recall and overall data across many days</li>
</ul>
<h2 id="building-our-foundation">Building Our Foundation</h2>
<p>Lets crack on and get something down on paper and begin with the absolute minimum structure and expand from there.</p>
<h3 id="step-1-create-the-basic-file-structure">Step 1: Create the Basic File Structure</h3>
<p>Create a new file called <code>cursor-heatmap.el</code> with the following contents:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span><span style="color:#75715e">;;; cursor-heatmap.el --- Monitor and visualize cursor movement patterns -*- lexical-binding: t; -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Copyright (C) 2025</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Author: Your Name &lt;your.email@example.com&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Version: 0.1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Package-Requires: ((emacs &#34;26.1&#34;))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Keywords: tools, analytics, visualization</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; URL: https://github.com/yourusername/cursor-heatmap</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;; Commentary:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; This package will monitor cursor movements throughout an Emacs session and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; generate heatmap reports showing where you move your cursor most frequently.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Basic usage (to be implemented):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;   M-x cursor-heatmap-mode - start tracking</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;   M-x cursor-heatmap-show-report - view results</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;; Code:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Package implementation will go here</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(provide <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;; cursor-heatmap.el ends here</span>
</span></span></code></pre></div><h3 id="step-2-understanding-key-components">Step 2: Understanding Key Components</h3>
<p><strong>Why <code>lexical-binding: t</code>?</strong></p>
<p>This enables modern variable scoping in Emacs Lisp. Without it, all variables have dynamic scope, which can lead to surprising behaviour and bugs. Always use lexical binding for new packages.</p>
<p><strong>The <code>provide</code> statement:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(provide <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span></code></pre></div><p>This tells Emacs that loading this file provides the <code>cursor-heatmap</code> feature. Other packages can then use <code>(require 'cursor-heatmap)</code> to load your package.</p>
<p>There are other more advanced ways of loading packages but we shall stick with the basic built-in Emacs package.el for now.</p>
<p><strong>Version numbering:</strong></p>
<p>We start with <code>0.1.0</code> following a simple versioning mechanism. As we add features, we&rsquo;ll increment appropriately.</p>
<h3 id="step-3-setting-up-customization-groups">Step 3: Setting Up Customization Groups</h3>
<p>One of Emacs&rsquo; greatest strengths is customizability. Let&rsquo;s set up a customization group for our package:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span><span style="color:#75715e">;;; Code:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defgroup cursor-heatmap <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Cursor movement heatmap monitoring and visualization.&#34;</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;tools</span>
</span></span><span style="display:flex;"><span>  :prefix <span style="color:#e6db74">&#34;cursor-heatmap-&#34;</span>)
</span></span></code></pre></div><p>This creates a customization group that will appear under the &ldquo;Tools&rdquo; category in Emacs&rsquo; customization interface. Users can access it via <code>M-x customize-group cursor-heatmap</code></p>
<h3 id="step-4-adding-our-first-variables">Step 4: Adding Our First Variables</h3>
<p>Let&rsquo;s add some basic configuration variables:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(defcustom cursor-heatmap-grid-width <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Width of the heatmap grid (number of columns).&#34;</span>
</span></span><span style="display:flex;"><span>  :type <span style="color:#e6db74">&#39;integer</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defcustom cursor-heatmap-grid-height <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Height of the heatmap grid (number of rows).&#34;</span>
</span></span><span style="display:flex;"><span>  :type <span style="color:#e6db74">&#39;integer</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span></code></pre></div><p>The <code>defcustom</code> macro creates variables that users can customize through the Emacs&rsquo; interface. The <code>:type</code> specification helps Emacs validate user input and provide appropriate UI widgets.</p>
<h2 id="package-naming-conventions">Package Naming Conventions</h2>
<p>Notice how all our variables start with <code>cursor-heatmap-</code> This is a crucial convention in Emacs package development:</p>
<ul>
<li><strong>Prevents namespace collisions</strong>: With thousands of packages, prefixing prevents conflicts</li>
<li><strong>Makes code searchable</strong>: Users can easily find all functions related to your package</li>
<li><strong>Shows ownership</strong>: Clear indication of what belongs to your package</li>
</ul>
<p>Common patterns:</p>
<ul>
<li>Variables: <code>cursor-heatmap-variable-name</code></li>
<li>Functions: <code>cursor-heatmap-function-name</code></li>
<li>Internal functions: <code>cursor-heatmap--internal-function</code> (note the double dash)</li>
</ul>
<h2 id="testing-our-foundation">Testing Our Foundation</h2>
<p>Let&rsquo;s make sure our basic structure works. Add this simple function to test:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(defun cursor-heatmap-hello ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Test function to verify package structure.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Cursor heatmap package loaded successfully! Grid size: %dx%d&#34;</span>
</span></span><span style="display:flex;"><span>           cursor-heatmap-grid-width cursor-heatmap-grid-height))
</span></span></code></pre></div><p>Now you can:</p>
<ol>
<li>Load the file: <code>M-x load-file</code> and select <code>cursor-heatmap.el</code></li>
<li>Test it: <code>M-x cursor-heatmap-hello</code></li>
<li>Check customization: <code>M-x customize-group cursor-heatmap</code></li>
</ol>
<h2 id="our-complete-foundation">Our Complete Foundation</h2>
<p>Here&rsquo;s our complete foundation file, I think I shall show this at the end of each post so progress can be monitored.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span><span style="color:#75715e">;;; cursor-heatmap.el --- Monitor and visualize cursor movement patterns -*- lexical-binding: t; -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Copyright (C) 2025</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Author: Your Name &lt;your.email@example.com&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Version: 0.1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Package-Requires: ((emacs &#34;26.1&#34;))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Keywords: tools, analytics, visualization</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; URL: https://github.com/yourusername/cursor-heatmap</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;; Commentary:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; This package will monitor cursor movements throughout an Emacs session and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; generate heatmap reports showing where you move your cursor most frequently.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Basic usage (to be implemented):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;   M-x cursor-heatmap-mode - start tracking</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;   M-x cursor-heatmap-show-report - view results</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;; Code:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defgroup cursor-heatmap <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Cursor movement heatmap monitoring and visualization.&#34;</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;tools</span>
</span></span><span style="display:flex;"><span>  :prefix <span style="color:#e6db74">&#34;cursor-heatmap-&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defcustom cursor-heatmap-grid-width <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Width of the heatmap grid (number of columns).&#34;</span>
</span></span><span style="display:flex;"><span>  :type <span style="color:#e6db74">&#39;integer</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defcustom cursor-heatmap-grid-height <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Height of the heatmap grid (number of rows).&#34;</span>
</span></span><span style="display:flex;"><span>  :type <span style="color:#e6db74">&#39;integer</span>
</span></span><span style="display:flex;"><span>  :group <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun cursor-heatmap-hello ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Test function to verify package structure.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Cursor heatmap package loaded successfully! Grid size: %dx%d&#34;</span>
</span></span><span style="display:flex;"><span>           cursor-heatmap-grid-width cursor-heatmap-grid-height))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(provide <span style="color:#e6db74">&#39;cursor-heatmap</span>)
</span></span></code></pre></div><h2 id="what-we-ve-accomplished">What We&rsquo;ve Accomplished</h2>
<p>In this first post, we&rsquo;ve established the foundation of our Emacs package:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> <strong>Package structure</strong>: Proper header, metadata, and organization</li>
<li><input checked="" disabled="" type="checkbox"> <strong>Customization system</strong>: User-configurable options with validation</li>
<li><input checked="" disabled="" type="checkbox"> <strong>Naming conventions</strong>: Consistent, collision-free naming</li>
<li><input checked="" disabled="" type="checkbox"> <strong>Basic functionality</strong>: A working, loadable package</li>
<li><input checked="" disabled="" type="checkbox"> <strong>Testing framework</strong>: Simple way to verify our progress</li>
</ul>
<h2 id="next-time">Next Time</h2>
<p>In the next post, we&rsquo;ll dive into the core functionality: tracking cursor position.</p>
<p>We&rsquo;ll explore:</p>
<ul>
<li>How Emacs represents cursor positions</li>
<li>Different coordinate systems (pixels vs. characters)</li>
<li>Setting up our first movement detection</li>
<li>Handling edge cases and error conditions</li>
</ul>
