<p><img src="https://cdn3.brettterpstra.com/uploads/2025/12/apex-header-2-rb.7522.jpg" width="800" height="226" style="margin:0 auto;clear:both;" class="header" /></p>
<p>I think a lot of people using Apex are going to want syntax
highlighting of code blocks. Including a script like
Highlight.js in your HTML output is <em>fine</em>, but I wanted
Apex to be able to directly output HTML with the necessary
spans and tables for highlighting. So, introducing the
<code class="language-plaintext highlighter-rouge">--code-highlight</code> flag.</p>

<h3 id="how-it-works">How It Works</h3>

<p>Rather than bundling a syntax highlighting engine (which
would bloat the binary and require constant updates for new
languages), I decided to leverage external tools that you
probably already have installed.</p>

<p>The new <code class="language-plaintext highlighter-rouge">--code-highlight</code> flag accepts either <code class="language-plaintext highlighter-rouge">pygments</code> or
<code class="language-plaintext highlighter-rouge">skylighting</code> as arguments:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code><span class="c"># Using Pygments (Python-based)</span>
apex <span class="nt">--code-highlight</span> pygments input.md

<span class="c"># Using Skylighting (Haskell-based, used by Pandoc)</span>
apex <span class="nt">--code-highlight</span> skylighting input.md

<span class="c"># Short forms work too</span>
apex <span class="nt">--code-highlight</span> p input.md   <span class="c"># pygments</span>
apex <span class="nt">--code-highlight</span> s input.md   <span class="c"># skylighting</span></code></pre></div></div>

<p>When you specify a highlighter, Apex processes your Markdown
normally, then makes a second pass over the HTML output. It
finds all <code class="language-plaintext highlighter-rouge">&lt;pre&gt;&lt;code&gt;</code> blocks, extracts the raw code
content, pipes it through the external tool, and replaces
the original block with the colorized HTML output.</p>

<h3 id="language-detection">Language Detection</h3>

<p>Apex handles language specification in the standard way
you&rsquo;d expect. Just add the language identifier after the
opening fence:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code><span class="p">```</span><span class="nl">python
</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>

<span class="p">```</span></code></pre></div></div>

<p>The language is extracted from either the
<code class="language-plaintext highlighter-rouge">class="language-XXX"</code> attribute on the code tag or the
<code class="language-plaintext highlighter-rouge">lang="XXX"</code> attribute on the pre tag (depending on how
cmark-gfm formatted it). This language is then passed to the
external highlighter.</p>

<p>If you don&rsquo;t specify a language, both Pygments and
Skylighting will attempt auto-detection. Pygments is
particularly good at this thanks to its <code class="language-plaintext highlighter-rouge">-g</code> (guess) flag.
Skylighting will try its best but may fall back to plain
text for ambiguous code.</p>

<h3 id="line-numbers">Line Numbers</h3>

<p>Sometimes you want line numbers in your code blocks,
especially for tutorials or when referencing specific lines.
The new <code class="language-plaintext highlighter-rouge">--code-line-numbers</code> flag has you covered:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code>apex <span class="nt">--code-highlight</span> pygments <span class="nt">--code-line-numbers</span> input.md</code></pre></div></div>

<p>This passes the appropriate options to the highlighter
(Pygments gets <code class="language-plaintext highlighter-rouge">linenos=1</code>, Skylighting gets the <code class="language-plaintext highlighter-rouge">-n</code> flag).
The result is nicely numbered code that&rsquo;s easy to reference.</p>

<h3 id="automatic-styling-in-standalone-mode">Automatic Styling in Standalone Mode</h3>

<p>When you use <code class="language-plaintext highlighter-rouge">--code-highlight</code> with <code class="language-plaintext highlighter-rouge">--standalone</code> and
don&rsquo;t specify a <code class="language-plaintext highlighter-rouge">--css FILE</code> option, Apex automatically
embeds GitHub-style syntax highlighting CSS in the document
head. This covers all the common class names used by both
Pygments and Skylighting, so your highlighted code looks
great out of the box.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code>apex <span class="nt">--standalone</span> <span class="nt">--code-highlight</span> pygments input.md <span class="o">&gt;</span> output.html</code></pre></div></div>

<p>The embedded CSS uses a clean, GitHub-inspired color scheme
that works well with light backgrounds. Keywords are red,
strings are blue, comments are gray, and so on. If you want
different colors, you can always override with your own
stylesheet using the <code class="language-plaintext highlighter-rouge">--css</code> flag.</p>

<h3 id="multiple-stylesheets">Multiple Stylesheets</h3>

<p>Speaking of stylesheets, another improvement today is that
<code class="language-plaintext highlighter-rouge">--css</code> now accepts multiple files. You can either use the
flag multiple times or pass a comma-separated list:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight fixed"><code><span class="c"># Multiple flags</span>
apex <span class="nt">--standalone</span> <span class="nt">--css</span> base.css <span class="nt">--css</span> syntax.css input.md

<span class="c"># Comma-separated</span>
apex <span class="nt">--standalone</span> <span class="nt">--css</span> base.css,syntax.css,custom.css input.md</code></pre></div></div>

<p>All specified stylesheets are linked in the document head in
the order provided. If you use <code class="language-plaintext highlighter-rouge">--embed-css</code>, all of them
get embedded as inline <code class="language-plaintext highlighter-rouge">&lt;style&gt;</code> blocks.</p>

<h3 id="requirements">Requirements</h3>

<p>You&rsquo;ll need one of the external tools installed and
available in your PATH:</p>

<ul>
  <li>
    <p><strong>Pygments</strong>: Install with <code class="language-plaintext highlighter-rouge">pip install Pygments</code>. The
  <code class="language-plaintext highlighter-rouge">pygmentize</code> binary needs to be accessible.</p>
  </li>
  <li>
    <p><strong>Skylighting</strong>: Install with <code class="language-plaintext highlighter-rouge">cabal install skylighting</code>
  or get it with Homebrew (<code class="language-plaintext highlighter-rouge">brew install skylighting</code>). The
  <code class="language-plaintext highlighter-rouge">skylighting</code> binary needs to be accessible.
If the specified tool isn&rsquo;t found, Apex will print a warning
and leave your code blocks unstyled (but otherwise
functional).</p>
  </li>
</ul>

<h3 id="other-updates">Other Updates</h3>

<p>A few other things landed alongside the syntax highlighting
feature:</p>

<ul>
  <li>
    <p><strong>ANSI art logo</strong> in <code class="language-plaintext highlighter-rouge">--version</code> output, because why not?</p>

    <p><img src="https://brettterpstra.com//uploads/2026/01/Apex-Version-400.jpg" alt="Apex Version" /></p>
  </li>
  <li>
    <p><strong>Test runner badge mode</strong> (<code class="language-plaintext highlighter-rouge">--badge</code>) that outputs just
  the pass/fail count for CI badge generation</p>
  </li>
  <li>
    <p><strong>Improved test output</strong> in errors-only mode now only
  shows suite titles for suites with failures</p>
  </li>
  <li>
    <p><strong>Test infrastructure refactoring</strong> with new suite
  tracking helpers for cleaner, more maintainable tests</p>
  </li>
</ul>

<p>I think the syntax highlighting will be a very useful
feature, at least for people publishing code. Integrating
with external tools means Apex handles the Markdown parsing
and document structure, while battle-tested highlighters
handle the colorization. Best of both worlds.</p>


<p>Like or share this post <a title="This post on Mastodon" target="_blank" href="https://hachyderm.io/users/ttscoff/statuses/115888368589343553">on Mastodon</a>, <a title="Share on Bluesky" target="_blank" href="https://bsky.app/intent/compose?text=Built-in+Syntax+Highlighting+for+Apex%0A%0Ahttps%3A%2F%2Fbrettterpstra.com%2F2026%2F01%2F13%2Fbuilt-in-syntax-highlighting-for-apex%2F">Bluesky</a>, or <a class="twitter" target="_blank" rel="nofollow" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fbrettterpstra.com%2F2026%2F01%2F13%2Fbuilt-in-syntax-highlighting-for-apex%2F&text=Built-in+Syntax+Highlighting+for+Apex&url=https%3A%2F%2Fbrettterpstra.com%2F2026%2F01%2F13%2Fbuilt-in-syntax-highlighting-for-apex%2F&via=ttscoff" title="Tweet this post">Twitter</a>.</p>
<hr style="margin:40px 0">

<p>BrettTerpstra.com is supported by readers like you. <a href="https://brettterpstra.com/support/">Click here if you'd
        like to help out.</a></p>
<p>Find Brett on <a rel="me" href="https://hachyderm.io/@ttscoff">Mastodon</a>, <a
        href="https://bsky.app/profile/ttscoff.bsky.social">Bluesky</a>, <a
        href="https://github.com/ttscoff">GitHub</a>, and <a href="https://brettterpstra.com/elsewhere">everywhere
        else</a>.</p><img src="https://brett.trpstra.net/link/535/17252486.gif" height="1" width="1"/>