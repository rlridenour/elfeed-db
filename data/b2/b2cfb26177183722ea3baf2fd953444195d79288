
	
<p>
Prime numbers are the engine of the Internet economy. There is no algorithm that can generate these numbers which makes them ideal for as encryption keys. This impossibility has not stopped mathematicians from trying to find formulas to generate prime numbers. Project Euler 27 deals with quadratic formulas that can be used to generate sets of prime numbers.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 27 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>Euler discovered the remarkable quadratic formula: \(n^2+n+41\)</p>
<p>
It turns out that the formula will produce 40 primes for the consecutive integer values \(0 \leq n \leq 39\). However, when \(n=40\), \(40^2+40+41=40(40+1)+41\) is divisible by 41, and certainly when \(n=41\), \(41^2+41+41\) is clearly divisible by 41.</p>
<p>
The incredible formula \(n^2-79n+1601\) produces 80 primes for the consecutive values \(0 \leq n \leq 79\). The product of the coefficients, -79 and 1601, is -126479.</p>
<p>
Considering quadratics of the form: </p>
<p>
\(n^2 + an + b\), where \(|a| &lt; 1000\) and \(|b| \leq 1000\).</p>
<p>
\(|n|\) is the absolute value of \(n\), e.g. \(|11|=11\) and \(|-4|=4\).</p>
<p>
Find the <a href="https://projecteuler.net/problem=27">product of the coefficients</a>, \(a\) and \(b\), for the quadratic expression that produces the maximum number of primes for consecutive values of \(n\), starting with \(n=0\).</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>The only way to solve this problem is through brute force and search for all possible combinations for \(a\) and \(b\). Without reducing the search space, that would mean testing four million options. We need to reduce the solution space to achieve a manageable running speed.</p>
<p>
Because the outcome of the equation must be prime for \(n = 0\), \(b\) also has to be prime. We can use the prime sieve from <a href="https://lucidmanager.org/data-science/project-euler-3/">Euler Problem 3</a> to use only prime numbers from 2 to 1000, which reduces it from 2000 to 168 permutations. </p>
<p>
When we insert \(n = 1\), it follows that \(a\) has to be an even number. If \(1+a+b\) has to be prime and \(b\) is a prime number, then \(a\) can only be an odd number. However, when \(b = 2\), \(a\), also has to be even.</p>
<p>
We can use these deliberations to write some code to solve this problem. We cycle through \(a\) and \(b\) and increment a counter every time we find a prime number. The <code class="verbatim">is.prime()</code> function from <a href="https://lucidmanager.org/data-science/project-euler-7/">Project Euler 7</a> helps to identify whether a number is prime.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 27: Quadratic Primes</span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">source</span>(<span style="background-color:#fff0f0">&#34;problem007.R&#34;</span>, verbose <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  seq.a <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">seq</span>(<span style="color:#60e;font-weight:bold">-999</span>, <span style="color:#60e;font-weight:bold">1001</span>, <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#888"># a has to be odd</span>
</span></span><span style="display:flex;"><span>  seq.b <span style="color:#333">&lt;-</span> (<span style="color:#06b;font-weight:bold">esieve</span>(<span style="color:#60e;font-weight:bold">1000</span>)) <span style="color:#888"># b has to be prime</span>
</span></span><span style="display:flex;"><span>  max.n <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">for</span> (a <span style="color:#080;font-weight:bold">in</span> seq.a) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">for</span> (b <span style="color:#080;font-weight:bold">in</span> seq.b) {
</span></span><span style="display:flex;"><span>      n <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span> <span style="color:#888"># Find sequence of primes for a and b</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">while</span> (<span style="color:#06b;font-weight:bold">is.prime</span>(n^2 <span style="color:#333">+</span> a <span style="color:#333">*</span> n <span style="color:#333">+</span> b)) {
</span></span><span style="display:flex;"><span>        n <span style="color:#333">&lt;-</span> n <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#888">## Store maximum values</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (n <span style="color:#333">&gt;</span> max.n) {
</span></span><span style="display:flex;"><span>        max.n <span style="color:#333">&lt;-</span> n
</span></span><span style="display:flex;"><span>        max.a <span style="color:#333">&lt;-</span> a
</span></span><span style="display:flex;"><span>        max.b <span style="color:#333">&lt;-</span> b
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> max.a <span style="color:#333">*</span> max.b
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Test the answer</span>
</span></span><span style="display:flex;"><span>  n <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span><span style="color:#333">:</span>(max.count <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">sapply</span>(n^2 <span style="color:#333">+</span> max.a <span style="color:#333">*</span> n <span style="color:#333">+</span> max.b, is.prime)</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>

      