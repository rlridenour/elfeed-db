<p>Having watched the <a href="https://www.youtube.com/watch?v%3DY1-RLAl7iOI">video</a>, some takeaways:</p>
<h2>Single GOPATH</h2>
<h3>$GOPATH/src/github.com/soundcloud/foo</h3>
<h2>Repo structure</h2>
<h3>github.com/soundcloud/whatever</h3>
<ol>
<li>
<p>README.md</p>
</li>
<li>
<p>Makefile</p>
</li>
<li>
<p>main.go</p>
</li>
<li>
<p>support.go</p>
</li>
<li>
<p>foo</p>
<ol>
<li>
<p>foo.go</p>
</li>
<li>
<p>bar.go</p>
</li>
</ol>
</li>
<li>
<p>whatever-server</p>
<ol>
<li>main.go</li>
</ol>
</li>
<li>
<p>wharever-worker</p>
<ol>
<li>main.go</li>
</ol>
</li>
</ol>
<h2>Formatting and style</h2>
<h3>Use gofmt.</h3>
<h3>Google's codereview <a href="https://github.com/golang/go/wiki/CodeReviewComments">guidelines</a>.</h3>
<h3>Avoid named return parameters.</h3>
<h3>Avoid make and new (unless you know sizes).</h3>
<h3>Use struct{} for sentinel values: sets, signal chans.</h3>
<ol>
<li>
<p>Conveys no information in it this part.</p>
</li>
<li>
<p>Instead of empty interface.</p>
</li>
<li>
<p>instead of boolean.</p>
</li>
</ol>
<h3>Break long lines at parameters</h3>
<ol>
<li>
<p>No need to compact.</p>
</li>
<li>
<p>Keep trailing coma in last argument.</p>
</li>
</ol>
<h3>Flags</h3>
<pre><code class="language-go">func main() {
  var (
    foo = flags.String(&quot;foo\n&quot;, &quot;doch\n&quot;, &quot;...&quot;)
    bar = flat.Int(&quot;bar\n&quot;, 34, &quot;...&quot;)
  )
  flag.Parse()
  // ...
}
</code></pre>
<h3>Logging</h3>
<ol>
<li>
<p>package log</p>
</li>
<li>
<p>Telemetry</p>
</li>
<li>
<p>Push model (gets expensive over time)</p>
<ol>
<li>
<p>Graphite</p>
</li>
<li>
<p>Statsd</p>
</li>
<li>
<p>AirBrake</p>
</li>
</ol>
</li>
<li>
<p>Pull model (chosen)</p>
<ol>
<li>
<p>expvar</p>
</li>
<li>
<p>Prometheus</p>
</li>
</ol>
</li>
</ol>
<h3>Testing</h3>
<ol>
<li>
<p>package testing</p>
<ol>
<li>
<p>Unit tests</p>
</li>
<li>
<p>reflect.DeepEqual</p>
</li>
</ol>
</li>
<li>
<p>Integration</p>
<ol>
<li>
<p>Use flags for starting services</p>
</li>
<li>
<p>// +build integration</p>
</li>
</ol>
</li>
</ol>
<h3>Code validation</h3>
<ol>
<li>
<p>On Save</p>
<ol>
<li>
<p>Go fmt</p>
</li>
<li>
<p>Go import (go fmt++)</p>
</li>
</ol>
</li>
<li>
<p>On Build</p>
<ol>
<li>
<p>Go vet</p>
</li>
<li>
<p>Golint</p>
</li>
<li>
<p>Go test</p>
</li>
</ol>
</li>
<li>
<p>On Deploy</p>
<ol>
<li>go test -tags=integration</li>
</ol>
</li>
<li>
<p>GoCov?</p>
</li>
</ol>
<h3>Dependency management</h3>
<ol>
<li>
<p>Unimportant projects</p>
<ol>
<li>go get -d (and hope)</li>
</ol>
</li>
<li>
<p>Important</p>
<ol>
<li>
<p>VENDOR (ie. copy into your repo)</p>
<ol>
<li>
<p>Git submodules (no!).</p>
</li>
<li>
<p>Git subtrees (seem OK).</p>
</li>
<li>
<p>Tool (godep?).</p>
</li>
<li>
<p>Build</p>
</li>
<li>
<p>For binaries (use _vendor subdir)</p>
</li>
</ol>
</li>
</ol>
</li>
</ol>
