<p>With a new update of <a href="https://github.com/kickingvegas/scrim/releases/tag/scrim_1.1.0.23">Scrim v1.1.0</a> on the <a href="https://apps.apple.com/us/app/scrim/id6744040981">App Store</a>, it seems an opportune time to show a nice macOS Shortcut integration with it.</p>
<p>The use case is this: You're on your Mac, working on something else <em>other</em> than Emacs (it happens!) and you want to make a quick note in an Org file without having to context switch to Emacs.</p>
<p>You can accomplish this with a <a href="https://support.apple.com/guide/shortcuts-mac/intro-to-shortcuts-apdf22b0444c/mac">macOS Shortcut</a>. Shortcuts is an Apple tool that lets you orchestrate different apps to achieve a custom workflow.</p>
<p>Shown below is the shortcut named “Make Note Entry” to accomplish the above use case. It will:</p>
<ol>
<li>Prompt the user to enter text.</li>
<li>Run a Python script on that text and construct an Org protocol capture request with it using the template named "note".</li>
<li>Issue (open) the Org protocol request.</li>
</ol>
<p align="center">
<img src="http://yummymelon.com/devnull/images/capture-org-note-shortcuts/org-note-shortcut_resize_1280x.png" width="60%"/>
</p>

<p>If the shortcut is configured so that “Pin in Menu Bar” is turned on, you will see some variant of its entry in the Shortcuts bar icon menu.</p>
<p align="center">
<img src="http://yummymelon.com/devnull/images/capture-org-note-shortcuts/org-note-shortcut-menu_resize_320x.png" />
</p>

<p>Running the shortcut “Make Note Entry” will prompt you with a dialog where you can enter your note:</p>
<p align="center">
<img src="http://yummymelon.com/devnull/images/capture-org-note-shortcuts/org-note-shortcut-window_resize_500x.png" />
</p>

<p>Pressing the “Done” button will result in the entry being inserted at the top of the file “~/org/notes.org” as shown below. Note however that Emacs is not raised with this shortcut. The screenshot below is only shown to illustrate that the entry is there.</p>
<p align="center">
<img src="http://yummymelon.com/devnull/images/capture-org-note-shortcuts/org-note-shortcut-emacs_resize_1280x.png" width="60%" />
</p>

<h1>Installation</h1>
<p>Want to try this out? Here’s what to do:</p>
<h2>1. Understand Org protocol</h2>
<p>If you don’t already then read up about it at <a href="https://orgmode.org/worg/org-contrib/org-protocol.html">org-protocol.el – Trigger actions in Emacs via a custom URL scheme</a>.</p>
<h2>2. Have Scrim installed and configured</h2>
<p>Learn more about Scrim at <a href="http://yummymelon.com/scrim">http://yummymelon.com/scrim</a>.</p>
<h2>3. Add the capture template “note”</h2>
<p>On the Emacs side, add the following template entry to <code>org-capture-templates</code>. This template named “note” defines an entry with a heading that has an inactive Org timestamp (“%U”) and the body containing the entered text (“%i”). The destination of this note entry is in the file “~/org/notes.org”</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="s">&quot;note&quot;</span>
<span class="w"> </span><span class="s">&quot;Note (Org Protocol)&quot;</span>
<span class="w"> </span><span class="nv">entry</span>
<span class="w"> </span><span class="p">(</span><span class="nv">file</span><span class="w"> </span><span class="s">&quot;~/org/notes.org&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="p">(</span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="nb">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">             </span><span class="p">(</span><span class="nv">string-join</span>
<span class="w">              </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;* %U&quot;</span>
<span class="w">                </span><span class="s">&quot;%i&quot;</span><span class="p">)</span>
<span class="w">              </span><span class="s">&quot;\n&quot;</span><span class="p">)))</span>
<span class="w"> </span><span class="nb">:prepend</span><span class="w"> </span><span class="no">t</span>
<span class="w"> </span><span class="nb">:immediate-finish</span><span class="w"> </span><span class="no">t</span>
<span class="w"> </span><span class="nb">:empty-lines-after</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>Observe that this template uses the keys <code>:immediate-finish</code> to not make the entry interactive and <code>:prepend</code> to insert the entry at the top of the file.</p>
<h2>4. Add the Shortcut “Make Note Entry”</h2>
<p>Download the shortcut file <a href="http://yummymelon.com/devnull/images/capture-org-note-shortcuts/Make Note Entry.shortcut">Make Note Entry.shortcut</a> and double-click on it to install. It should now be in your Shortcuts collection.</p>
<h2>5. Run “Make Note Entry”</h2>
<p>On the first run of this shortcut, you will be prompted twice to give it permissions: 1) to run the shortcut and 2) to open Scrim. Inspect that its contents correspond with its screenshot above and grant them.</p>
<h1>Closing Thoughts</h1>
<p>Readers are invited to take these ideas and customize them for their own purposes.</p>