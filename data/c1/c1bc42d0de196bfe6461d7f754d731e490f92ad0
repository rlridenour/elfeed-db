<p>I have pushed and tagged the first release candidate, v2.0.0-rc0, of FSet version 2!&nbsp; I'm keeping it in a GitLab Merge Request (MR) for the moment, but I am very much hoping to get some FSet users to try it out and give me some feedback.</p><p>One major change is that sets and maps now use <a href="https://scottlburson2.blogspot.com/2025/09/fset-now-has-champ-sets-and-maps.html">the CHAMP implementations</a> by default.&nbsp; This change should be transparent as long as:</p><ul style="text-align: left;"><li>you haven't written any complex custom <span style="font-family: Inconsolata;">compare</span> methods (if all the method does is call <span style="font-family: Inconsolata;">compare-slots</span>, it can be easily converted to use the new macro <span style="font-family: Inconsolata;">define-equality-slots</span>), and</li><li>you don't care about the ordering of your sets and maps, or in the cases where you do care, you've used the new custom-ordering features.</li></ul><p>The second major change is to the defaulting behavior of maps and seqs.&nbsp; FSet 1 uses a "default default" of <span style="font-family: Inconsolata;">nil</span>, meaning that if you don't supply an explicit default when creating a map or seq, its default is <span style="font-family: Inconsolata;">nil</span>.&nbsp; The default is returned on a map lookup when the supplied key is not in the map; it is returned on a seq lookup when the supplied index is not in bounds (the bounds being 0 up to, but excluding, the size of the seq).</p><p>In FSet 2, there is no default default.&nbsp; If you don't supply an explicit default, the map or seq has no default, and an access attempt will signal an error instead in these cases.&nbsp; So, migrating your code to FSet 2 will probably require a little debugging &mdash; running your test suite, noting when you get one of the new errors, finding the form where the map or seq involved is initially created, and adding <span style="font-family: Inconsolata;">:default nil</span> to the form or wrapping it in <span style="font-family: Inconsolata;">(with-default ... nil)</span>.&nbsp; <b>UPDATE: this decision has been reversed in v2.0.0-rc1.</b>&nbsp;</p><p>Examples:</p><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">;; The map constructor macros accept a default anywhere in the form</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(map)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --&gt;&nbsp; (map :default nil)</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(map ('a 3))&nbsp; &nbsp;--&gt;&nbsp; (map ('a 3) :default nil)</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(replay-map (14 'x) (9 'q)) --&gt; (replay-map :default nil (14 'x) (9 'q))</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">;; The seq constructor macro does not</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(seq 3 1 4)&nbsp; &nbsp; --&gt;&nbsp; (with-default (seq 3 1 4) nil)</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">;; The constructor functions take a :default keyword argument</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(empty-map)&nbsp; &nbsp; --&gt;&nbsp; (empty-map :default nil)</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(empty-seq)&nbsp; &nbsp; --&gt;&nbsp; (empty-seq :default nil)</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">;; Tuples associate defaults with the keys rather than the tuples</span></div><div style="margin-left: 40px; text-align: left;"><span style="font-family: Inconsolata;">(define-tuple-key foo) --&gt; (define-tuple-key foo :default nil)&nbsp;</span></div><p>But, there's good news!&nbsp; You don't have to convert your code if you don't want to.&nbsp; Merely loading FSet 2 doesn't expose your code to these changes; the behavior of names exported from package <span style="font-family: Inconsolata;">fset</span> has mostly not changed.&nbsp; &nbsp;Instead, I've added a new package, <span style="font-family: Inconsolata;">fset2</span>, that exports its own versions of the names with new behavior.&nbsp; So, to use FSet 2, change <span style="font-family: Inconsolata;">:use fset</span> in your defpackage form(s) to <span style="font-family: Inconsolata;">:use fset2</span>.</p><p>(There is one change you will see even if you don't use the new package, having to do with the printing of map and seq defaults.&nbsp; Previously, a nil default would not be printed explicitly; now, it will be, so you'll see things like <span style="font-family: Inconsolata;">##{| (a 3) |}/NIL</span> and <span style="font-family: Inconsolata;">#[ 3 1 4 ]/NIL</span>.)</p><p>For complete details of all changes in this release, <a href="https://gitlab.common-lisp.net/fset/fset/-/merge_requests/2">see the MR</a>.</p><p>So, for anybody who wants to help me out, here's what I ask:</p><ol style="text-align: left;"><li>Clone <a href="https://gitlab.common-lisp.net/fset/fset/-/tree/master">this repo</a>&nbsp;(or <a href="https://github.com/slburson/fset">this one</a>), and in your copy, do:&nbsp;<span style="font-family: Inconsolata;">git checkout fset2</span>.</li><li>If you didn't clone it&nbsp;in <span style="font-family: Inconsolata;">~/quicklisp/local-projects/</span>, arrange for Quicklisp to find this copy, in whatever way you do that (e.g. by pushing the directory pathname onto <span style="font-family: Inconsolata;">asdf:*central-registry*</span>).</li><li>Recompile your client code and test it.&nbsp; If anything doesn't work, please let me know immediately.</li><li>Go into the <span style="font-family: Inconsolata;">:use</span> clause of your <span style="font-family: Inconsolata;">defpackage</span> form(s) and change <span style="font-family: Inconsolata;">fset</span> to <span style="font-family: Inconsolata;">fset2</span>.</li><li>Recompile your client code again, and test it again.&nbsp; This time you may need to make some changes, as discussed above.&nbsp; Let me know how much trouble you have, whether a little or a lot (and especially let me know if you give up).&nbsp; You can post comments in the MR, or in <a href="https://github.com/slburson/fset/issues/86">this GitHub issue</a>.</li></ol><p>Again, this is a release candidate, not yet a release.&nbsp; I've tested it pretty thoroughly, but there could still be bugs.&nbsp; OTOH, if there's something in particular you don't like about it, I may be more willing to make changes than I will be after it's released.&nbsp;</p><p>Share and enjoy!</p><p>&nbsp;</p>