<p>Seems to be a common post at the moment, so I thought I would quickly put out there how I updated to Emacs 30.1.</p>
<p>I use an Arch spin called Garuda, running SwayWM, so as its on wayland, this for me is simple, just update the system using <code>pacman -Syu</code> and <code>emacs-wayland</code> will pull in 30.1 automatically!</p>
<p><img src="https://emacs.dyerdwelling.family/ox-hugo/20250226140529-emacs--Installing-30_1-On-Arch.jpg" alt=""></p>
<p>For my other environments, or if I want to build old versions of Emacs from source, I use the following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Directory for Emacs builds</span>
</span></span><span style="display:flex;"><span>BUILD_ROOT<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/emacs-builds&#34;</span>
</span></span><span style="display:flex;"><span>INSTALL_ROOT<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/emacs-versions&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Build dependencies for different distributions</span>
</span></span><span style="display:flex;"><span>ARCH_BUILD_DEPS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;base-devel gtk2 gtk3 libxpm libjpeg-turbo libpng libtiff giflib libxml2 gnutls librsvg&#34;</span>
</span></span><span style="display:flex;"><span>SLES_BUILD_DEPS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gcc gcc-c++ make automake gtk2-devel gtk3-devel libXpm-devel libjpeg8-devel libpng16-devel libtiff-devel giflib-devel libxml2-devel gnutls-devel cairo-devel harfbuzz-devel librsvg-devel&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 27.2 2021-03-25</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 28.2 2022-09-12</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 29.4 2024-06-22</span>
</span></span><span style="display:flex;"><span>VERSIONS<span style="color:#f92672">=(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;emacs-27.2&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;emacs-28.2&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;emacs-29.4&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;emacs-30.1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Detect OS</span>
</span></span><span style="display:flex;"><span>detect_os<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f /etc/os-release <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        . /etc/os-release
</span></span><span style="display:flex;"><span>        OS<span style="color:#f92672">=</span>$NAME
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        OS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>uname -s<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> prepare_environment<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Creating build directories...&#34;</span>
</span></span><span style="display:flex;"><span>    mkdir -p <span style="color:#e6db74">&#34;</span>$BUILD_ROOT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    mkdir -p <span style="color:#e6db74">&#34;</span>$INSTALL_ROOT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    detect_os
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Detected OS: </span>$OS<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$OS<span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>        *<span style="color:#e6db74">&#34;SLED&#34;</span>*|<span style="color:#e6db74">&#34;SLES&#34;</span>*|*<span style="color:#e6db74">&#34;SUSE&#34;</span>*<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;Installing build dependencies for SUSE SLES...&#34;</span>
</span></span><span style="display:flex;"><span>            sudo zypper refresh
</span></span><span style="display:flex;"><span>            sudo zypper install -y pattern-devel-base-devel
</span></span><span style="display:flex;"><span>            sudo zypper install -y $SLES_BUILD_DEPS
</span></span><span style="display:flex;"><span>            ;;
</span></span><span style="display:flex;"><span>        *<span style="color:#e6db74">&#34;Garuda&#34;</span>*<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;Installing build dependencies for Arch Linux...&#34;</span>
</span></span><span style="display:flex;"><span>            sudo pacman -Syu --needed --noconfirm $ARCH_BUILD_DEPS
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Check if we have yay for AUR access (optional)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ! command -v yay &amp;&gt; /dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>                echo <span style="color:#e6db74">&#34;Installing yay (AUR helper)...&#34;</span>
</span></span><span style="display:flex;"><span>                cd /tmp
</span></span><span style="display:flex;"><span>                git clone https://aur.archlinux.org/yay.git
</span></span><span style="display:flex;"><span>                cd yay
</span></span><span style="display:flex;"><span>                makepkg -si --noconfirm
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>            ;;
</span></span><span style="display:flex;"><span>        *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;Unsupported OS detected: </span>$OS<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;Please install build dependencies manually and continue.&#34;</span>
</span></span><span style="display:flex;"><span>            read -p <span style="color:#e6db74">&#34;Press Enter to continue or Ctrl+C to abort...&#34;</span>
</span></span><span style="display:flex;"><span>            ;;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> build_emacs<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    local version<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>    local build_dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$BUILD_ROOT<span style="color:#e6db74">/</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    local install_dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$INSTALL_ROOT<span style="color:#e6db74">/</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Building </span>$version<span style="color:#e6db74">...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Download and extract</span>
</span></span><span style="display:flex;"><span>    cd <span style="color:#e6db74">&#34;</span>$BUILD_ROOT<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">.tar.gz&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        wget <span style="color:#e6db74">&#34;https://ftp.gnu.org/gnu/emacs/</span>$version<span style="color:#e6db74">.tar.gz&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Clean previous build if exists</span>
</span></span><span style="display:flex;"><span>    rm -rf <span style="color:#e6db74">&#34;</span>$build_dir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    tar xzf <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">.tar.gz&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Configure and build</span>
</span></span><span style="display:flex;"><span>    cd <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Different configure flags for different versions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;emacs-24.5&#34;</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;emacs-25.3&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Older versions use GTK2</span>
</span></span><span style="display:flex;"><span>        ./configure <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --prefix<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$install_dir<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-x-toolkit<span style="color:#f92672">=</span>gtk2 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-xpm <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-jpeg <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-png <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-gif <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-tiff <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-gnutls <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-xml2 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-rsvg
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Newer versions use GTK3</span>
</span></span><span style="display:flex;"><span>        ./configure <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --prefix<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$install_dir<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-x-toolkit<span style="color:#f92672">=</span>gtk3 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-xpm <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-jpeg <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-png <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-gif <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-tiff <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-gnutls <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-xml2 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-cairo <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-harfbuzz <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            --with-rsvg
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Use all available cores for compilation</span>
</span></span><span style="display:flex;"><span>    make -j<span style="color:#66d9ef">$(</span>nproc<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    make install
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74"> installed to </span>$install_dir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> create_pkgbuild<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Only create PKGBUILD for Arch Linux</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$OS<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> *<span style="color:#e6db74">&#34;Arch Linux&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;PKGBUILD creation is only supported on Arch Linux&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    local version<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>    local version_num<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>version#emacs-<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Creating PKGBUILD for </span>$version<span style="color:#e6db74">...&#34;</span>
</span></span><span style="display:flex;"><span>    mkdir -p <span style="color:#e6db74">&#34;</span>$BUILD_ROOT<span style="color:#e6db74">/pkgbuilds/</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    cd <span style="color:#e6db74">&#34;</span>$BUILD_ROOT<span style="color:#e6db74">/pkgbuilds/</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cat &gt; PKGBUILD <span style="color:#e6db74">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Maintainer: Your Name &lt;your.email@example.com&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">pkgname=$version
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">pkgver=$version_num
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">pkgrel=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">pkgdesc=&#34;GNU Emacs version $version_num&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">arch=(&#39;x86_64&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">url=&#34;https://www.gnu.org/software/emacs/&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">license=(&#39;GPL3&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">depends=(&#39;gtk3&#39; &#39;libxpm&#39; &#39;libjpeg-turbo&#39; &#39;libpng&#39; &#39;giflib&#39; &#39;libtiff&#39; &#39;libxml2&#39; &#39;gnutls&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">makedepends=(&#39;base-devel&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">provides=(&#34;emacs-$version_num&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">conflicts=(&#34;emacs&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">source=(&#34;https://ftp.gnu.org/gnu/emacs/emacs-\$pkgver.tar.gz&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sha256sums=(&#39;SKIP&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">build() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    cd &#34;\$srcdir/emacs-\$pkgver&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ./configure \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --prefix=/usr \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --sysconfdir=/etc \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --libexecdir=/usr/lib \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --localstatedir=/var \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-x-toolkit=gtk3 \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-xpm \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-jpeg \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-png \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-gif \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-tiff \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-gnutls \\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        --with-xml2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    make
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">package() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    cd &#34;\$srcdir/emacs-\$pkgver&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    make DESTDIR=&#34;\$pkgdir&#34; install
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Main execution</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;This script provides two methods to build Emacs:&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;1. Direct compilation (traditional)&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;2. Using makepkg (Arch Linux only)&#34;</span>
</span></span><span style="display:flex;"><span>read -p <span style="color:#e6db74">&#34;Which method do you prefer? (1/2): &#34;</span> build_method
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> $build_method in
</span></span><span style="display:flex;"><span>    1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        prepare_environment
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> version in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VERSIONS[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>            build_emacs <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create convenience symlinks</span>
</span></span><span style="display:flex;"><span>        mkdir -p <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/bin&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Creating version-specific symlinks...&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> version in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VERSIONS[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>            ln -sf <span style="color:#e6db74">&#34;</span>$INSTALL_ROOT<span style="color:#e6db74">/</span>$version<span style="color:#e6db74">/bin/emacs&#34;</span> <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/bin/emacs-</span><span style="color:#e6db74">${</span>version#emacs-<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        detect_os
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$OS<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> *<span style="color:#e6db74">&#34;Arch Linux&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;makepkg method is only supported on Arch Linux&#34;</span>
</span></span><span style="display:flex;"><span>            exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>        prepare_environment
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> version in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VERSIONS[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>            create_pkgbuild <span style="color:#e6db74">&#34;</span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;PKGBUILD created for </span>$version<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            echo <span style="color:#e6db74">&#34;To build, cd to </span>$BUILD_ROOT<span style="color:#e6db74">/pkgbuilds/</span>$version<span style="color:#e6db74"> and run &#39;makepkg -si&#39;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Invalid option selected&#34;</span>
</span></span><span style="display:flex;"><span>        exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        ;;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Build complete. You can run specific versions using:&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> version in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VERSIONS[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;emacs-</span><span style="color:#e6db74">${</span>version#emacs-<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div>