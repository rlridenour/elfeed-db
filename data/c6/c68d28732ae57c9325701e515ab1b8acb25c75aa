<p>From Christian Tietze's <a href="https://christiantietze.de/posts/2021/07/open-finder-window-in-dired/">Open macOS Finder Window in Emacs Dired</a>, I learned about <a href="https://github.com/kaz-yos/reveal-in-osx-finder">reveal-in-osx-finder</a>. This is handy for the few times I want to transition from Emacs to Finder for file management. I say few times since Emacs's directory editor, <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html">dired</a>, is just awesome. I've written about dired customizations <a href="https://xenodium.com/showhide-emacs-dired-details-in-style/">here</a> and <a href="https://xenodium.com/showhide-emacs-dired-details-in-style/">here</a>, but since dired is <em>just another buffer,</em> you can apply your Emacs magic like multiple cursors to <a href="https://xenodium.com/batch-renaming-with-counsel-find-dired-and-wdired/">batch rename files in an editable dired buffer</a>.</p>
<p>To transition from macOS Finder to Emacs, Christian offers an Emacs interactive command that fetches Finder's location and opens a dired buffer via AppleScript. On a similar note, I learned from redditor <a href="https://www.reddit.com/user/pndc/">u/pndc</a> that <a href="https://www.reddit.com/r/emacs/comments/ohgz0s/open_macos_finder_windows_path_in_dired/h4p8a8f?utm_source=share&amp;utm_medium=web2x&amp;context=3">Finder's proxy icons can be dragged over to Emacs</a>, which handily drops ya into a dired buffer.</p>
<p>With these two solutions in mind, I looked into a third one to offer a context menu option in Finder to show the file in Emacs. This turned out to be fairly easy using Automator, which I've rarely used.</p>
<p><img src="https://xenodium.github.io/images/show-in-finder--show-in-emacs/show_in_emacs.gif" alt=""></p>
<p>I created a flow that runs a shell script to &quot;Show in Emacs&quot;, revealing the selected file or folder in an dired buffer. This is similar to Christian's solution, but invoked from Finder itself. The flow also uses <em>dired-goto-file</em> which moves the point (cursor) to the file listed under dired.</p>
<p><img src="https://xenodium.github.io/images/show-in-finder--show-in-emacs/show_in_emacs.png" alt=""></p>
<pre><code class="language-{.bash">current_dir=$(dirname &quot;$1&quot;)
osascript -e 'tell application &quot;Emacs&quot; to activate'
path/to/emacsclient --eval &quot;(progn (dired \&quot;$current_dir\&quot;) (dired-goto-file \&quot;$1\&quot;))&quot;
</code></pre>
<p>As a bonus, I added an &quot;Open in Emacs&quot; option, which does as it says on the tin. Rather than show the file listed in a dired buffer, it gets Emacs to open it in your favorite major mode. This option is not technically needed since Finder already provides an &quot;Open With&quot; context menu, but it does remove a few click here and there.</p>
<p><img src="https://xenodium.github.io/images/show-in-finder--show-in-emacs/open_in_emacs.png" alt=""></p>
<pre><code class="language-{.bash">osascript -e 'tell application &quot;Emacs&quot; to activate'
/Users/alvaro/homebrew/bin/emacsclient --eval &quot;(find-file \&quot;$1\&quot;)&quot;
</code></pre>
<p>On a side note, Emacs defaults to creating new frames when opening files via &quot;Open With&quot; menu (or &quot;open -a Emacs foo.txt&quot;). I prefer to use my existing Emacs frame, which can be accomplished by setting ns-pop-up-frames to nil.</p>
<pre><code class="language-{.commonlisp">(setq ns-pop-up-frames nil)
</code></pre>
