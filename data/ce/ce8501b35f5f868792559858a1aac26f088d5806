<p>I&rsquo;ve been doing a lot of SQLite migrations, and I&rsquo;ve learned that this doesn&rsquo;t
work in SQLite.</p>
<pre><code>CREATE TABLE newspapers (
    id INTEGER PRIMARY KEY,
    editor_id INTEGER,
    FOREIGN KEY (editor_id) REFERENCES users(id)
);
ALTER TABLE newspapers DROP COLUMN editor_id;
</code></pre>
<p>It fails with this error:</p>
<pre><code>error in table newspapers after drop column:
unknown column &quot;editor_id&quot; in foreign key definition
</code></pre>
<p>Instead you have to create a new table, copy over the data, and rename it. The SQLite docs have <a href="https://www.sqlite.org/lang_altertable.html#making_other_kinds_of_table_schema_changes">a 12-step process for recreating tables like this</a>,
and there&rsquo;s a great <a href="https://simonwillison.net/2020/Sep/23/sqlite-advanced-alter-table/">blog post by Simon Willison</a>.</p>
