
	
<p>
Project Euler 20 is the third problem that requires special consideration for working with huge integers. In this problem, we look at factorials. These numbers are useful in combinatorics if, for example, you like to know in how many ways you can arrange a deck of cards.</p>
<p>
The problem with computing factorials is that they are mostly vast numbers, beyond the generic capabilities of computers to process. For example, a humble pack of playing cards can be shuffled in \(52! = 80658175170943878571660636856403766975289505440883277824000000000000\) different configurations.</p>
<p>
The largest number traditional handheld calculators can factorise is the mythical number 69. </p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/kw6l_uTakRA?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
69! - Numberphile.
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 20 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>\(n!\) means \(n \times (n âˆ’ 1) \times \ldots \times 3 \times 2 \times 1\)</p>
<p>
For example, \(10! = 10 \times 9 \times \ldots \times 2 \times 1 = 3628800\),
and the sum of the digits in the number \(10!\) is \(3 + 6 + 2 + 8 + 8 + 0 + 0 = 27\).</p>
<p>
Find the <a href="https://projecteuler.net/problem=20">sum of the digits in the number 100!</a></p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Proposed Solution
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>The factorial of the number 100 contains 158 digits, which is a lot more digits than a 64-bit operating system can accurately produce. Using the standard function: <code class="verbatim">factorial(100) = 9.332622e+157</code>. Without using a specialised algorithm, we cannot determine the sum of all digits. We need to deploy arbitrary-precision arithmetic to solve this problem.</p>
<p>
This problem can be solved using a specialised R package and using only base-R code. Many computer languages, including R, have special libraries to deal with such large numbers. The <a href="https://cran.r-project.org/web/packages/gmp/index.html">GMP package</a> renders this problem almost trivial.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 20: Factorial Digit Sum</span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(gmp)
</span></span><span style="display:flex;"><span>  digits <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">factorialZ</span>(<span style="color:#60e;font-weight:bold">100</span>)
</span></span><span style="display:flex;"><span>  digits <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">as.character</span>(digits)
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">as.numeric</span>(<span style="color:#06b;font-weight:bold">unlist</span>(<span style="color:#06b;font-weight:bold">strsplit</span>(digits, <span style="background-color:#fff0f0">&#34;&#34;</span>))))
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Using base-R code
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>The problem becomes more interesting when only using basic R code. I developed the big.add function to solve Euler Problem 13 through the addition of very large integers. We can extend this function to also calculate factorials. A factorial can be replaced by a series of additions, for example:</p>
<p>
$$3! = 1 \times 2 \times 3 = (((1+1) + (1+1)) + (1+1))$$</p>
<p>
This can be mimicked in R using the Reduce function. This function reduces a vector to a single value by recursively calling a function. <code class="verbatim">Reduce(&#34;+&#34;, rep(4, 5))</code> is the same as:</p>
<p>
$$4 \times 5 = ((((4 + 4) + 4) + 4) + 4) = 20$$</p>
<p>
Using a loop, we can use the Reduce function to calculate a factorial, using only additions:</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#888">## Base-R Code</span>
</span></span><span style="display:flex;"><span>fact <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>x <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">2</span><span style="color:#333">:</span>x) {
</span></span><span style="display:flex;"><span>    fact <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">Reduce</span>(<span style="background-color:#fff0f0">&#34;+&#34;</span>, <span style="color:#06b;font-weight:bold">rep</span>(fact, i))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#06b;font-weight:bold">print</span>(fact)</span></span></code></pre></div>
</div>
<p>
The <code class="verbatim">big.factorial()</code> function below implements this idea by combining the <code class="verbatim">big.add()</code> and <code class="verbatim">Reduce()</code> functions to calculate large integer factorials. The function returns a value of 1, for factorial of 0 or 1. This function does not calculate the Gamma-function for fractions. For all other values, it goes through a loop from 2 to the requested factorial. The temporary values are stored in the bf variable. The code loops through the factorials by using the result of the previous Reduce call into the current one.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">source</span>(<span style="background-color:#fff0f0">&#34;problem013.R&#34;</span>, echo <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">FALSE</span>)
</span></span><span style="display:flex;"><span>  big.factorial <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(x) {
</span></span><span style="display:flex;"><span>      x <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(x)
</span></span><span style="display:flex;"><span>      bf <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (x <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> <span style="color:#60e;font-weight:bold">2</span><span style="color:#333">:</span>x) {
</span></span><span style="display:flex;"><span>              bf <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">Reduce</span>(big.add, <span style="color:#06b;font-weight:bold">rep</span>(bf,i))
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">return</span> (bf)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  digits <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">big.factorial</span>(<span style="color:#60e;font-weight:bold">100</span>)
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">as.numeric</span>(<span style="color:#06b;font-weight:bold">unlist</span>(<span style="color:#06b;font-weight:bold">strsplit</span>(<span style="color:#06b;font-weight:bold">as.character</span>(digits), <span style="background-color:#fff0f0">&#34;&#34;</span>))))
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>

</div>
</div>
</div>
</div>

      