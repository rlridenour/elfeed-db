<p>I don’t want to give you the impression that I get all my blogging ideas from Jason Snell, but here’s the second one this week. It was inspired by <a href="https://sixcolors.com/post/2025/08/get-started-with-folder-automation-in-macos-tahoe/">his post this morning</a> about using the new folder automation feature in macOS 26. After bookmarking the article so I can refer to it after upgrading to 26, I started thinking about how he and Dan Moren went about extracting the name of a file’s enclosing folder from its full path name.</p>
<p>They went about it in basically the same way: splitting the Unix path string on slash characters. The difference was that while Dan was happy to get the full path to the enclosing folder, Jason wanted just the enclosing folder’s name. For example, for a file named</p>
<pre><code>/Users/jsnell/Desktop/Drop It Here/Markdown File.md
</code></pre>
<p>Dan wanted</p>
<pre><code>/Users/jsnell/Desktop/Drop It Here
</code></pre>
<p>whereas Jason wanted</p>
<pre><code>Drop It Here
</code></pre>
<p>Their solutions were Shortcuts-native, by which I mean they used Shortcuts actions only—no “outside” calls to AppleScript or the shell or any other scripting language. But I immediately thought of using the shell’s <a href="https://leancrew.com/all-this/man/man1/dirname.html"><code>dirname</code> and <code>basename</code> commands</a> to replace their <span class="menu">Split</span> and <span class="menu">Replace</span> actions.</p>
<p>It wasn’t hard to do, but I thought it was clumsy because <code>dirname</code> and <code>basename</code> don’t use standard input, so I couldn’t just pipe the output of one to the other. (<code>dirname</code> by itself would give me Dan’s solution, but I wanted to make my life harder by replicating Jason’s solution.)</p>
<p>A cleaner approach came from <a href="https://zsh.sourceforge.io/Doc/Release/Expansion.html#Modifiers"><code>zsh</code>’s modifiers</a>, suffixes you can append to pull out parts of a file path. Recent versions of <code>bash</code> also have modifiers, but not the old version that Apple supplies with macOS.</p>
<p>Because I’m not running macOS 26, I couldn’t build a folder automation Shortcut, but here’s a proof-of-concept Shortcut named <span class="menu">Enclosing Folder Name</span> that runs as a Quick Action on selected files in the Finder.</p>
<p><img alt="Enclosing Folder Name Shortcut" class="ss" src="https://leancrew.com/all-this/images2025/20250815-Enclosing%20Folder%20Name%20Shortcut.png" title="Enclosing Folder Name Shortcut" width="100%"/></p>
<p>For each selected file, the full path is passed as the argument to this script,</p>
<pre><code>echo ${1:h:t}
</code></pre>
<p>and the output is displayed in a window.</p>
<p><code>$1</code> is the first (and only) argument to the script. The <code>:h</code> modifier pulls out the “head” of the path, which is the path to the enclosing folder. The <code>:t</code> modifier returns the “tail” of that, which is just the name of the enclosing folder. <a href="https://zsh.sourceforge.io/Doc/Release/Expansion.html#Brace-Expansion">Brace expansion</a> isn’t necessary in this case, but I tend to use it when doing anything more complicated than just referencing a variable.</p>
<p>As you can see in the Shortcuts sidebar, this is saved as a Quick Action that’s meant to be invoked from the context menu in the Finder.</p>
<p>To test it, I added a <code>Drop It Here</code> folder to my Desktop and put two files in it: <code>Markdown File.md</code> and <code>Another Markdown File.md</code>. Note that I’ve included spaces in both the file names and the folder name to see whether that screws up the shell script. Here’s me calling the Quick Action from the context menu,</p>
<p><img alt="Invoking the Shortcut from the context menu" class="ss" src="https://leancrew.com/all-this/images2025/20250815-Invoking%20the%20Shortcut%20from%20the%20context%20menu.png" title="Invoking the Shortcut from the context menu" width="100%"/></p>
<p>and here’s the window that appears twice, once for each of the selected files,</p>
<p><img alt="Results window from the Shortcut" class="ss" src="https://leancrew.com/all-this/images2025/20250815-Results%20window%20from%20the%20Shortcut.png" title="Results window from the Shortcut" width="70%"/></p>
<p>So it works. And if I’d wanted to replicate Dan’s approach, I would’ve used just</p>
<pre><code>echo ${1:h}
</code></pre>
<p>in the shell script.</p>
<p>This is not an improvement on Jason’s or Dan’s work. I wouldn’t disagree if you said it was worse than their Shortcuts because it’s more cryptic. Far more people know that directories are separated by slashes than know about <code>:h</code> and <code>:t</code>. But it was fun to reacquaint myself with modifiers.</p>
