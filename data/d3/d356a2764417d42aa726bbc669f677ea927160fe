<p><a href="https://twitter.com/safijari">Jari Safi</a> published a wonderful Emacs video <a href="https://youtu.be/xmBovJvQ3KU">demoing python yasnippets in action</a>. The constructor snippet, automatically setting ivars, is just magical. I wanted it for Swift!</p>
<p>I took a look at the <a href="https://github.com/jorgenschaefer/elpy/blob/060a4eb78ec8eba9c8fe3466c40a414d84b3dc81/snippets/python-mode/__init__">[[init]{.underline}]{.underline} snippet</a> from <a href="https://github.com/jorgenschaefer">Jorgen Schäfer</a>'s <a href="https://github.com/jorgenschaefer/elpy">elpy</a>. It uses <a href="https://github.com/jorgenschaefer/elpy/blob/060a4eb78ec8eba9c8fe3466c40a414d84b3dc81/snippets/python-mode/.yas-setup.el#L33">elpy-snippet-init-assignments</a> to generate the assignments.</p>
<p>With small tweaks, we can get the same action going on for Swift ø/</p>
<p><img src="https://xenodium.github.io/images/smarter-snippets/snippet.gif" alt=""></p>
<p>init.yasnippet:</p>
<pre><code class="language-snippet"># -*- mode: snippet -*-
# name: init with assignments
# key: init
# --
init(${1:, args}) {
  ${1:$(swift-snippet-init-assignments yas-text)}
}
$0
</code></pre>
<p>.yas-setup.el:</p>
<pre><code class="language-{.commonlisp">(defun swift-snippet-init-assignments (arg-string)
  (let ((indentation (make-string (save-excursion
                                    (goto-char start-point)
                                    (current-indentation))
                                  ?\s)))
    (string-trim (mapconcat (lambda (arg)
                              (if (string-match &quot;^\\*&quot; arg)
                                  &quot;&quot;
                                (format &quot;self.%s = %s\n%s&quot;
                                        arg arg indentation)))
                            (swift-snippet-split-args arg-string)
                            &quot;&quot;))))

(defun swift-snippet-split-args (arg-string)
  (mapcar (lambda (x)
            (if (and x (string-match &quot;\\([[:alnum:]]*\\):&quot; x))
                (match-string-no-properties 1 x)
              x))
          (split-string arg-string &quot;[[:blank:]]*,[[:blank:]]*&quot; t)))
</code></pre>
