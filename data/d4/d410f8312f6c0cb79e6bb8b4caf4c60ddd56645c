
	
<p>
Project Euler 2 looks at Fibonacci numbers. This number sequence seems to describe our sense of natural beauty and aesthetics. The spiral staircase uses Fibonacci numbers as part of its geometry. Euler Problem 2 is a bit less poetic as it only asks to generate and sum even numbers. <a href="https://lucidmanager.org/data-science/project-euler-25/">Euler Problem 25</a> also deals with Fibonacci numbers and asks to find the first such number with 1000 digits.</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 2 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:</p>
<p>
$1, 2, 3, 5, 8, 13, 21, 34, 55, 89, \ldots$</p>
<p>
By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the <a href="https://projecteuler.net/problem=2">sum of the even-valued terms</a>.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Euler Problem 2 Solution in R
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>The code generates Fibonacci numbers until it reaches the value of four million. The code then sums the even numbers in the sequence. </p>
<p>
The intuitive way to calculate Fibonacci numbers is to use a recursive function. This function calls itself until it reaches the first two numbers.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Project Euler 2: Sum of Even Fibonacci Numbers</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#888">## Recursive function</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  fib <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(n) {
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (n <span style="color:#333">&lt;=</span> <span style="color:#60e;font-weight:bold">2</span>) <span style="color:#080;font-weight:bold">return</span>(<span style="color:#60e;font-weight:bold">1</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">fib</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">fib</span>(n <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">2</span>))
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">fib</span>(<span style="color:#60e;font-weight:bold">15</span>)</span></span></code></pre></div>
</div>
<p>
This function calculates the \(n^{th}\) Fibonacci number by calling itself with a reduced index until it reaches 1. Recursive functions are, however, very memory hungry and not very fast. A much faster method is to create a vector of Fibonacci numbers and add the even ones. The code below generates Fibonacci numbers until it reaches the value of four million. The code then sums the even numbers in the sequence.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Sequential function</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">1</span>, <span style="color:#60e;font-weight:bold">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">while</span> (<span style="color:#06b;font-weight:bold">max</span>(fib) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">4E+06</span>) {
</span></span><span style="display:flex;"><span>      len <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">length</span>(fib)
</span></span><span style="display:flex;"><span>      fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(fib, fib[len <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">1</span>] <span style="color:#333">+</span> fib[len])
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sum</span>(fib[fib <span style="color:#333">%%</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>])
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Using the GMP Package
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>A series of R packages exist to generate Fibonacci numbers. The <a href="https://cran.r-project.org/web/packages/gmp/index.html">GMP package</a> for Multiple Precision Arithmetic provides the <code class="verbatim">fibnum()</code> function to calculate the n^th Fibonacci number. This package is also able to work with huge numbers. Using this package is much faster than the base R code used above. Interestingly, the GMP library uses tables for Fibonacci numbers up to twelve quintillion (10<sup>18</sup>).</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888"># Using the GMP Package</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(gmp)
</span></span><span style="display:flex;"><span>  i <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">fibnum</span>(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">while</span> (fib <span style="color:#333">&lt;=</span> <span style="color:#60e;font-weight:bold">4E6</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (fib <span style="color:#333">%%</span> <span style="color:#60e;font-weight:bold">2</span> <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>      answer <span style="color:#333">&lt;-</span> answer <span style="color:#333">+</span> fib
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    i <span style="color:#333">&lt;-</span> i <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">fibnum</span>(i)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Analytic Solution
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>An analytical solution prevents using recursion and a brute force method to find the answer. Binet&#39;s formula for the n^th Fibonacci number lets us determine a Fibonacci number without recursion:</p>
<p>
$$F_n=\frac{\varphi^n-\frac{1}{(-\varphi)^n}}{\sqrt{5}}$$</p>
<p>
We know that $\varphi$ is the Golden Ratio, so we can simplify this formula:</p>
<p>
$$F_n\sqrt{5}=\frac{(1+\sqrt{5})^n}{2^n}$$</p>
<p>
This formula results in a simple function to generate a sequence of Fibonacci numbers:</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Analytical solution</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  binet <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(n) {
</span></span><span style="display:flex;"><span>    <span style="color:#06b;font-weight:bold">round</span>((((<span style="color:#60e;font-weight:bold">1</span> <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">sqrt</span>(<span style="color:#60e;font-weight:bold">5</span>))^n) <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">2</span>^n) <span style="color:#333">/</span> <span style="color:#06b;font-weight:bold">sqrt</span>(<span style="color:#60e;font-weight:bold">5</span>))
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">binet</span>(<span style="color:#60e;font-weight:bold">1</span><span style="color:#333">:</span><span style="color:#60e;font-weight:bold">10</span>)</span></span></code></pre></div>
</div>
<p>
The <a href="https://math.stackexchange.com/questions/374758/how-can-i-find-an-inverse-to-the-binet-formula">inverse of the Binet formula</a> gives us:</p>
<p>
$n=\left[ \log_\phi \sqrt{5}(F_n-\frac{1}{2}) \right]$ holds for all $n\ge 3$</p>
<p>
This formula allows us to work out which Fibonacci number is less than or equal to 4 million:</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  phi <span style="color:#333">&lt;-</span> (<span style="color:#60e;font-weight:bold">1</span> <span style="color:#333">+</span> <span style="color:#06b;font-weight:bold">sqrt</span>(<span style="color:#60e;font-weight:bold">5</span>)) <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  n_4e6 <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">log</span>(<span style="color:#06b;font-weight:bold">sqrt</span>(<span style="color:#60e;font-weight:bold">5</span>) <span style="color:#333">*</span> (<span style="color:#60e;font-weight:bold">4E6</span> <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">0.5</span>), base <span style="color:#333">=</span> phi))</span></span></code></pre></div>
</div>
<p>
Using this formula, we find that the first 33 Fibonacci numbers are equal or less than four million. Next step is to sum all the even numbers.</p>
<p>
According to the <a href="https://oeis.org/A014445">Online Encyclopedia of Integer Sequences</a> (lemma A014445), every third Fibonacci number is even. We can now use Binet&#39;s formula to sum every third Fibonacci number.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">binet</span>(<span style="color:#06b;font-weight:bold">seq</span>(<span style="color:#60e;font-weight:bold">3</span>, n_4e6, <span style="color:#60e;font-weight:bold">3</span>)))</span></span></code></pre></div>
</div>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>

      