<p>If you want to test webhooks locally you probably use Ngrok or Localtunnel. I do.</p>
<p>Recently I wanted to play with Instagram webhooks and I couldn&rsquo;t because surprisingly
Facebook do not accept Ngrok and Localtunnel URLs anymore and marks them as
<code>malicious and/or abusive</code>.</p>
<p>I don&rsquo;t really understand why Facebook blocked the only known solutions of local webhooks testing.</p>
<p>Fortunately I have a server and a domain name.</p>
<h2 id="solution">Solution</h2>
<p>What we&rsquo;ll need:</p>
<ul>
<li>Nginx</li>
<li>LetsEncrypt cert (because Facebook wants HTTPS URL)</li>
</ul>
<p>As soon as you configured your Nginx and it can accept traffic on port 443
add <code>location</code> section like this (<strong>pay attention to all the slashes. They are important</strong>):</p>
<pre tabindex="0"><code>location /proxy/ {
 proxy_pass http://localhost:3000/;
}
</code></pre><p>This will grab all the traffic to <code>you-domain/proxy/</code>, decrypt it and proxy it to port 3000.</p>
<p>Now, on you local machine, run:</p>
<pre tabindex="0"><code>ssh -R 3000:0.0.0.0:3000 -N user@server
</code></pre><p>Change ports as needed. The very first <code>3000</code> is remote port to redirect traffic from.
The <code>0.0.0.0:3000</code> part is your local server listening on port <code>3000</code> as well.</p>
<p>You local server will get URLs without that <code>/proxy</code> part.
So <code>your-domain/proxy/webhooks</code> will be transformed to <code>0.0.0.0:3000/webhooks</code></p>
<p>Now the traffic goes like this:</p>
<p><code>Origin(https) -&gt; your-domain(https) -&gt; your-server:3000(http) -&gt; your-local-machine:3000(http)</code></p>