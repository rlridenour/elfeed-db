<p>Sometimes in <code>mb_convert_encoding($str, 'UTF-8', 'auto')</code> that latest <code>auto</code> argument won&rsquo;t work.</p>
<p>To find what charset the string is using you can get all possible charsets, convert your <code>$str</code> into that charset and print it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span>(<span style="color:#a6e22e">mb_list_encodings</span>() <span style="color:#66d9ef">as</span> $charset) {
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">mb_convert_encoding</span>($str, <span style="color:#e6db74">&#39;UTF-8&#39;</span>, $charset) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39; ----- &#39;</span> <span style="color:#f92672">.</span> $chr <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>; <span style="color:#ae81ff">2</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This code may not work for some charsets returned by <code>mb_list_encodings()</code>. You can ignore some of them like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span>(<span style="color:#a6e22e">mb_list_encodings</span>() <span style="color:#66d9ef">as</span> $charset) {
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($chr, [<span style="color:#e6db74">&#39;pass&#39;</span>, <span style="color:#e6db74">&#39;wchar&#39;</span>, <span style="color:#e6db74">&#39;byte2be&#39;</span>, <span style="color:#e6db74">&#39;byte2le&#39;</span>, <span style="color:#e6db74">&#39;byte4be&#39;</span>, <span style="color:#e6db74">&#39;byte4le&#39;</span>, <span style="color:#e6db74">&#39;BASE64&#39;</span>, <span style="color:#e6db74">&#39;UUENCODE&#39;</span>, <span style="color:#e6db74">&#39;HTML-ENTITIES&#39;</span>, <span style="color:#e6db74">&#39;Quoted-Printable&#39;</span>, <span style="color:#e6db74">&#39;7bit&#39;</span>, <span style="color:#e6db74">&#39;8bit&#39;</span>])) {
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span> }
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">mb_convert_encoding</span>($str, <span style="color:#e6db74">&#39;UTF-8&#39;</span>, $charset) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39; ----- &#39;</span> <span style="color:#f92672">.</span> $chr <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>; <span style="color:#ae81ff">2</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Of course it&rsquo;s only applicable if you know that <code>$str</code> will always be in the charset you found.</p>