<p><a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> is a little Emacs package I wrote to enable crafting more reusable shell commands. I intended to use it as an <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell.html">async-shell-command</a> alternative (and I do these days). The more surprising win was bringing lots of command-line utilities (sometimes with complicated invocations) and making them quickly accessible. I no longer need to remember their respective parameters, order, flags, etc.</p>
<p>I've migrated most <a href="https://xenodium.com/emacs-password-protect-current-pdf-revisited/">one-liners</a> and <a href="https://xenodium.com/png-to-icns-emacs-dwim-style/">scripts</a> I had to <a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> equivalents. They are available at <a href="https://github.com/xenodium/dwim-shell-command/blob/main/dwim-shell-commands.el">dwim-shell-commands.el</a>. Having said that, it's great to discover new usages from <code>dwim-shell-command</code> users.</p>
<p>Take <a href="https://www.reddit.com/user/TiMueller/">u/TiMueller</a>'s Reddit comment, <a href="https://www.reddit.com/r/emacs/comments/w8s2ov/comment/iq7idav/?utm_source=share&amp;utm_medium=web2x&amp;context=3">showcasing pdftotext</a>. Neat utility I was unaware of. It does as it says on the tin and converts a pdf to text. Can be easily saved to your accessible repertoire with:</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-commands-pdf-to-txt ()
  &quot;Convert pdf to txt.&quot;
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;pdf to txt&quot;
   &quot;pdftotext -layout '&lt;&lt;f&gt;&gt;' '&lt;&lt;fne&gt;&gt;.txt'&quot;
   :utils &quot;pdftotext&quot;))
</code></pre>
<p><img src="https://xenodium.github.io/images/dwim-shell-command-usages-pdftotext-and-scp/pdf-to-txt_x2.webp" alt=""></p>
<p><a href="https://github.com/tareefdev">tareefdev</a> wanted a quick command to <a href="https://linux.die.net/man/1/scp">secure copy</a> remote files to a local directory. Though this use-case is already covered by Tramp, I suspect a DWIM command would make it a little more convenient (async by default). However, Tramp paths aren't usable from the shell unless we massage them a little. We can use <code>dwim-shell-command-on-marked-files</code>'s <code>:post-process-template</code> to drop the &quot;/ssh:&quot; prefix.</p>
<pre><code class="language-{.commonlisp">(defun dwim-shell-commands-copy-remote-to-downloads ()
  (interactive)
  (dwim-shell-command-on-marked-files
   &quot;Copy remote to local Downloads&quot;
   &quot;scp '&lt;&lt;f&gt;&gt;' ~/Downloads/&quot;
   :utils &quot;scp&quot;
   :post-process-template
   (lambda (script file)
     ;; Tramp file path start with &quot;/ssh:&quot;. Drop it.
     (string-replace file
                     (string-remove-prefix &quot;/ssh:&quot; file)
                     script))))
</code></pre>
<p><a href="https://github.com/xenodium/dwim-shell-command">dwim-shell-command</a> is available on <a href="https://melpa.org/#/dwim-shell-command">MELPA</a> (531 downloads as of 2022-10-01).</p>
