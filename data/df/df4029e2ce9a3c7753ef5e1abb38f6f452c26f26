<p><strong>Summary: </strong>
An overview of my present #Emacs mode-line and a walk through of adding an actionable indicator to that mode-line.
</p>
        <p>I’ve long used the <a href="https://www.emacswiki.org/emacs/TypographicalPunctuationMarks">Typopunct Emacs package</a> for things like &ldquo;smart quotes&rdquo;,
em-dashes, and en-dashes.  I eschew rendering minor modes in my mode-line, as
this is chatty and not very helpful.</p>
<p>However, I often find myself toggling <code>typopunct-mode</code> on and off.  Which prompted
me to explore adding an indicator to the mode-line.</p>
<h2 id="before-the-change">Before the Change</h2>
<p>First, lets look at the current anatomy of my mode-line.  It’s rather compact;
though the buffer name, branch name, and function name can make for quite a bit
of text.</p>
<p>While writing this document, the following is my mode-line text:</p>
<p><code>Adding Actionable Indicators to my Emacs Mode Line ¶ “Org” blog-posts  main ⨍ := Before the Change</code></p>
<p>Let’s break this down a bit:</p>
<ul>
<li><code>Adding Actionable Indicators to my Emacs Mode Line</code>: the buffer name.</li>
<li><code>¶</code> indicates I’m in a text-mode.</li>
<li><code>”Org”</code> indicates the major mode is <span><a href="https://orgmode.org/">Org-Mode</a></span> <small><a class="ref" rel="tag opener" aria-label="Other site-wide references of “Org-Mode”" title="Other site-wide references of “Org-Mode”" href="https://takeonrules.com/site-map/glossary/#abbr-dfn-ORG-MODE">&#128214;</a></small>
, and as this is wrapped in quotes
means that I’ve activated <code>typopunct-mode</code> for this buffer.</li>
<li><code>blog-posts</code> is the name of the projectile project.</li>
<li><code> main</code> indicates that the version control branch is <code>main</code>.</li>
<li><code>⨍ := Before the Change</code> is the name of the “function” that contains point.  In
<span>Org-Mode</span>
, that is the containing headline for point.</li>
</ul>
<p>My mode-line conveys more conditional information, so lets look to my
<code>mode-line-format</code>.<small class="side-container">
  <span class="side-label"><span class="hidden">(</span>Sidenote<span class="hidden">:</span></span>
  <span class="side" role="note"> See <a href="https://github.com/jeremyf/dotemacs/blob/1caf9ec7c30479204658704a807d56809ed711c0/emacs.d/init.el#L2319-L2332">Github for more context regarding mode-line-format</a>.<span class="hidden">)</span></span>
</small>
</p>
<pre><code class="language-emacs-lisp">(setq-default mode-line-format
    '(&quot;%e&quot; &quot; &quot;
       jf/mode-line-format/org-clock
       jf/mode-line-format/vterm
       jf/mode-line-format/kbd-macro
       jf/mode-line-format/narrow
       jf/mode-line-format/buffer-name-and-status &quot; &quot;
       jf/mode-line-format/major-mode &quot; &quot;
       jf/mode-line-format/project &quot; &quot;
       jf/mode-line-format/vc-branch &quot; &quot;
       jf/mode-line-format/flymake &quot; &quot;
       jf/mode-line-format/eglot
       jf/mode-line-format/which-function
       ))
</code></pre>
<dl>
<dt><code>jf/mode-line-format/org-clock</code></dt>
<dd>Show an indicator when I have an active <span>Org-Mode</span>
 clock.</dd>
<dt><code>jf/mode-line-format/vterm</code></dt>
<dd>Show when I’m run <code>vterm</code> (and allow me to quickly
toggle copy mode).</dd>
<dt><code>jf/mode-line-format/kbd-macro</code></dt>
<dd>Indicate when I’m recording a keyboard macro.</dd>
<dt><code>jf/mode-line-format/narrow</code></dt>
<dd>Indicate when I’ve narrowed the buffer.</dd>
<dt><code>jf/mode-line-format/buffer-name-and-status</code></dt>
<dd>The name of the buffer and
whether its read-only or not.</dd>
<dt><code>jf/mode-line-format/major-mode</code></dt>
<dd>Indicate the major-mode as well as its type
(e.g. programming mode, text mode, etc).</dd>
<dt><code>jf/mode-line-format/project</code></dt>
<dd>What, if any, is the projectile project name.</dd>
<dt><code>jf/mode-line-format/vc-branch</code></dt>
<dd>What, if any, is the version control branch.
I can click on it to see the <span><a href="https://github.com/magit/magit/">Magit</a></span> <small><a class="ref" rel="tag opener" aria-label="Other site-wide references of “Magit”" title="Other site-wide references of “Magit”" href="https://takeonrules.com/site-map/glossary/#abbr-dfn-MAGIT">&#128214;</a></small>
 status.</dd>
<dt><code>jf/mode-line-format/flymake</code></dt>
<dd>When Flymake is active, show its information.</dd>
<dt><code>jf/mode-line-format/eglot</code></dt>
<dd>When <a href="https://github.com/joaotavora/eglot">eglot</a> is active, show its information.</dd>
<dt><code>jf/mode-line-format/which-function</code></dt>
<dd>Show the name of the “function” at
point.</dd>
</dl>
<h2 id="after-the-change">After the Change</h2>
<p><time datetime="2025-04-07" title="2025-04-07">Yesterday</time>, I set about updating my mode line to show me when <code>typopunct-mode</code> is
on or off.  I also set about making that indicator actionable (e.g. I can click
on it).</p>
<p>Now when <code>typopunct-mode</code> is on, I wrap in smart quotes the major mode name.
(e.g. <code>“Org Mode”</code>) and when it is off, the major mode is not wrapped (e.g. <code>Org Mode</code>).  Further, I can click on the major mode to now toggle the <code>typopunct-mode</code>
state.</p>
<p>I needed a function that would force updating the mode line when the <code>typopunct-mode</code> changed.<small class="side-container">
  <span class="side-label"><span class="hidden">(</span>Sidenote<span class="hidden">:</span></span>
  <span class="side" role="note"> See <a href="https://github.com/jeremyf/dotemacs/blob/1caf9ec7c30479204658704a807d56809ed711c0/emacs.d/init.el#L2601-L2607">Github for more context regarding the jf/toggle-typopunct-mode function</a>.<span class="hidden">)</span></span>
</small>
</p>
<pre><code class="language-emacs-lisp">(defun jf/toggle-typopunct-mode ()
  &quot;Toggle `typopunct-mode'.&quot;
  (interactive)
  (if typopunct-mode
    (typopunct-mode -1)
    (typopunct-mode 1))
  (force-mode-line-update))
</code></pre>
<p>To add a click action to the text, I first needed to define a mode map.<small class="side-container">
  <span class="side-label"><span class="hidden">(</span>Sidenote<span class="hidden">:</span></span>
  <span class="side" role="note"> See <a href="https://github.com/jeremyf/dotemacs/blob/1caf9ec7c30479204658704a807d56809ed711c0/emacs.d/init.el#L2118-L2124">Github for more context regarding the jf/mode-line-format/major-mode-map variable</a>.<span class="hidden">)</span></span>
</small>
</p>
<pre><code class="language-emacs-lisp">(defvar jf/mode-line-format/major-mode-map
  (let ((map
          (make-sparse-keymap)))
    (define-key map [mode-line down-mouse-1]
      #'jf/toggle-typopunct-mode)
    map)
  &quot;Keymap to display `typopunct-mode'.&quot;)
</code></pre>
<p>And then I modified the function that renders the major mode.<small class="side-container">
  <span class="side-label"><span class="hidden">(</span>Sidenote<span class="hidden">:</span></span>
  <span class="side" role="note"> See <a href="https://github.com/jeremyf/dotemacs/blob/1caf9ec7c30479204658704a807d56809ed711c0/emacs.d/init.el#L2126-L2143">Github for more context regarding the
jf/mode-line-format/major-mode-name function</a>.<span class="hidden">)</span></span>
</small>
</p>
<pre><code class="language-emacs-lisp">(defun jf/mode-line-format/major-mode-name ()
    &quot;Render the major mode as text.

When `typopunct-mode' is active, provide an actionable indicator of its
active nature.&quot;
    (let ((fmt
            (if typopunct-mode &quot;“%s”&quot; &quot;%s&quot;)))
      (propertize
        (format fmt
          (capitalize
            (string-replace &quot;-mode&quot; &quot;&quot; (symbol-name major-mode))))
        'face
        (if (mode-line-window-selected-p)
          'mode-line 'mode-line-inactive)
        'local-map
        jf/mode-line-format/major-mode-map
        'help-echo
        (concat &quot;mouse-1: #'jf/toggle-typopunct-mode&quot;))))
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>I want my mode-line to remain compact, yet information rich, actionable, and not
chatty.  I find this minor tweak to be a quality of life improvement.</p>

	<p><a class="reply-by-email" href="mailto:reply-to@takeonrules.com?subject=RE:Adding%20Actionable%20Indicators%20to%20my%20Emacs%20Mode%20Line">Reply by Email</a></p>

      