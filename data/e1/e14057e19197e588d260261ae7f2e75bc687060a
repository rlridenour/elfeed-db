
	
<p>
One of my favourite movies is <em>WarGames</em>. One of the most memorable scenes is where the protagonist tries to teach the out-of-control AI that a nuclear war is unwinnable with a Tic Tac Toe simulation.</p>
<p>
Tic Tac Toe might be a futile children&#39;s game but it can also teach us about artificial intelligence. Tic Tac Toe, or Noughts and Crosses, is a <a href="https://en.wikipedia.org/wiki/Zero-sum_game">zero-sum game</a> with perfect information. Both players have full information about each other. When nobody makes a mistake, the game always ends in a draw.</p>
<p>
This article describes how to self-playing game of Tic Tac Toe, complete with a graphical interface, in the R language. This article is part of a series about <a href="https://lucidmanager.org/tags/r-games/">computer games</a> in the R Language.</p>
<p>
The first two parts of the article describe how to create the user interface and add a human player. The second part delves into creating computer players. My ultimate aim is to recreate this iconic scene in the <em><a href="https://www.youtube.com/watch?v=F7qOV8xonfY">WarGames</a></em> movie.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/F7qOV8xonfY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Tic Tac Toe With Joshua (1983).
</figcaption>
</figure>
<p>
<a href = "https://github.com/pprevos/RGames/" target="_blank"
   title="Download RGames from GitHub"
   alt="Download RGames from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">RGames</span>
  </button>
</a>

</p>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
The Game Board
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>This first code snippet draws the Tic Tac Toe simulation board. The variable <code class="verbatim">xo</code> holds the identity of the pieces and the vector <code class="verbatim">board</code> holds the current game. The game board is a vector of length nine consisting of either -1 (X), 0 (empty field) or 1 (O). The vector indices correspond with locations on the game board:</p>
<div class="center-block" style="text-align: center; margin-left: auto; margin-right: auto;">
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>1 2 3
</span></span><span style="display:flex;"><span>4 5 6
</span></span><span style="display:flex;"><span>7 8 9</span></span></code></pre></div>
</div>
</div>
<p>
The second part of the code checks for three in a row and draws the corresponding line.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#888">## Tic Tac Toe Simulation in the R language</span>
</span></span><span style="display:flex;"><span><span style="color:#888">## Peter Prevos</span>
</span></span><span style="display:flex;"><span><span style="color:#888">## lucidmanager.org</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  draw.board <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(game) {
</span></span><span style="display:flex;"><span>      xo <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="background-color:#fff0f0">&#34;X&#34;</span>, <span style="background-color:#fff0f0">&#34; &#34;</span>, <span style="background-color:#fff0f0">&#34;O&#34;</span>) <span style="color:#888"># Symbols</span>
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">par</span>(mar <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">1</span>,<span style="color:#60e;font-weight:bold">4</span>))
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">plot.new</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">plot.window</span>(xlim <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">0</span>,<span style="color:#60e;font-weight:bold">30</span>), ylim <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">0</span>,<span style="color:#60e;font-weight:bold">30</span>))
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">abline</span>(h <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">10</span>, <span style="color:#60e;font-weight:bold">20</span>), col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;darkgrey&#34;</span>, lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">4</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">abline</span>(v <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">10</span>, <span style="color:#60e;font-weight:bold">20</span>), col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;darkgrey&#34;</span>, lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">4</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#06b;font-weight:bold">text</span>(<span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">5</span>, <span style="color:#60e;font-weight:bold">15</span>, <span style="color:#60e;font-weight:bold">25</span>), <span style="color:#60e;font-weight:bold">3</span>), <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">25</span>, <span style="color:#60e;font-weight:bold">3</span>), <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">15</span>,<span style="color:#60e;font-weight:bold">3</span>), <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">5</span>, <span style="color:#60e;font-weight:bold">3</span>)), 
</span></span><span style="display:flex;"><span>           xo[game <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">2</span>], cex <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">4</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Identify location of any three in a row</span>
</span></span><span style="display:flex;"><span>      square <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">matrix</span>(game, nrow <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">3</span>, byrow <span style="color:#333">=</span> <span style="color:#080;font-weight:bold">TRUE</span>)
</span></span><span style="display:flex;"><span>      hor <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">abs</span>(<span style="color:#06b;font-weight:bold">rowSums</span>(square))
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">any</span>(hor <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>)) 
</span></span><span style="display:flex;"><span>          hor <span style="color:#333">&lt;-</span> (<span style="color:#60e;font-weight:bold">4</span> <span style="color:#333">-</span> <span style="color:#06b;font-weight:bold">which</span>(hor <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>)) <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">10</span> <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">5</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">else</span> 
</span></span><span style="display:flex;"><span>          hor <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>      ver <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">abs</span>(<span style="color:#06b;font-weight:bold">colSums</span>(square))
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">any</span>(ver <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>)) 
</span></span><span style="display:flex;"><span>          ver <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">which</span>(ver <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>) <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">10</span> <span style="color:#333">-</span> <span style="color:#60e;font-weight:bold">5</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>          ver <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>      diag1 <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">diag</span>(square))
</span></span><span style="display:flex;"><span>      diag2 <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">diag</span>(<span style="color:#06b;font-weight:bold">t</span>(<span style="color:#06b;font-weight:bold">apply</span>(square, <span style="color:#60e;font-weight:bold">2</span>, rev)))) 
</span></span><span style="display:flex;"><span>      <span style="color:#888"># Draw winning lines </span>
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">all</span>(hor <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">0</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> hor)
</span></span><span style="display:flex;"><span>              <span style="color:#06b;font-weight:bold">lines</span>(<span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">30</span>), <span style="color:#06b;font-weight:bold">rep</span>(i, <span style="color:#60e;font-weight:bold">2</span>), lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>, col<span style="color:#333">=</span><span style="background-color:#fff0f0">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">all</span>(ver <span style="color:#333">&gt;</span> <span style="color:#60e;font-weight:bold">0</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#080;font-weight:bold">for</span> (i <span style="color:#080;font-weight:bold">in</span> ver)
</span></span><span style="display:flex;"><span>              <span style="color:#06b;font-weight:bold">lines</span>(<span style="color:#06b;font-weight:bold">rep</span>(i, <span style="color:#60e;font-weight:bold">2</span>), <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">30</span>), lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>, col<span style="color:#333">=</span><span style="background-color:#fff0f0">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">abs</span>(diag1) <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#06b;font-weight:bold">lines</span>(<span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">2</span>, <span style="color:#60e;font-weight:bold">28</span>), <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">28</span>, <span style="color:#60e;font-weight:bold">2</span>), lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#080;font-weight:bold">if</span> (<span style="color:#06b;font-weight:bold">abs</span>(diag2) <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#06b;font-weight:bold">lines</span>(<span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">2</span>, <span style="color:#60e;font-weight:bold">28</span>), <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#60e;font-weight:bold">2</span>, <span style="color:#60e;font-weight:bold">28</span>), lwd <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>  }</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Human Player
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>This second code snippet lets a human player move by clicking anywhere on the graphic display using the <a href="https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/locator">locator</a> function. The click location is converted to a number to denote the position on the board. The entered field is only accepted if it has not yet been used (the <code class="verbatim">empty</code> variable contains the available fields).</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>move.human <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(game) {
</span></span><span style="display:flex;"><span>    <span style="color:#06b;font-weight:bold">text</span>(<span style="color:#60e;font-weight:bold">4</span>, <span style="color:#60e;font-weight:bold">0</span>, <span style="background-color:#fff0f0">&#34;Click on screen to move&#34;</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;grey&#34;</span>, cex<span style="color:#333">=</span><span style="color:#60e;font-weight:bold">.7</span>)
</span></span><span style="display:flex;"><span>    empty <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">which</span>(game <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>    move <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">while</span> (<span style="color:#333">!</span>move <span style="color:#333">%in%</span> empty) {
</span></span><span style="display:flex;"><span>        coords <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">locator</span>(n <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">1</span>) <span style="color:#888"># add lines</span>
</span></span><span style="display:flex;"><span>        coords<span style="color:#333">$</span>x <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">abs</span>(coords<span style="color:#333">$</span>x) <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">10</span>) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        coords<span style="color:#333">$</span>y <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">floor</span>(<span style="color:#06b;font-weight:bold">abs</span>(coords<span style="color:#333">$</span>y) <span style="color:#333">/</span> <span style="color:#60e;font-weight:bold">10</span>) <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        move <span style="color:#333">&lt;-</span> coords<span style="color:#333">$</span>x <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">3</span> <span style="color:#333">*</span> (<span style="color:#60e;font-weight:bold">3</span> <span style="color:#333">-</span> coords<span style="color:#333">$</span>y)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(move)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Computer Player
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>The computer uses a modified <a href="https://en.wikipedia.org/wiki/Minimax">Minimax Algorithm</a> to determine its next move. This article from the <a href="https://neverstopbuilding.com/minimax">Never Stop Building</a> blog explains this method in great detail.</p>
<p>
If the computer moves first, the algorithm takes a while because of the large number of permutations. There
are <a href="http://www.se16.info/hgb/tictactoe.htm">255,168 possible legal games</a> in Tic Tac Toe, 46,080 (18%) of which end in a draw.</p>
<p>
The code for this part is contributed by a reader (see comments below).  I originally made a mistake in the recurring function and Alberto was so kind to contribute a correct version.</p>
<p>
The <em>ganador</em> (Spanish for winning) function assesses the board condition by assigning -10 or + 10 for a winning game and 0 for any other situation.</p>
<p>
The minimax function returns a list with the move and its valuation through the ganador function. The function calls itself until it has filled the board and retains the best scoring move using the minimax method. Random variables are added to avoid the computer always playing the same move in the same situation.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#888">## Minimax code by Alberto C.</span>
</span></span><span style="display:flex;"><span>ganador <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(juego, player) {
</span></span><span style="display:flex;"><span>    game <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">matrix</span>(juego, nrow <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">3</span>, byrow <span style="color:#333">=</span> <span style="color:#007020">T</span>)
</span></span><span style="display:flex;"><span>    hor <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">rowSums</span>(game)
</span></span><span style="display:flex;"><span>    ver <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">colSums</span>(game)
</span></span><span style="display:flex;"><span>    diag <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(<span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">diag</span>(game)), <span style="color:#06b;font-weight:bold">sum</span>(<span style="color:#06b;font-weight:bold">diag</span>(<span style="color:#06b;font-weight:bold">apply</span>(game, <span style="color:#60e;font-weight:bold">1</span>, rev))))
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (<span style="color:#60e;font-weight:bold">-3</span> <span style="color:#333">%in%</span> <span style="color:#06b;font-weight:bold">c</span>(hor, ver, diag))
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">return</span>(<span style="color:#60e;font-weight:bold">-10</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (<span style="color:#60e;font-weight:bold">3</span> <span style="color:#333">%in%</span> <span style="color:#06b;font-weight:bold">c</span>(hor, ver, diag))
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">return</span>(<span style="color:#60e;font-weight:bold">10</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">return</span>(<span style="color:#60e;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>minimax <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(juego, player) {
</span></span><span style="display:flex;"><span>    free <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">which</span>(juego <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span>(<span style="color:#06b;font-weight:bold">length</span>(free) <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        juego[free] <span style="color:#333">&lt;-</span> player
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">list</span>(move <span style="color:#333">=</span> free, U <span style="color:#333">=</span> <span style="color:#06b;font-weight:bold">ganador</span>(juego, player)))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    poss.results <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">9</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">for</span>(i <span style="color:#080;font-weight:bold">in</span> free) {
</span></span><span style="display:flex;"><span>        game <span style="color:#333">&lt;-</span> juego
</span></span><span style="display:flex;"><span>        game[i] <span style="color:#333">&lt;-</span> player
</span></span><span style="display:flex;"><span>        poss.results[i] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">ganador</span>(game, player)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    mm <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">ifelse</span>(player <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">-1</span>, <span style="background-color:#fff0f0">&#34;which.min&#34;</span>, <span style="background-color:#fff0f0">&#34;which.max&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span>(<span style="color:#06b;font-weight:bold">any</span>(poss.results <span style="color:#333">==</span> (player <span style="color:#333">*</span> <span style="color:#60e;font-weight:bold">10</span>))) {
</span></span><span style="display:flex;"><span>        move <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">do.call</span>(mm, <span style="color:#06b;font-weight:bold">list</span>(poss.results))
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">list</span>(move <span style="color:#333">=</span> move, U <span style="color:#333">=</span> poss.results[move]))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">for</span>(i <span style="color:#080;font-weight:bold">in</span> free) {
</span></span><span style="display:flex;"><span>        game <span style="color:#333">&lt;-</span> juego
</span></span><span style="display:flex;"><span>        game[i] <span style="color:#333">&lt;-</span> player
</span></span><span style="display:flex;"><span>        poss.results[i] <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">minimax</span>(game, <span style="color:#333">-</span>player)<span style="color:#333">$</span>U
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    random <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">runif</span>(<span style="color:#60e;font-weight:bold">9</span>, <span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">0.1</span>)
</span></span><span style="display:flex;"><span>    poss.results[<span style="color:#333">-</span>free] <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">100</span> <span style="color:#333">*</span> <span style="color:#333">-</span>player
</span></span><span style="display:flex;"><span>    poss.results <span style="color:#333">&lt;-</span> poss.results <span style="color:#333">+</span> (player <span style="color:#333">*</span> random)
</span></span><span style="display:flex;"><span>    move <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">do.call</span>(mm, <span style="color:#06b;font-weight:bold">list</span>(poss.results))
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">return</span>(<span style="color:#06b;font-weight:bold">list</span>(move <span style="color:#333">=</span> move, U <span style="color:#333">=</span> poss.results[move]))
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
Play Tic Tac Toe
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>The last bit of code defines a function to play the game. Each layer can be either a human or a computer. The function loops while there are still empty spots on the board and no winner is declared.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>tic.tac.toe <span style="color:#333">&lt;-</span> <span style="color:#080;font-weight:bold">function</span>(player1 <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;human&#34;</span>, player2 <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;computer&#34;</span>) {
</span></span><span style="display:flex;"><span>    game <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">rep</span>(<span style="color:#60e;font-weight:bold">0</span>, <span style="color:#60e;font-weight:bold">9</span>) <span style="color:#888"># Empty board</span>
</span></span><span style="display:flex;"><span>    winner <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">0</span> <span style="color:#888"># Define winner</span>
</span></span><span style="display:flex;"><span>    player <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888"># First player</span>
</span></span><span style="display:flex;"><span>    players <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">c</span>(player1, player2)
</span></span><span style="display:flex;"><span>    <span style="color:#06b;font-weight:bold">draw.board</span>(game)
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">while</span> (<span style="color:#60e;font-weight:bold">0</span> <span style="color:#333">%in%</span> game <span style="color:#333">&amp;</span> winner <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>) { <span style="color:#888"># Keep playing until win or full board</span>
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">if</span> (players<span style="color:#06b;font-weight:bold">[</span>(player <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">3</span>) <span style="color:#333">%%</span> <span style="color:#60e;font-weight:bold">3</span>] <span style="color:#333">==</span> <span style="background-color:#fff0f0">&#34;human&#34;</span>) <span style="color:#888"># Human player</span>
</span></span><span style="display:flex;"><span>            move <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">move.human</span>(game)
</span></span><span style="display:flex;"><span>        <span style="color:#080;font-weight:bold">else</span> { <span style="color:#888"># Computer player</span>
</span></span><span style="display:flex;"><span>            move <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">minimax</span>(game, player)[[1]]
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        game[move] <span style="color:#333">&lt;-</span> player <span style="color:#888"># Change board</span>
</span></span><span style="display:flex;"><span>        <span style="color:#06b;font-weight:bold">draw.board</span>(game)
</span></span><span style="display:flex;"><span>        winner <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">ganador</span>(game, player)
</span></span><span style="display:flex;"><span>        player <span style="color:#333">&lt;-</span> <span style="color:#333">-</span>player <span style="color:#888"># Change player</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-weight:bold">if</span> (winner <span style="color:#333">==</span> <span style="color:#60e;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#06b;font-weight:bold">text</span>(<span style="color:#60e;font-weight:bold">15</span>, <span style="color:#60e;font-weight:bold">15</span> , <span style="background-color:#fff0f0">&#34;DRAW&#34;</span>, col <span style="color:#333">=</span> <span style="background-color:#fff0f0">&#34;red&#34;</span>, cex <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">10</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#06b;font-weight:bold">tic.tac.toe</span>()</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
Wargames Tic Tac Toe Simulation
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>Now all elements are in place to recreate the simulation in the <em>Wargames</em> movie. The animation package helps to create an animated gif where the computer keeps playing itself. All games end in a draw.</p>
<figure>
<img src="https://lucidmanager.org/images/rgames/wargames.gif" alt="Wargames Tic Tac Toe simulation" title="Wargames Tic Tac Toe simulation"/>
<figcaption>
Wargames Tic Tac Toe simulation.
</figcaption>
</figure>
<p>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>
</p>
</div>
</div>
</div>
</div>

      