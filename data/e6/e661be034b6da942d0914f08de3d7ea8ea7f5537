<p>My next investigation into trying to improve my emacs workflow is expanding entered text for repetitive tasks.</p>
<figure class="emacs-img"><img src="https://emacs.dyerdwelling.family/ox-hugo/20221123131342-emacs--Expanding-Text-using-abbrev.jpg">
</figure>

<p>I&rsquo;m not yet sure how useful this will be for me as I typically copy and paste my way through the creation of text files, especially org files.  Maybe org-capture could be a help?</p>
<p>As always I want to try built in options to augment my vanilla emacs setup, so the obvious place to look is abbrev.</p>
<p>This facility can be geared towards fixing common spelling <em>misteaks</em> (ha!, see what I did there!)  or expanding acronyms.  I don&rsquo;t really want to be using that aspect however as I read somewhere that you can link abbrevs to skels, my aim is to type a few unique characters which would autofill a common textual structure, for example PROPERTIES in an org file.</p>
<p>What about yasnippet! I all hear you vehemently proclaim!, but of course this is not built in, so no I shall not be considering this option for now.</p>
<p>I am not even familiar with defining a skeleton (skel), so what on earth am I thinking about jumping in like this for potentially a negligible return, well of course the answer is twofold:</p>
<ol>
<li>it is fun, this is of course emacs we are talking about.</li>
<li>in the long run it will improve my productivity.</li>
</ol>
<p>The usual way I approach absorbing something new is to first read around all the options and then to start simple.  By simple I mean setting up some uncomplicated skeletons and elementary abbrevs to initially test my setup.  Then after a while adjusting to this new way of working to gradually start learning the more complex and subtle aspects of the functionality.</p>
<p>Firstly lets try and set up a simple properties skeleton, namely :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(define-skeleton org-hugo-properties-skel
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;org properties skeleton.&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;:PROPERTIES:\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;:EXPORT_FILE_NAME:\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;:EXPORT_HUGO_LASTMOD: &#34;</span> (<span style="color:#a6e22e">format-time-string</span> <span style="color:#e6db74">&#34;%Y-%m-%d&#34;</span>) <span style="color:#e6db74">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;:EXPORT_HUGO_CUSTOM_FRONT_MATTER+: :thumbnail\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;:END:\n&#34;</span>)
</span></span></code></pre></div><p>This is a typical setup for inserting a Hugo article into an org file ready for export, in fact this article is written using this framework.</p>
<p>I can call this by defining keybinding such as :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(global-set-key (kbd <span style="color:#e6db74">&#34;C-c i p&#34;</span>) <span style="color:#e6db74">&#39;org-hugo-properties-skel</span>)
</span></span></code></pre></div><p>but I suspect my tiny brain is currently full to capacity of emacs keybindings and the ones that are in my head need a little more time to settle in before I commit to any more.</p>
<p>My overall idea is to define a family of common characters that I can insert for expansion as in this case I am talking about inserting a predefined set of text rather than some emacs function, so why commit to another keybinding?</p>
<p>So lets set up <strong>abbrev</strong> for this task, the first thing to do is to set up an <strong>abbrev_defs</strong> file for my abbreviation definitions in my emacs init file as thus:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(setq abbrev-file-name (<span style="color:#a6e22e">concat</span> home-dir <span style="color:#e6db74">&#34;/content/abbrev_defs&#34;</span>))
</span></span><span style="display:flex;"><span>(setq-default abbrev-mode <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><p>In this file I can define an elisp definition, by either linking a sequence of characters to a string or a skel, so I define thus :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(define-abbrev-table <span style="color:#e6db74">&#39;global-abbrev-table</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(
</span></span><span style="display:flex;"><span>     (<span style="color:#e6db74">&#34;hugprop&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> org-hugo-properties-skel)
</span></span><span style="display:flex;"><span>     ))
</span></span></code></pre></div><p>There are commands to insert, edit and perform various different operations on this file but really all I want for now is a simple text file that I edit in emacs to add in any new definitions.</p>
<p>So typing <strong>hugprop</strong> &lt;space&gt; gives me:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>:PROPERTIES:
</span></span><span style="display:flex;"><span>:EXPORT_FILE_NAME:
</span></span><span style="display:flex;"><span>:EXPORT_HUGO_LASTMOD: 2022-12-11
</span></span><span style="display:flex;"><span>:EXPORT_HUGO_CUSTOM_FRONT_MATTER+: :thumbnail
</span></span><span style="display:flex;"><span>:END:
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span>+hugo: more
</span></span></code></pre></div><p>In the <strong>define-abbrev-table</strong> I can also define a mapping to a simple string, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(define-abbrev-table <span style="color:#e6db74">&#39;global-abbrev-table</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(
</span></span><span style="display:flex;"><span>     (<span style="color:#e6db74">&#34;hugprop&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> org-hugo-properties-skel)
</span></span><span style="display:flex;"><span>     (<span style="color:#e6db74">&#34;btw&#34;</span> <span style="color:#e6db74">&#34;by the way&#34;</span> <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>     ))
</span></span></code></pre></div><p>So now I have figured this out I am ready to go!</p>
<p>After a little while of using this method I was starting to struggle with updating the abbrev_defs and seeing its effects immediately in emacs.  When I update to a new abbrev it means that I pretty much want to use it now!</p>
<p>I couldn&rsquo;t really figure out an easy method of instantly making the newly added abbrev command available (except restarting emacs of course).  There will be a way but it wasn&rsquo;t quickly apparent to me and I suspect it was related to the fact that I am not adding to the abbrev_defs using an emacs function.</p>
<p>Before my investigations consumed too much time however I thought I would try something!.</p>
<p>I am not a great fan of configuration files cluttering up my system and certainly with emacs configuration I really am aiming with my vanilla-ish emacs setup to keep everything in one init file and as concise as possible.  So why can&rsquo;t I move the <strong>define-abbrev-table</strong> straight into my <strong>.emacs</strong> file?  and just reevaluate an updated abbrev table?</p>
<p>Well the answer is that I can!</p>
<p>Problem solved.  So if I feel the need to add more skeletons they can now be defined next to the abbreviation table and I can update immediately with a reevaluation in my emacs init file.</p>
<p>Next on my expanding text journey I think might take a look at <strong>dabbrev</strong> and <strong>hippie-expand</strong></p>