
        <p>Related Links :: <span class="label">Tags:</span> <span role="list" aria-label="Tags for “Dynamic Org-Mode Block to List Books Read”">
<span role="listitem" aria-label="&ldquo;emacs&rdquo; tag navigation"><a href="https://takeonrules.com/2025/08/20/elevator-pitches-for-emacs/" aria-label="Previous post tagged with &ldquo;emacs&rdquo; is &ldquo;Elevator Pitches for Emacs&rdquo;" title="Older post tagged with &ldquo;emacs&rdquo; is &ldquo;Elevator Pitches for Emacs&rdquo;"><small>&lt;</small></a>
<a href="https://takeonrules.com/tags/emacs/" class="p-category" aria-label="All posts tagged with &ldquo;emacs&rdquo;" title="All posts tagged with &ldquo;emacs&rdquo;">emacs</a> <small aria-hidden="true">&gt;</small>
</span><span aria-hidden=true> &middot; </span>
<span role="listitem" aria-label="&ldquo;reading&rdquo; tag navigation"><a href="https://takeonrules.com/2025/09/07/claire-norths-ithaca/" aria-label="Previous post tagged with &ldquo;reading&rdquo; is &ldquo;Claire North’s “Ithaca”&rdquo;" title="Older post tagged with &ldquo;reading&rdquo; is &ldquo;Claire North’s “Ithaca”&rdquo;"><small>&lt;</small></a>
<a href="https://takeonrules.com/tags/reading/" class="p-category" aria-label="All posts tagged with &ldquo;reading&rdquo;" title="All posts tagged with &ldquo;reading&rdquo;">reading</a> <small aria-hidden="true">&gt;</small>
</span></span>

</p/><p><strong>Summary: </strong>
An #Emacs function defining an #OrgMode dynamic block so that I can easily insert a list of books I&rsquo;ve finished reading within a given month.
</p>
        <p><time datetime="2025" title="2025">This year</time> Jenny and I are participating in our local library’s reading
challenge.  We formed our own team, with the goal of the team reading 100 books.</p>
<p>On <time datetime="2025-09-12" title="2025-09-12">Friday</time> I read <a href="https://itinerantlibrarian.blogspot.com/2025/09/reading-about-reading-life-september-12.html">Reading about the reading life: September 12, 2025 edition</a>, in
which the author draws attention to <a href="https://www.openculture.com/2025/08/a-man-read-3599-books-over-60-years-and-now-his-family-has-shared-the-entire-list-online.html">a man who read 3,599 books</a> and hand-recorded
each book read; all books having come from public libraries.  Memorialized in
<a href="https://what-dan-read.com/">What Dan Read</a>.</p>
<p>I found Dan’s dedication inspiring—a simple bit of note taking sustained over
the decades.  That list, creating a bit of imortality, with its longitudinal
insight into the intersection of individual curiosity, collection curation, and
the currents of culture.</p>
<p>Drawing on that inspiration, I started thinking about my personal habits that
I’m establishing.  Namely writing journal entries then printing those out each
month.  I also use <span><a href="https://orgmode.org/">Org-Mode</a></span> <small><a class="ref" rel="tag opener" aria-label="Other site-wide references of “Org-Mode”" title="Other site-wide references of “Org-Mode”" href="https://takeonrules.com/site-map/glossary/#abbr-dfn-GLOSSARY-ORG-MODE">&#128214;</a></small>
 to track my reading.  I have a single <span>Org-Mode</span>

document that:</p>
<ul>
<li>Tracks when I started, completed/abandoned reading a book.</li>
<li>Any quotes that I’ve gathered from that book.</li>
<li>Additional notes around the read.</li>
</ul>
<p>I wrote about some of this in Re-Wiring My Epigraphs Functionality to Leverage
My Bibliography File</p>
<p>So, drawing inspiration from Dan, I wrote an <span><a href="https://en.wikipedia.org/wiki/Emacs">Emacs</a></span> <small><a class="ref" rel="tag opener" aria-label="Other site-wide references of “Emacs”" title="Other site-wide references of “Emacs”" href="https://takeonrules.com/site-map/glossary/#abbr-dfn-GLOSSARY-EMACS">&#128214;</a></small>
 function:
<a href="https://github.com/jeremyf/dotemacs/blob/1e83bb57da5555d0aae5256a8ccaec25fc4a9cb1/emacs.d/personal.el#L1151-L1211">org-dblock-write:books-finished</a>.  That function conforms to the Dynamic Block
API and I simply drop it into my <span>Org-Mode</span>
 document at some point within the
month’s entries.</p>
<p>What it does:</p>
<ul>
<li>Determine the month and year for the block</li>
<li>Query my Bibliography for books I finished reading</li>
<li>Insert into the document a list of those books, as links to those books</li>
</ul>
<p>This way, when I print my monthly journal, I’ll have a list of books I finished
that month.</p>
<h1 id="code-for-org-dblock-writebooks-finished">Code for <code>org-dblock-write:books-finished</code></h1>
<pre><code class="language-emacs-lisp">(defun org-dblock-write:books-finished (_params)
  &quot;Generate a list of books finished.

This dynamic block assumes it placed within the month section of a
capture template 'file+olp+datetree'; where the headling is \&quot;2025-09
September\&quot;.&quot;
  (let* ((month-entry
          ;; The month headline in which this block was placed
          (car
           (seq-filter
            (lambda (el)
              (and
               (eq (org-element-type el) 'headline)
               (= (org-element-property :level el) 2)))
            (org-element-lineage (org-element-at-point)))))
         (begin-year-month
          ;; A cons cell of the block's year and month (as integer)
          (apply #'cons
                 (mapcar
                  #'string-to-number
                  (s-split &quot;-&quot;
                           (car (s-split &quot; &quot;
                                         (org-element-property
                                          :title month-entry)))))))
         (end-year-month
          ;; A cons cell of the block's ending year and month
          ;; (exclusive)
          (if (= (cdr begin-year-month) 12)
              (cons (+ 1 (car begin-year-month)) 1)
            (cons (car begin-year-month) (+ 1 (cdr begin-year-month)))))
         (books
          ;; An alist of book labels and book data.  We use the
          ;; beginning and ending dates to limit our query and only
          ;; look for books that closed within those dates.
          (with-current-buffer
              (find-file-noselect jf/filename/bibliography)
            (org-map-entries
             #'jf/build-label-and-book-from-epom
             (format
              &quot;+LEVEL=2+books+TODO=\&quot;DONE\&quot;+CLOSED&gt;=\&quot;&lt;%d-%02d-01&gt;\&quot;+CLOSED&lt;\&quot;&lt;%d-%02d-01&gt;\&quot;&quot;
              (car begin-year-month)
              (cdr begin-year-month)
              (car end-year-month)
              (cdr end-year-month))
             'file))))
    (insert
     ;; With the list of books insert my `work' links to those books.
     ;; These `work' links will then export as per that logic.
     (mapconcat (lambda (label-book)
                  (let ((label
                         (car label-book))
                        (book
                         (cdr label-book)))
                    (format &quot;- [[work:%s%s%s][%s]]\n&quot;
                            (jf/book-custom_id book)
                            (if (s-present? (jf/book-author book))
                                &quot;::author&quot; &quot;&quot;)
                            (if (s-present? (jf/book-subtitle book))
                                &quot;::subtitle&quot; &quot;&quot;)
                            label)))
                books))))
</code></pre>

	<p><a class="reply-by-email" href="mailto:reply-to@takeonrules.com?subject=RE:Dynamic%20Org-Mode%20Block%20to%20List%20Books%20Read">Reply by Email</a></p>

      