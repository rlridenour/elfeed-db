<p>I have now managed to set up my external USB numeric keypad on Linux using <code>kmonad</code> which lets me use any regular plugged-in number keypad as a shortcut tool for my digital art.</p>
<figure class="emacs-img"><img src="https://emacs.dyerdwelling.family/ox-hugo/20230825115829-emacs--Updating-To-AutoHotKey-V2.jpg">
</figure>

<p>This comes in very handy when painting in Krita and ArtRage (through Wine) and maybe one day I will expand this functionality to GIMP when version 3.0 comes out!</p>
<p>I would like the same keymapping functionality to be reflected on Windows (as ArtRage is fundamentally a Windows application).  Technically <code>kmonad</code> should work but I&rsquo;m going to use <code>AutoHotKey</code> as I&rsquo;m much more familiar with it.</p>
<p>I have a problem though, my old <code>autohotkey</code> scripts don&rsquo;t work with the latest version of <code>AutoHotKey</code> (version 2).  On further investigation it seems that <em>version 2</em> is a significant update and includes the simplification and shift of the syntax.</p>
<p>Well I guess I had better update my scripts then!.</p>
<p>On Windows by default an <code>ahk</code> extension offers to open <strong>notepad</strong> which initially I did as I thought the changes would be simple enough and actually notepad isn&rsquo;t too bad these days what with the multiple tabs, dark mode and even multiple undos!.  However I quickly became frustrated with the lack of syntax highlighting / indenting e.t.c.  I have used a specific <code>ahk</code> editor in the past, something like <code>SciTE4AutoHotkey</code> but this time I thought I would break out <code>emacs</code> and see what it had to offer.</p>
<p>Initially loading the <code>ahk</code> script started fundamental mode and of course had no syntax highlighting.  Running <code>list-packages</code> and then a quick search for <em>AutoHotkey</em> brought up the only package available, which was <strong><code>ahk-mode</code></strong>.  This package seems pretty straightforward and although it was last updated in 2016 (so won&rsquo;t cater too well with the AutoHotkey v2 shift in syntax) the syntax highlighting, commenting and indenting were just fine enough for me.  It also seems to be well integrated with <code>company-mode</code> and although I&rsquo;m not a great fan of <code>company-mode</code> in general in this case it might actually be useful.</p>
<p>I was now able to comfortably convert my scripts to AutoHotKey v2, for example:</p>
<p><strong>version 1</strong></p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">#IfWinActive, ahk_class ArtRage 3
NumpadDiv:: ^z
NumpadMult:: ^y
NumpadHome::Shift
NumpadUp:: Alt
NumpadLeft:: Space
NumpadRight::
GetKeyState, state, h
if state = D
    Send {h up}
else
    Send {h down}
return
NumpadEnd:: Control
NumpadPgDn:: RButton
</code></pre><p><strong>version 2</strong></p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">#HotIf WinActive(&#34;ahk_class ArtRage 3&#34;)
NumpadDiv:: ^z
NumpadMult:: ^y
NumpadHome::Shift
NumpadUp:: Alt
NumpadLeft:: Space
NumpadRight::
{
if GetKeyState(&#34;h&#34;)
    Send &#34;{h up}&#34;
else
    Send &#34;{h down}&#34;
}
NumpadEnd:: Control
NumpadPgDn:: RButton
</code></pre><p>While I was in amongst the scripts I decided to add in something extra and that is to map the <strong>Capslock</strong> key to the <strong>Control</strong> key; a not uncommon mapping for a regular emacs user.</p>
<p>So I added in the following line and plonked the script into the Windows startup folder:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">Capslock::Control
</code></pre>