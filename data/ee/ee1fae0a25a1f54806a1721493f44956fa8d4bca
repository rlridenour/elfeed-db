<p>
Sometimes I just want to quickly get to a blog post by title. I use <a href="https://sachachua.com/blog/2024/10/yay-emacs-inserting-links-with-consult-omni/">consult-omni</a> for quick web searches that I can jump to or insert as a link. Sure, I can limit this search to my blog by specifying site:sachachua.com or using the code I wrote to <a href="https://sachachua.com/dotemacs#searching-my-blog">search my blog, notes, and sketches with consult-ripgrep and consult-omni</a>, but the search sometimes gets confused by other text on the page. When I <a href="https://sachachua.com/blog/category/11ty/">publish my blog with Eleventy</a>, I also create a JSON file with <a href="https://sachachua.com/blog/all/index.json">all my blog post URLs and titles</a>. Here's how I can use that data as a consult-omni source.
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><code>(<span class="org-keyword">defun</span> <span class="org-function-name">my-consult-omni-blog-data</span> ()
  (<span class="org-keyword">let</span> ((base (replace-regexp-in-string <span class="org-string">"/$"</span> <span class="org-string">""</span> my-blog-base-url))
        (json-object-type <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">alist</span>)
        (json-array-type <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">list</span>))
    (mapcar
     (<span class="org-keyword">lambda</span> (o)
       (list <span class="org-builtin">:url</span> (concat base (alist-get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">permalink</span> o))
             <span class="org-builtin">:title</span> (alist-get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">title</span> o)
             <span class="org-builtin">:date</span> (alist-get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">date</span> o)))
     (sort (json-read-file <span class="org-string">"~/sync/static-blog/_site/blog/all/index.json"</span>)
           (<span class="org-keyword">lambda</span> (a b)
             (string&lt; (<span class="org-keyword">or</span> (alist-get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">date</span> b) <span class="org-string">""</span>)
                      (<span class="org-keyword">or</span> (alist-get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">date</span> a) <span class="org-string">""</span>)))))))
(<span class="org-keyword">unless</span> (get <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">my-consult-omni-blog-data</span> <span class="org-builtin">:memoize-original-function</span>)
  (memoize <span class="org-highlight-quoted-quote">#'</span><span class="org-highlight-quoted-symbol">my-consult-omni-blog-data</span> <span class="org-string">"5 minutes"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">my-consult-omni-blog-titles-builder</span> (input <span class="org-type">&amp;rest</span> args <span class="org-type">&amp;key</span> callback <span class="org-type">&amp;allow-other-keys</span>)
  (<span class="org-keyword">let*</span> ((quoted (<span class="org-keyword">when</span> input (regexp-quote input)))
         (list
          (<span class="org-keyword">if</span> quoted
              (seq-filter
               (<span class="org-keyword">lambda</span> (o)
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Someday figure out orderless?</span>
                 (string-match quoted (concat (plist-get o <span class="org-builtin">:title</span>) <span class="org-string">" - "</span> (plist-get o <span class="org-builtin">:title</span>))))
               (my-consult-omni-blog-data))
            (my-consult-omni-blog-data)))
         (candidates
          (mapcar
           (<span class="org-keyword">lambda</span> (o)
             (propertize
              (concat (plist-get o <span class="org-builtin">:title</span>))
              <span class="org-builtin">:source</span> <span class="org-string">"Blog"</span>
              <span class="org-builtin">:date</span> (plist-get o <span class="org-builtin">:date</span>)
              <span class="org-builtin">:title</span> (plist-get o <span class="org-builtin">:title</span>)
              <span class="org-builtin">:url</span> (plist-get o <span class="org-builtin">:url</span>)))
           (<span class="org-keyword">if</span> quoted (seq-take list 3) list))))
    (<span class="org-keyword">when</span> callback (funcall callback candidates))
    candidates))

(<span class="org-keyword">defun</span> <span class="org-function-name">my-consult-omni-blog-annotation</span> (s)
  (format <span class="org-string">" (%s)"</span>
          (propertize (substring (<span class="org-keyword">or</span> (get-text-property 0 <span class="org-builtin">:date</span> s) <span class="org-string">""</span>) 0 4)
                      <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">face</span> <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">completions-annotations</span>)))

(<span class="org-keyword">with-eval-after-load</span> <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">consult-omni</span>
  (<span class="org-keyword">consult-omni-define-source</span>
   <span class="org-string">"Blog"</span>
   <span class="org-builtin">:narrow-char</span> ?b
   <span class="org-builtin">:type</span> <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">sync</span>
   <span class="org-builtin">:request</span> <span class="org-highlight-quoted-quote">#'</span><span class="org-highlight-quoted-symbol">my-consult-omni-blog-titles-builder</span>
   <span class="org-builtin">:on-return</span> <span class="org-highlight-quoted-quote">'</span><span class="org-highlight-quoted-symbol">my-consult-org-bookmark-visit</span>
   <span class="org-builtin">:group</span> <span class="org-highlight-quoted-quote">#'</span><span class="org-highlight-quoted-symbol">consult-omni&#45;&#45;group-function</span>
   <span class="org-builtin">:annotate</span> <span class="org-highlight-quoted-quote">#'</span><span class="org-highlight-quoted-symbol">my-consult-omni-blog-annotation</span>
   <span class="org-builtin">:min-input</span> 3
   <span class="org-builtin">:sort</span> nil
   <span class="org-builtin">:require-match</span> t))
</code></pre>
</div>


<p>
Here's what it looks like by itself when I call <code>consult-omni-my-blog</code>:
</p>


<figure id="orgce9a0fd">
<img src="https://sachachua.com/blog/2025/07/finding-my-blog-posts-with-consult-omni/2025-07-21_23-24-09.png" alt="2025-07-21_23-24-09.png">

<figcaption><span class="figure-number">Figure 1: </span>Screenshot of a search through my blog post titles</figcaption>
</figure>

<p>
Then I can add it as one of the sources used by <code>consult-omni</code>:
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp"><code>  (<span class="org-keyword">setq</span> consult-omni-multi-sources
        <span class="org-highlight-quoted-quote">'</span>(consult-omni&#45;&#45;source-google
          consult-omni&#45;&#45;source-my-org-bookmarks
          consult-omni&#45;&#45;source-my-blog))
</code></pre>
</div>


<p>
Here's what it looks like when I call <code>consult-omni</code> to search my bookmarks, blog posts, and Google results at the same time.
</p>


<figure id="org3e97276">
<img src="https://sachachua.com/blog/2025/07/finding-my-blog-posts-with-consult-omni/2025-07-21_23-29-06.png" alt="2025-07-21_23-29-06.png">

<figcaption><span class="figure-number">Figure 2: </span>Screenshot of a consult-omni search with multiple sources</figcaption>
</figure>

<p>
Then I can press <code>RET</code> to open the blog post in my browser or <code>C-. i l</code> to <a href="https://sachachua.com/dotemacs#consult-omni">insert the link using Embark</a> (<code>my-consult-omni-embark-insert-link</code>).
</p>

<p>
Related:
</p>
<ul class="org-ul">
<li><a href="https://sachachua.com/dotemacs#completion-consult-consult-omni-bookmarks">consult-omni&#x2013;source-my-org-bookmarks</a></li>
<li><a href="https://sachachua.com/dotemacs#completing-blog-posts">Completing blog posts</a> (Org link type with completion)</li>
<li><a href="https://sachachua.com/blog/2025/07/finding-unlinked-text/#completion-consult-consult-omni-using-web-searches-and-bookmarks-to-quickly-link-placeholders-in-org-mode">Using web searches and bookmarks to quickly link placeholders in Org Mode</a></li>
</ul>

<p>
<mark>Next steps:</mark> I want to find out how to get <code>:sort nil</code> to be respected so that more recent blog posts are listed first. Also, it might be fun to define a similar source for the sections of my Emacs configuration, like the way I can use my <a href="https://sachachua.com/dotemacs#links-to-my-config">dotemacs: Org Mode link type with completion</a>.
</p>

<div class="note">This is part of my <a href="https://sachachua.com/dotemacs#completion-consult-consult-omni-blog-posts">Emacs configuration.</a></div><div><a href="https://sachachua.com/blog/2025/07/finding-my-blog-posts-with-consult-omni/index.org">View org source for this post</a></div>
<p>You can <a href="https://social.sachachua.com/@sacha/statuses/01K0R38KMPAKMCTEBHM2VS69TX" target="_blank" rel="noopener noreferrer">comment on Mastodon</a> or <a href="mailto:sacha@sachachua.com?subject=Comment%20on%20https%3A%2F%2Fsachachua.com%2Fblog%2F2025%2F07%2Ffinding-my-blog-posts-with-consult-omni%2F&body=Name%20you%20want%20to%20be%20credited%20by%20(if%20any)%3A%20%0AMessage%3A%20%0ACan%20I%20share%20your%20comment%20so%20other%20people%20can%20learn%20from%20it%3F%20Yes%2FNo%0A">e-mail me at sacha@sachachua.com</a>.</p>