<p>
A couple of weeks ago, I wrote about how Punchagan over at <a href="https://punchagan.muse-amuse.in">NOETIC NOUGHT</a> started <a href="https://irreal.org/blog/?p=13558">saving his Elfeed database after he lost it in a system crash</a>. At the time, Punchagan didn&rsquo;t know exactly what happened, only that the system crashed and he lost his Elfeed database. He wasn&rsquo;t even sure that the two events were related, only that they occurred at the same time. His solution to the problem was to set up periodic saving of his Elfeed data to git.
</p>
<p>
A little later he had some time to troubleshoot the problem and <a href="https://punchagan.muse-amuse.in/blog/elfeed-index-0-bytes/">discovered what happened</a>. The Elfeed database is basically a hash table and saving it is simply a matter of dumping the binary to a file. This happens inside a <code>with-temp-file</code> macro, which is much like the more familiar <code>with-temp-buffer</code> macro except that it saves the results to a file at the end. The saving is done with <code>write-region</code>, which first truncates any existing file.
</p>
<p>
What happened, apparently, is that the system crashed between the truncation of the old file and writing the new file. Sadly there&rsquo;s not much that can be done at the user level other than saving the file periodically.
</p>
<p>
I liked this post because it shows how easy it is to simply follow the code—which is, of course, available whenever you&rsquo;re running Emacs—to see what&rsquo;s happening. Emacs, to be sure, has more sophisticated tools for debugging but often simply looking at the code will reveal what&rsquo;s going on. Punchagan&rsquo;s post reminds me of Sacha Chua&rsquo;s post on <a href="https://sachachua.com/blog/2026/01/emacs-lisp-editing-one-file-twice-at-the-same-time/">figuring out how to edit an SVG file and its source at the same time</a>. She figured out how to do this the same way as Punchagan solved his problem: by reading the source code to see where the undesirable behavior was happening.</p>
