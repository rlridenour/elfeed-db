<p>Using tabs as part of my workflow has enabled a nice encapsulation and collection of files per tab that I can quickly switch to.</p>
<p>An issue I consistently run into however is tab theming. I&rsquo;m a constant theme switcher, not just in Emacs but also operating system wide, and I often switch wallpapers.</p>
<p>Unfortunately, with the advent of tabs in version 27.1, many Emacs themes lack styles for the new tab faces, resulting in a wonky disjointed appearance.</p>
<p>For example:</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/2024-08-24-10-55-54.jpg" width="100%">
</figure>

<p>Elisp can come to the rescue again of course, this is my attempt at making the tabs fit in a little better with an incompatible theme:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(defun my/sync-tab-bar-to-theme ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Synchronize tab-bar faces with the current theme.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (let ((default-bg (face-background <span style="color:#e6db74">&#39;default</span>))
</span></span><span style="display:flex;"><span>         (default-fg (face-foreground <span style="color:#e6db74">&#39;default</span>))
</span></span><span style="display:flex;"><span>         (inactive-fg (face-foreground <span style="color:#e6db74">&#39;mode-line-inactive</span>)))
</span></span><span style="display:flex;"><span>    (custom-set-faces
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">`</span>(tab-bar ((<span style="color:#66d9ef">t</span> (:inherit default :background <span style="color:#f92672">,</span>default-bg :foreground <span style="color:#f92672">,</span>default-fg))))
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">`</span>(tab-bar-tab ((<span style="color:#66d9ef">t</span> (:inherit default :background <span style="color:#f92672">,</span>default-fg :foreground <span style="color:#f92672">,</span>default-bg))))
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">`</span>(tab-bar-tab-inactive ((<span style="color:#66d9ef">t</span> (:inherit default :background <span style="color:#f92672">,</span>default-bg :foreground <span style="color:#f92672">,</span>inactive-fg)))))))
</span></span></code></pre></div><p>which does its best to fit tab themes to the loaded theme, to give something like:</p>
<figure><img src="https://emacs.dyerdwelling.family/ox-hugo/2024-08-24-10-56-26.jpg" width="100%">
</figure>

<p>There is a bit of logic here, but essentially, for the whole tab-bar theming, I just pick up the foreground and background faces defined in the theme and for the selected tab <code>tab-bar-tab</code>, the default theme foreground switches to ensure the selected tab will always stand out.</p>
<p>For inactive tabs, I set the foreground to that used in the <code>mode-line-inactive</code>.</p>
<p>Now that the <code>defun</code> is available, how to activate it? My first thought was to add a hook for when a theme is loaded, but there doesn&rsquo;t seem to be such a feature!?  I also tried advising around `load-theme`, but that didnâ€™t go well either, it worked for themes that were not loaded, but for those that were, a change in state was not detected, and the tab theme tweak was not applied.</p>
<p>My current solution is simply to make the function interactive and build up some muscle memory to run it every time I switch themes and the tab theming looks wonky.  I guess I could wrap around <code>load-theme</code> with my own theme loading function, then activate <code>my/sync-tab-bar-to-theme</code> afterwards, but I would rather keep the default theme selection function and run this function later.</p>
<p>P.S I also have a little idea to perhaps add this functionality to <a href="https://github.com/captainflasmr/selected-window-accent-mode">selected-window-accent-mode</a> as this is related to clearly defining a selected element in Emacs.</p>