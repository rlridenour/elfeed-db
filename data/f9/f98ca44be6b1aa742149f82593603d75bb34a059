<p>
Mahmood over at <a href="https://mahmoodsh.com">λ mental</a> has a surprising post <a href="https://mahmoodsh.com/efficiently_parsing_org_files.html">concerning the time to load and parse Org files</a>. What was surprising to me is that a method I would have expected to take longer was actually much faster. Here&rsquo;s a couple of statistics from Mahmood&rsquo;s post:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col  class="org-left" />
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>(find-file-noselect  "/home/mahmooz/brain/notes/1707069432.org")</code></td>
<td class="org-left">0.212753316</td>
</tr>
<tr>
<td class="org-left"><code>(quick-way)</code></td>
<td class="org-left">0.003604351</td>
</tr>
</tbody>
</table>
<p>
where <code>quick-way</code> is
</p>
<div class="org-src-container">
<pre class="src src-elisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">quick-way</span> ()
  (<span style="color: #a020f0;">with-temp-buffer</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">the final `</span><span style="color: #008b8b;">t</span><span style="color: #b22222;">' is to replace contents of the temp buffer
</span>    (insert-file-contents <span style="color: #8b2252;">"/home/mahmooz/brain/notes/1707069432.org"</span>
                          nil
                          nil
                          nil
                          t)
    (<span style="color: #a020f0;">let</span> ((major-mode 'org-mode))
      (org-element-parse-buffer))
    nil))
</pre>
</div>
<p>
As far as I can see, after a quick scan, <code>find-file-noselect</code> calls <code>insert-file-contents</code> after a bit of preprocessing but nowhere near enough reprocessing to account for the huge time difference. My unconsidered expectation was that it would be the other way around (<code>insert-file-contents</code> calls <code>find-file-noselct</code>), which explains my confusion. But I still don&rsquo;t understand where the difference is coming from.  Doubtless if I bore down a bit or (gasp) actually did some profiling I could find out but I&rsquo;m enjoying being mystified and—truth to tell—am too lazy to track it down.
</p>
<p>
In any event, that little mystery is only part of Mahmood&rsquo;s post. His main complaint was that loading his Org agenda and Org Roam files was taking too long. The above observation turned out to be the crux of the matter and Mahmood provides some code to load and parse Org files much faster than the default methods.</p>
