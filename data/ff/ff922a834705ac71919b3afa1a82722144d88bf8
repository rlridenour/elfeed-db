
	
<p>
Project Euler 25 asks us back to the Fibonacci numbers. This famous number sequence describes many natural processes, such as the patterns in this beautiful sunflower. The seeds inside the sunflower grow in a spiral pattern, and the number of spirals tends to be a Fibonacci number. This pattern is the most efficient way to pack the centre with as many seeds as possible.</p>
<p>
Famous mathematician and father of computer science Alan Turing was fascinated by this problem until his death. In 2016, the Royal Society published a journal article that builds on his work in the Open Science journal. They collected sunflowers from <a href="http://dx.doi.org/10.1098/rsos.160091">citizen scientists</a> from around the world and confirmed that for the majority of sunflowers, the number of spirals is a Fibonacci number. They did, however, also discover other patterns. Euler Problem 25 is a bit less poetic as it only asks to generate a huge Fibonacci number.</p>
<figure>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/DRjFV_DETKQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<figcaption>
Sunflowers and Fibonacci - Numberphile.
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Project Euler 25 Definition
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>The Fibonacci sequence is defined by a recurrence relation:</p>
<p>
$$F_n = F_{n-1} + F_{n-2} \quad | \quad F_1 = 1, F_2 = 1$$</p>
<p>
The 12<sup>th</sup> term, \(F_{12}=144\), is the first term to contain three digits.</p>
<p>
What is the index of the first term in the Fibonacci sequence to <a href="https://projecteuler.net/problem=25">contain 1000 digits</a>?</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Large Integers in R
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>By default, numbers with more than 7 digits are shown in scientific notation in R, which reduces the accuracy of the calculation. You can change the precision of large integers with the <code class="verbatim">options()</code> function, but R struggles with integers with more than 22 digits. This example illustrates this issue:</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#06b;font-weight:bold">factorial</span>(<span style="color:#60e;font-weight:bold">24</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[1] <span style="color:#60e;font-weight:bold">6.204484e+23</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#06b;font-weight:bold">options</span>(digits <span style="color:#333">=</span> <span style="color:#60e;font-weight:bold">22</span>)
</span></span><span style="display:flex;"><span><span style="color:#06b;font-weight:bold">factorial</span>(<span style="color:#60e;font-weight:bold">24</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[1] <span style="color:#60e;font-weight:bold">620448401733239409999872</span></span></span></code></pre></div>
</div>
<p>Finding a number with 1000 digits is a problem in R with using a special function or package. This article explains how to solve this problem using the <a href="https://cran.r-project.org/web/packages/gmp/index.html">GMP package</a> and in base R code.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Project Euler 25 Solution in R
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>We have already seen various ways to generate Fibonacci numbers in R using a recursive function, a while loop and the GMP library in <a href="https://lucidmanager.org/data-science/project-euler-2/">Euler Problem 2</a>.</p>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
Arbitrary-Precision Arithmetic
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>The first solution uses the GMP package to manage large integers. This package implements the GNU Multiple Precision Arithmetic Library for working with huge numbers. This package also contains a function to generate Fibonacci numbers. This solution cycles through the Fibonacci sequence until it finds a number with 1000 digits.</p>
<p>
<a href = "https://github.com/pprevos/ProjectEuler/" target="_blank"
   title="Download ProjectEuler from GitHub"
   alt="Download ProjectEuler from GitHub">
  <button class="button is-medium is-primary">
    <span class="icon is-large">
      <i class="fab fa-github"></i>
    </span>
    <span style="font-family: monospace">ProjectEuler</span>
  </button>
</a>

</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span> <span style="color:#888">## Project Euler 25: Fibonacci number with 1000 digits</span>
</span></span><span style="display:flex;"><span> <span style="color:#888">## GNU Multiple Precision Arithmetic Library</span>
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">library</span>(gmp) 
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  fib <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">while</span> (<span style="color:#06b;font-weight:bold">nchar</span>(<span style="color:#06b;font-weight:bold">as.character</span>(fib)) <span style="color:#333">&lt;=</span> <span style="color:#60e;font-weight:bold">1000</span>) {
</span></span><span style="display:flex;"><span>      fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">fibnum</span>(answer) <span style="color:#888"># Determine next Fibonacci number</span>
</span></span><span style="display:flex;"><span>      answer <span style="color:#333">&lt;-</span> answer <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
R-base code
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>This is a very fast solution but my aim is to solve the first 100 Project Euler problems using only base-R code. The <code class="verbatim">big.add()</code> function I developed to solve <a href="https://lucidmanager.org/data-science/project-euler-13/">Euler Problem 13</a> uses only basic R to add large numbers. This function multiplies large numbers in the same way you would do on a piece of paper. This code to solve Euler Problem 25 is much slower than the GMP library but it was fun to develop.</p>
<div class="src src-r">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#888">## Base-R Solution</span>
</span></span><span style="display:flex;"><span>  fib <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888"># First Fibonaci number</span>
</span></span><span style="display:flex;"><span>  cur <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888"># Current number in sequence</span>
</span></span><span style="display:flex;"><span>  pre <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">1</span> <span style="color:#888"># Previous number in sequence</span>
</span></span><span style="display:flex;"><span>  answer <span style="color:#333">&lt;-</span> <span style="color:#60e;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-weight:bold">while</span> (<span style="color:#06b;font-weight:bold">nchar</span>(fib) <span style="color:#333">&lt;</span> <span style="color:#60e;font-weight:bold">1000</span>) {
</span></span><span style="display:flex;"><span>      fib <span style="color:#333">&lt;-</span> <span style="color:#06b;font-weight:bold">big.add</span>(cur, pre) <span style="color:#888"># Determine next Fibonacci number</span>
</span></span><span style="display:flex;"><span>      pre <span style="color:#333">&lt;-</span> cur
</span></span><span style="display:flex;"><span>      cur <span style="color:#333">&lt;-</span> fib
</span></span><span style="display:flex;"><span>      answer <span style="color:#333">&lt;-</span> answer <span style="color:#333">+</span> <span style="color:#60e;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#06b;font-weight:bold">print</span>(answer)</span></span></code></pre></div>
</div>
<a href = "https://www.r-bloggers.com/" target="_blank" title="Proudly associated with R-Bloggers">
  <button class="button is-link is-medium">
    <span class="icon is-large">
      <i class="fab fa-r-project"></i>
    </span>
    <span>As seen on R Bloggers</span>
  </button>
</a>

</div>
</div>
</div>
</div>

      