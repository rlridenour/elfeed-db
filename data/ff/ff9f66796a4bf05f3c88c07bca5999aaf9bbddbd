<p>For a while now I have been looking for a simple method in emacs for trimming down my largest files, usually this means locating those large image files and compressing them as I like keeping my media compressed or deleting any large files I didn&rsquo;t know were lurking around my system.</p>
<figure class="emacs-img"><img src="https://emacs.dyerdwelling.family/ox-hugo/20231001210123-emacs--Dired-Listing-Files-Largest-First.jpg">
</figure>

<p>The obvious choice for this is <code>find-name-dired</code> but for me always had the annoying habit of reordering the final result after finishing the recursive search.  Even if I set the <code>find-ls-option</code> correctly (not necessarily an easy task) to sort by size the final dired buffer output would always keep resetting to sort by file name.</p>
<p>It took me a while delving into the nuts and bolts of <code>find-name-dired</code> but I finally realised that after processing using the <code>find-ls-option</code> a function <code>find-dired-refine-function</code> is called which by default is set to <code>find-dired-sort-by-filename</code> which:</p>
<blockquote>
<p>Sorts entries in <strong>Find</strong> buffer by file name lexicographically.</p>
</blockquote>
<p>Why this does this I have no idea (perhaps it is because the output of the find command ends up in a dired buffer which would always generally make sense to sort by name?), but as I will only ever want to use <code>find-name-dired</code> to list files in size order and then to prune any or compress them using standard <code>dired</code> commands then I can just do the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elisp" data-lang="elisp"><span style="display:flex;"><span>(setq find-dired-refine-function <span style="color:#e6db74">&#39;nil</span>)
</span></span><span style="display:flex;"><span>(setq find-ls-option (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#34;-exec ls -lSh {} +&#34;</span> <span style="color:#e6db74">&#34;-lSh&#34;</span>))
</span></span></code></pre></div><p>Which will honour the intended <code>find-ls-option</code> to do exactly what it says on the tin and that is to:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">-l : long list as =dired= will always need this form of listing
-S : Sort by file size
-h : Show size in human readable form, which  doesn&#39;t seem to affect the sorting
</code></pre><p>For me this seems to be a more transparent method and of course I guess other standard <code>ls</code> options can now be passed through to <code>dired</code>, for example for files in order of time, you would pass <code>-t</code></p>